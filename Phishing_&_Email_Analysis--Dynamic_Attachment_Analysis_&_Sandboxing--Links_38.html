<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Links</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Links</h1><br/><p>------------------------------------------------------------</p><p>Dynamic Analysis &amp; Sandboxing — Reference Notes</p><p>------------------------------------------------------------</p><p></p><p>Below are narrative notes you can paste into CherryTree. Each section explains what the referenced site/article is, why it matters for email attachment analysis, and how to use it in a SOC workflow.</p><p></p><p>------------------------------------------------------------</p><p>Hybrid Analysis (Falcon Sandbox)</p><p><a href="https://hybrid-analysis.com/">https://hybrid-analysis.com/</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>Hybrid Analysis is a free/community-facing front end to Falcon Sandbox for automated malware detonation and behavioral reporting. You can upload files/URLs, search public reports, and even perform YARA-based hunts (for vetted users). It exposes behavior trees, network indicators, extracted artifacts, and community scoring to help analysts quickly decide whether an attachment is malicious. :contentReference[oaicite:0]{index=0}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  </p><p>When you hash an email attachment (e.g., SHA-256) and search it on Hybrid Analysis, you often find existing public reports with:<ul><li>Process trees (e.g., WINWORD → powershell → curl)  </li><li>Dropped files and persistence keys  </li><li>DNS/HTTP requests (C2, payload hosts)  </li><li>Extracted strings and embedded resources  </li></ul></p><p>This turns a “cold” attachment into a set of concrete IOCs for blocking and hunting. :contentReference[oaicite:1]{index=1}</p><p></p><p>HOW TO USE IT (Triage Flow)  <ol><li>Compute the hash locally; search the hash first.  </li><li>If no hit and policy allows, upload the sample to HA (mind data-sharing rules).  </li><li>Review the **Behavior**, **Network**, **Extracted Files**, and **MITRE**-mapped findings; export IOCs to your ticket/SIEM.  </li><li>(Advanced) Maintain YARA rules for recurrent lures or packers and use HA’s YARA hunt to auto-flag future submissions. :contentReference[oaicite:2]{index=2}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>Google Cloud (Mandiant) Blog — CVE-2017-0199 HTA Handler</p><p><a href="https://cloud.google.com/blog/topics/threat-intelligence/cve-2017-0199-hta-handler">https://cloud.google.com/blog/topics/threat-intelligence/cve-2017-0199-hta-handler</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>This incident-response write-up (Apr 2017) documents in-the-wild exploitation of **CVE-2017-0199**, where weaponized Office/RTF documents abuse the **HTA handler** to pull and execute a script (often VBScript) that launches PowerShell and fetches a payload. It anchors the original kill chain details used by email-delivered lures. :contentReference[oaicite:3]{index=3}</p><p></p><p>KEY TAKEAWAYS FOR ANALYSTS  <ul><li>Opening a malicious Office/RTF attachment can cause an automatic external fetch of an HTA/VBS, which then executes PowerShell to retrieve malware.  </li><li>This pattern explains why simple static inspection of the doc may miss the true payload; dynamic/sandboxing reveals the HTA → PowerShell → payload chain.  </li><li>Microsoft patched the issue in April 2017; legacy or unpatched environments remain at risk. :contentReference[oaicite:4]{index=4}</li></ul></p><p></p><p>WHAT TO LOOK FOR IN SANDBOX REPORTS  <ul><li>**Process tree:** &lt;Office&gt; → `mshta.exe`/`wscript.exe` → `powershell.exe` with Base64 blobs.  </li><li>**Network:** initial GET to an attacker-controlled URL serving `.hta`/script; follow-on GET for EXE/DLL.  </li><li>**Artifacts:** scheduled tasks, Run keys, or dropped loaders. (Corroborate with HA/Joe/ANY.RUN outputs.) :contentReference[oaicite:5]{index=5}</li></ul></p><p></p><p></p><p>------------------------------------------------------------</p><p>Deep-Dive Blog Posts on CVE-2017-0199 (Backgrounders)</p><p>(Examples)  <ul><li>MDSec: <a href="https://www.mdsec.co.uk/2017/04/exploiting-cve-2017-0199-hta-handler-vulnerability/">https://www.mdsec.co.uk/2017/04/exploiting-cve-2017-0199-hta-handler-vulnerability/</a>  </li><li>Medium (community articles vary): <a href="https://medium.com/@vysec.private/exploiting-cve-2017-0199-hta-handler-vulnerability-8c50ec152c5a">https://medium.com/@vysec.private/exploiting-cve-2017-0199-hta-handler-vulnerability-8c50ec152c5a</a></li></ul></p><p>------------------------------------------------------------</p><p>WHAT THEY ARE  </p><p>Practitioner-oriented explainers showing how 0199 works in practice: RTF/Office lure triggers the **HTA handler**, which fetches/executes code without robust user interaction in vulnerable builds. These are useful primers before you read sandbox reports. :contentReference[oaicite:6]{index=6}</p><p></p><p>HOW TO APPLY WHEN ANALYZING ATTACHMENTS  <ul><li>Use these posts to build a mental model of the exploit chain.  </li><li>In your sandbox results, verify each stage exists (RTF/Office → HTA → script → PowerShell → payload).  </li><li>Cross-reference observed IOCs with reputation sources (Talos, VT) and patch guidance (April 2017 update). :contentReference[oaicite:7]{index=7}</li></ul></p><p></p><p>WHY STILL RELEVANT  </p><p>Even in 2025, you’ll find phishing campaigns recycling old exploit docs or using similar multi-stage download cradles. Understanding 0199 helps you recognize analogous chains (embedded scripts, LOLBins like `mshta.exe`) during dynamic analysis. Recent research still observes 0199-style delivery into commodity stealers/loaders. :contentReference[oaicite:8]{index=8}</p><p></p><p></p><p>------------------------------------------------------------</p><p>Joe Sandbox Cloud</p><p><a href="https://joesandbox.com">https://joesandbox.com</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>Joe Sandbox is a multi-OS automated detonation platform (Windows, macOS, Linux, Android) that generates very detailed, drill-down behavior reports: process graphs, API calls, persistence, network flows, memory artifacts, and rule hits (e.g., YARA/Sigma). Community/Cloud editions provide limited free runs; paid tiers unlock private analyses and deeper telemetry. :contentReference[oaicite:9]{index=9}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  <ul><li>Excellent for **document-borne malware** (DOC/XLS/PDF) that spawns scripts/LOLBins.  </li><li>Rich **network and memory** analysis surfaces second-stage payloads and C2s—ideal for IOC harvesting.  </li><li>Useful cross-check with Hybrid Analysis/ANY.RUN to avoid single-source bias. :contentReference[oaicite:10]{index=10}</li></ul></p><p></p><p>HOW TO USE IT  <ol><li>Hash search first; if clean and policy allows, submit the sample.  </li><li>Review **Behavior Graph**, **Network** tabs, and **IOC** exports.  </li><li>Compare Joe’s findings with other sandboxes; escalate consistent IOCs to block lists. :contentReference[oaicite:11]{index=11}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>ANY.RUN — Interactive Malware Sandbox</p><p><a href="https://app.any.run">https://app.any.run</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>ANY.RUN is a **real-time, interactive** sandbox: you can click around inside the VM during detonation (enable macros, press dialog buttons, browse in the emulated system). It offers process/network views, behavior graphs, MITRE ATT&amp;CK mapping, and shareable public tasks; paid plans enable private mode. :contentReference[oaicite:12]{index=12}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  </p><p>Many email lures require **user interaction** (e.g., “Enable Content” buttons). ANY.RUN lets you simulate that interaction and immediately watch the process tree and HTTP/DNS beacons evolve—perfect for attachments that won’t fully detonate in a fully automated sandbox. :contentReference[oaicite:13]{index=13}</p><p></p><p>HOW TO USE IT  <ol><li>Start a task; open the document as a user would.  </li><li>Interact (enable macros, follow prompts) to trigger embedded scripts.  </li><li>Capture live IOCs from the **Network** and **Processes** panes; export artifacts for deeper analysis. :contentReference[oaicite:14]{index=14}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>Putting the References to Work in Your Workflow</p><p>------------------------------------------------------------<ol><li>**Understand the exploit chain** with the CVE-2017-0199 write-ups (HTA handler → script → PowerShell). :contentReference[oaicite:15]{index=15}  </li><li>**Detonate** the attachment in one or more sandboxes (ANY.RUN for interactive, Hybrid Analysis/Joe for deep automated telemetry). :contentReference[oaicite:16]{index=16}  </li><li>**Extract IOCs** (domains, IPs, URLs, hashes, dropped files, persistence keys) and compare across tools for confidence. :contentReference[oaicite:17]{index=17}  </li><li>**Validate &amp; block** using reputation intel and ensure patch status aligns with Microsoft’s April 2017 fix guidance. :contentReference[oaicite:18]{index=18}</li></ol></p><p></p><p>MEMORY HOOK  </p><p>**Model → Detonate → Compare → Extract → Block.**  <ul><li>Model (read the CVE chain)  </li><li>Detonate (ANY.RUN + HA/Joe)  </li><li>Compare (cross-sandbox correlation)  </li><li>Extract (IOCs)  </li><li>Block (controls + patch)</p><p></li></ul></p></div>
</body>
</html>
