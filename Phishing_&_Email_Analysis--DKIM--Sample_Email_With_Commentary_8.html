<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Sample Email With Commentary</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Sample Email With Commentary</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: Sample Email with Commentary</p><p>-----------------------------------------------------</p><p>RAW (simplified)</p><p></p><p>From: Alice alice@example.com</p><p> To: Bob bob@example.net</p><p> Subject: Meeting Update</p><p> Date: Mon, 5 Sep 2025 12:34:56 -0400</p><p> Message-ID: 12345@example.com</p><p> MIME-Version: 1.0</p><p> Content-Type: text/plain; charset=UTF-8</p><p> Content-Transfer-Encoding: 7bit</p><p> DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=example.com;</p><p> s=mail2025; h=from:to:subject:date:message-id;</p><p> bh=Y2F0Y2hpbmctc29ja2V0LW5vdGVzLXN0dWR5Cg==;</p><p> b=ABCD1234Efgh5678Ijkl90MNopQRstUVwxyz...</p><p>Hi Bob,</p><p> The meeting has been moved to 3 PM today.</p><p> Thanks,</p><p> Alice</p><p></p><p>Commentary<ul><li>`d=example.com` → signer’s domain (claims responsibility).</li><li>`s=mail2025` → DNS selector → query `mail2025._domainkey.example.com` TXT to get public key.</li><li>`h=from:to:subject:date:message-id` → which headers were included when building the signing string.</li><li>`bh=` → body fingerprint: base64(SHA-256 of canonicalized body).</li><li>`b=` → signature over the **hash of (selected headers + bh)**:</li></ul></p><p>  - **NOT** arithmetic addition; fields are **concatenated** (joined end-to-end in a defined order).</p><p>  - That serialized string is hashed (e.g., SHA-256).</p><p>  - The resulting hash is signed with the **private key** (RSA).</p><p>  - The signature bytes are base64-encoded and placed in `b=`.<ul><li>Recipient verifies by:</li></ul></p><p>  - Recomputing `bh` from the received body.</p><p>  - Rebuilding and hashing the same header+bh string.</p><p>  - Using the public key to verify `b`.</p><p></p><p>Mental Model<ul><li>**bh** = the body’s fingerprint.</li><li>**b** = a wax seal over both the fingerprint and the key headers.</li><li>Recipient breaks the seal with the public key to ensure it matches.</li></ul></p></div>
</body>
</html>
