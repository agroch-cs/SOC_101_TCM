<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>TCM_SOC_101 Notes.ctd</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><a name="SOC_101_-_TCM_1.html"></a><h1 class='title level-1'>SOC 101 - TCM</h1><br/><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis_2.html"></a><h1 class='title level-1'>Phishing & Email Analysis</h1><br/><p>------------------------------------------------------------</p><p>Email Attachment Analysis – Notes</p><p>------------------------------------------------------------</p><p></p><p>When investigating phishing or malicious emails, analysts focus not only on the message body and URLs but also on attachments. Attachments are a common delivery method for malware and social engineering payloads. Because many organizations have link protections in place, attackers rely heavily on file attachments to bypass defenses.</p><p></p><p>------------------------------------------------------------</p><p>Why Attachments Matter</p><p>------------------------------------------------------------</p><p>Attachments can carry:<ul><li>Executable malware (.exe, .dll, .bat, .ps1)</li><li>Document-based payloads (malicious Word macros, weaponized PDFs, embedded Excel formulas)</li><li>Compressed archives (.zip, .rar, .7z) used to hide malware</li><li>Image/media files with hidden exploits (steganography, malformed headers)</li></ul></p><p></p><p>Attachments provide a direct delivery vector: one user click can compromise a system.</p><p></p><p>------------------------------------------------------------</p><p>Analyst’s First Step – Triage</p><p>------------------------------------------------------------<ol><li>Preserve the original sample – always work in a sandbox or isolated VM.</li><li>Gather metadata – file name, extension, size (watch for double extensions like “invoice.pdf.exe”).</li><li>Generate hashes – MD5, SHA-1, SHA-256 for reference and threat intel checks.</li><li>Submit hashes to platforms like VirusTotal to see if file is already known.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Static Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>File headers/magic numbers: confirm type matches extension (e.g., .pdf starts with %PDF).</li><li>Strings analysis: extract readable text for URLs, C2 servers, or suspicious calls.</li><li>Macro inspection: review VBA code with tools like “oletools.”</li><li>Embedded objects: detect executables or scripts hidden inside documents.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Dynamic Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>Sandbox execution: observe behavior such as file creation, registry edits, process spawning.</li><li>Network monitoring: check for suspicious outbound connections.</li><li>Persistence checks: look for scheduled tasks, registry keys, or dropped payloads.</li></ul></p><p></p><p>Dynamic analysis reveals what the file actually does, not just what it might do.</p><p></p><p>------------------------------------------------------------</p><p>Common Malicious Attachment Types</p><p>------------------------------------------------------------<ul><li>Malicious Office Documents – VBA macros, DDE (Dynamic Data Exchange).</li><li>PDFs – with embedded JavaScript or malicious auto-actions.</li><li>Archives – password-protected .zip/.rar to bypass filters.</li><li>Scripts – .vbs, .js, or .ps1 designed to download/install malware.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Indicators of Compromise (IoCs)</p><p>------------------------------------------------------------</p><p>Extracted from attachments for defense:<ul><li>File hashes</li><li>Embedded URLs/domains</li><li>IP addresses</li><li>Registry keys / scheduled tasks</li><li>Dropped file names and locations</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Defensive Measures</p><p>------------------------------------------------------------<ul><li>Attachment filtering – block risky file types.</li><li>Sandboxing – detonate unknown files before delivery.</li><li>User awareness – train users not to enable macros or open unexpected files.</li><li>Advanced email security – combine static/dynamic analysis with threat intel feeds.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Example Case Narrative</p><p>------------------------------------------------------------</p><p>A reported email titled “Urgent Invoice” contains `invoice.pdf.exe`.  <ul><li>Hash check matches known malware on VirusTotal.  </li><li>Strings show suspicious commands (`powershell -enc ...`).  </li><li>Sandbox run reveals network call to `hxxp://malicious-domain[.]com` and second-stage payload.  </li></ul></p><p></p><p>Analyst provides IoCs to SOC team for blocking, endpoint updates, and user warnings.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM_3.html"></a><h1 class='title level-2'>DKIM</h1><br/><p>=====================================================</p><p>PARENT NODE: Phishing &amp; Email Analysis  →  DKIM</p><p>=====================================================</p><p>(Use this as the top DKIM node description)<ul><li>DKIM = DomainKeys Identified Mail.</li><li>Goal: authenticate sending domain and ensure message integrity.</li><li>Method: sender signs headers + body hash with private key; recipient verifies with public key from DNS.</li><li>Pair with SPF + DMARC for best protection.</li></ul></p><p></p><p>=====================================================</p><p>Links</p><p>=====================================================</p><p></p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--Overview_4.html"></a><h1 class='title level-3'>Overview</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: Overview</p><p>-----------------------------------------------------<ul><li>Purpose</li></ul></p><p>  - Prove that a message was authorized by the domain and not altered in transit.</p><p>  - Provide integrity (no tampering) and domain-level authenticity.<ul><li>What DKIM is NOT</li></ul></p><p>  - Not end-to-end encryption: contents are not hidden (that’s PGP/S/MIME).<ul><li>Cryptography</li></ul></p><p>  - Asymmetric keys: private key (sign), public key (verify).<ul><li>Where the key lives</li></ul></p><p>  - Private key: on the sender’s mail system.</p><p>  - Public key: in DNS at `selector._domainkey.domain.tld` as a TXT record.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--How_DKIM_Works_5.html"></a><h1 class='title level-3'>How DKIM Works</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: How DKIM Works</p><p>-----------------------------------------------------<ol><li>Sender (signing)<ul><li>Canonicalize: normalize headers/body per `c=relaxed/relaxed` (whitespace/case rules).</li><li>Compute body hash → **bh** (SHA-256 of the body; base64-encoded).</li><li>Build signing string by **concatenating** (not adding) selected header fields + the **bh** value in a strict format.</li><li>Hash the signing string (e.g., SHA-256).</li><li>Sign that hash with the **private RSA key** → output is **b** (the DKIM signature, base64).</li><li>Insert `DKIM-Signature:` header with fields: `v, a, c, d, h, s, bh, b`.</li></ul></li></ol></p><p><ol><li>Recipient (verification)<ul><li>Parse `DKIM-Signature`.</li><li>Fetch public key from DNS at `selector._domainkey.domain`.</li><li>Re-hash the body → compare to **bh**. If mismatch → body was altered.</li><li>Rebuild the signing string from received headers + **bh**, hash it.</li><li>Use public key to verify **b** equals the computed hash.</li><li>If both pass → DKIM=PASS; else → DKIM=FAIL.</li></ul></li></ol></p><p></p><p>Notes<ul><li>**Concatenation** = “gluing text fields together in order,” not arithmetic addition.</li><li>Canonicalization prevents trivial formatting changes from breaking signatures.</li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--DKIM_Header_Breakdown_6.html"></a><h1 class='title level-3'>DKIM Header Breakdown</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: DKIM Header Breakdown</p><p>-----------------------------------------------------</p><p>Example (truncated):</p><p></p><p>DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=namecheap.com;</p><p> h=content-transfer-encoding:content-type:from:mime-version:subject:</p><p> x-feedback-id:to:cc:content-type:from:subject:to;</p><p> s=s1; bh=JC8puLkuSeJ08+NjIZ//zxmJq/tV+KenAsoFaHwg/KY=;</p><p> b=ZUpafHVJQ04qVfuU... (base64)</p><p></p><p>Fields:<ul><li>`v=1` → DKIM version.</li><li>`a=rsa-sha256` → RSA for signing + SHA-256 hashing.</li><li>`c=relaxed/relaxed` → canonicalization for headers/body.</li><li>`d=namecheap.com` → signing domain (responsible party).</li><li>`h=` → list of header fields covered by the signature.</li><li>`s=s1` → selector (DNS label to find the public key).</li><li>`bh=` → body hash (base64 of SHA-256(body) after canonicalization).</li><li>`b=` → digital signature (base64 of private-key signature over the header+bh hash).</li></ul></p><p></p><p></p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--Worked_Verification_Example_7.html"></a><h1 class='title level-3'>Worked Verification Example</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: Worked Verification Example</p><p>-----------------------------------------------------</p><p>Scenario<ul><li>Message:</li></ul></p><p>  - From: alice@namecheap.com</p><p>  - To: bob@example.net</p><p>  - Subject: Hello</p><p>  - Body: “Hi Bob, here’s the document.”</p><p></p><p>Sender Steps<ul><li>Compute body hash: `bh = base64(SHA256(canonicalized_body))`.</li><li>Build signing string: concatenate selected headers (From, To, Subject, Date, Message-ID…) + `bh` in the exact order specified by `h=`.</li><li>Hash signing string: `H = SHA256(signing_string)`.</li><li>Sign with private key: `b = base64(RSA_sign(H, private_key))`.</li><li>Attach `DKIM-Signature:` with fields (`v, a, c, d, h, s, bh, b`).</li></ul></p><p></p><p>Recipient Steps<ul><li>Fetch public key from DNS: `selector._domainkey.namecheap.com`.</li><li>Verify body: recompute `bh&#39; = base64(SHA256(canonicalized_body_received))` → compare to `bh`.</li><li>Verify headers: rebuild `signing_string&#39;` from received headers + `bh`, hash to `H&#39;`.</li><li>Verify signature: `RSA_verify(b, H&#39;, public_key)` → PASS if matches.</li></ul></p><p></p><p>Takeaway<ul><li>If body or signed headers were modified, either `bh` or the signature check fails.</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--Sample_Email_With_Commentary_8.html"></a><h1 class='title level-3'>Sample Email With Commentary</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: Sample Email with Commentary</p><p>-----------------------------------------------------</p><p>RAW (simplified)</p><p></p><p>From: Alice alice@example.com</p><p> To: Bob bob@example.net</p><p> Subject: Meeting Update</p><p> Date: Mon, 5 Sep 2025 12:34:56 -0400</p><p> Message-ID: 12345@example.com</p><p> MIME-Version: 1.0</p><p> Content-Type: text/plain; charset=UTF-8</p><p> Content-Transfer-Encoding: 7bit</p><p> DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=example.com;</p><p> s=mail2025; h=from:to:subject:date:message-id;</p><p> bh=Y2F0Y2hpbmctc29ja2V0LW5vdGVzLXN0dWR5Cg==;</p><p> b=ABCD1234Efgh5678Ijkl90MNopQRstUVwxyz...</p><p>Hi Bob,</p><p> The meeting has been moved to 3 PM today.</p><p> Thanks,</p><p> Alice</p><p></p><p>Commentary<ul><li>`d=example.com` → signer’s domain (claims responsibility).</li><li>`s=mail2025` → DNS selector → query `mail2025._domainkey.example.com` TXT to get public key.</li><li>`h=from:to:subject:date:message-id` → which headers were included when building the signing string.</li><li>`bh=` → body fingerprint: base64(SHA-256 of canonicalized body).</li><li>`b=` → signature over the **hash of (selected headers + bh)**:</li></ul></p><p>  - **NOT** arithmetic addition; fields are **concatenated** (joined end-to-end in a defined order).</p><p>  - That serialized string is hashed (e.g., SHA-256).</p><p>  - The resulting hash is signed with the **private key** (RSA).</p><p>  - The signature bytes are base64-encoded and placed in `b=`.<ul><li>Recipient verifies by:</li></ul></p><p>  - Recomputing `bh` from the received body.</p><p>  - Rebuilding and hashing the same header+bh string.</p><p>  - Using the public key to verify `b`.</p><p></p><p>Mental Model<ul><li>**bh** = the body’s fingerprint.</li><li>**b** = a wax seal over both the fingerprint and the key headers.</li><li>Recipient breaks the seal with the public key to ensure it matches.</li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--DKIM--Attacker_Scenario_&_Real-World_Weakness_9.html"></a><h1 class='title level-3'>Attacker Scenario & Real-World Weakness</h1><br/><p>-----------------------------------------------------</p><p>CHILD NODE: Attacker Scenario &amp; Real-World Weakness</p><p>-----------------------------------------------------</p><p>Attacker with public key only<ul><li>Can read DNS and obtain the public key (by design).</li><li>Cannot generate a valid `b` signature; only the private key can sign.</li><li>If attacker alters body/headers, recomputed hashes won’t match.</li></ul></p><p></p><p>Private key compromise<ul><li>If attacker steals the sender’s private DKIM key, they can sign malicious mail.</li><li>Mitigations:</li></ul></p><p>  - Protect keys (HSM if possible), rotate periodically.</p><p>  - Enforce domain alignment and failure policies with **DMARC**.</p><p>  - Maintain **SPF** to restrict who can send for your domain.</p><p></p><p>Quick Compare<ul><li>DKIM = signs content → integrity &amp; domain authenticity.</li><li>SPF = checks sending hosts/IPs.</li><li>DMARC = policy + alignment + reporting on SPF/DKIM results.</li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis_10.html"></a><h1 class='title level-2'>Email Content Analysis</h1><br/><p>=====================================================</p><p>Links</p><p>=====================================================</p><p></p><p><a href="https://gchq.github.io/CyberChef">https://gchq.github.io/CyberChef</a> </p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--MIME_11.html"></a><h1 class='title level-3'>MIME</h1><br/><p>TITLE: MIME Notes for “Email Content Analysis”</p><p>PURPOSE: Understand how MIME structure reveals what an email *really* contains (text, HTML, images, attachments, signatures). Use this to spot phishing, weaponized files, and deception.</p><p></p><p>------------------------------------------------------------<ol><li>What is MIME?</li></ol></p><p>------------------------------------------------------------</p><p></p><p>MIME, which stands for Multipurpose Internet Mail Extensions, is the standard that allows email to go beyond simple plain text messages. In the early days, email could only handle basic ASCII text, which meant no attachments, no HTML formatting, and no images. MIME solved this by introducing a system of headers and boundaries that break an email into different parts, each with its own type and encoding. For example, one part of the email might be plain text, another might be an HTML version with colors and links, and another part could be a PDF or Word document attachment. Each part is described with headers like “Content-Type” (what the data is), “Content-Transfer-Encoding” (how the data is packed for transport, such as base64 or quoted-printable), and “Content-Disposition” (whether it should be shown inline or offered as a download). These rules let email clients rebuild the message in a readable way for the user. For analysts, MIME is important because attackers often abuse these structures—sending attachments that pretend to be safe files, hiding links inside HTML bodies, or disguising harmful executables with misleading names. By carefully examining the MIME structure of a suspicious email, you can see the true types of content, how they are encoded, and whether there are signs of trickery, like a .pdf file that is actually an executable. In short, MIME is the “packaging system” of email, and understanding it gives you the ability to peel back the wrapping to see what’s really inside.</p><p></p><p>------------------------------------------------------------<ol><li>MIME Overview (What is MIME?)</li></ol></p><p>------------------------------------------------------------</p><p>Multipurpose Internet Mail Extensions (MIME) is the standard that lets email carry more than plain ASCII text. Before MIME, email infrastructure assumed messages were simple text, which made sending images, PDFs, or non-English characters unreliable. MIME extends the message format with descriptive headers that label what each part of the message is (its media type) and how it’s encoded for safe transport. This turns email into a flexible container that can hold text, HTML, images, audio/video, and arbitrary file attachments—while remaining backward compatible so older clients can still read the basic text.</p><p></p><p>------------------------------------------------------------<ol><li>MIME Headers (How MIME describes content)</li></ol></p><p>------------------------------------------------------------</p><p>MIME relies on extra headers to tell the receiving client how to interpret each piece of the message. The most important are Content-Type, which names the media type (for example, text/plain, text/html, image/jpeg, application/pdf) and may include parameters such as charset=UTF-8 for text; Content-Transfer-Encoding, which indicates how binary or extended characters were transformed into safe text for transport (commonly Base64 or quoted-printable); and Content-Disposition, which suggests whether a part should display inline or as an attachment and can include a filename. Together, these headers provide a machine-readable recipe so any mail client can reconstruct and present the content correctly.</p><p></p><p>------------------------------------------------------------<ol><li>MIME Multipart Messages (How one email holds many parts)</li></ol></p><p>------------------------------------------------------------</p><p>MIME introduces “multipart” containers that let a single email include several distinct parts separated by a unique boundary string. For example, multipart/alternative commonly carries two versions of the same body—plain text and HTML—so the client can choose the best version it supports. multipart/mixed allows a text body plus attachments like PDFs or images, while multipart/related bundles an HTML body with its inline images or CSS resources. The enclosing multipart section declares a boundary parameter, and each subsequent part is delimited by that boundary, enabling robust packaging of complex messages.</p><p></p><p>------------------------------------------------------------<ol><li>MIME Encoding (Moving binary through a text-only system)</li></ol></p><p>------------------------------------------------------------</p><p>Because email plumbing historically expects 7-bit text, MIME uses encodings to safely tunnel binary data and extended character sets. Base64 is the workhorse: it converts arbitrary bytes into ASCII characters at the cost of roughly 33% size growth, but with excellent reliability. Quoted-printable is optimized for mostly-text content with occasional non-ASCII characters, representing only the out-of-range bytes as “=XX” hex escapes to keep size lower. On receipt, the client reverses the encoding to restore the exact original bytes before display or saving.</p><p></p><p>------------------------------------------------------------<ol><li>MIME and Attachments (How files ride along)</li></ol></p><p>------------------------------------------------------------</p><p>Attachments are simply additional MIME parts, typically within a multipart/mixed container. Each attachment has its own headers, such as Content-Type: application/pdf; name=&quot;report.pdf&quot;, Content-Transfer-Encoding: base64, and Content-Disposition: attachment; filename=&quot;report.pdf&quot;. These tell the client what the file is, how to decode it, and whether to offer it for download or display inline. Inline images in rich emails are often provided as related parts referenced by the HTML body using content IDs (cid:), allowing the message to render images without external network fetches.</p><p></p><p>------------------------------------------------------------<ol><li>Practical Example (What happens in a real message)</li></ol></p><p>------------------------------------------------------------</p><p>Imagine sending “Here is the photo we discussed” plus a picture. The outer message declares multipart/mixed with a boundary. The first part is the human-readable body: Content-Type: text/plain; charset=UTF-8 with your sentence in UTF-8. The second part is the photo: Content-Type: image/jpeg; name=&quot;meeting.jpg&quot;, Content-Transfer-Encoding: base64, and Content-Disposition: attachment; filename=&quot;meeting.jpg&quot;, followed by the Base64 data. A modern client reads the headers, displays the text, decodes the image back to its original bytes, and presents it as an attachment or inline preview—demonstrating how MIME carries rich content reliably over legacy-friendly email rails.</p><p></p><p></p><p><ul><li>MIME = Multipurpose Internet Mail Extensions.</li><li>Extends basic RFC 5322 email so we can send:</li></ul></p><p>  – Non-ASCII text (e.g., UTF-8) </p><p>  – Rich HTML bodies</p><p>  – Multiple “parts” (e.g., text + HTML + attachments)</p><p>  – Binary files (PDFs, DOCX, ZIPs, images)<ul><li>Core building blocks are extra headers in the body section:</li></ul></p><p>  – MIME-Version: usually “1.0”</p><p>  – Content-Type: the media type of a part (e.g., text/plain, text/html, image/png, application/pdf, multipart/…)</p><p>  – Content-Transfer-Encoding: how the bytes are represented for transport (7bit, quoted-printable, base64, 8bit, binary)</p><p>  – Content-Disposition: how the part should be presented (inline vs attachment) + filename</p><p>  – Content-ID: identifier for inline resources referenced by HTML with cid: links</p><p></p><p>Memory aid:<ul><li>“Type” = what it is. “Encoding” = how it’s packed. “Disposition” = how to display/save it.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>High-value MIME types for analysts</li></ol></p><p>------------------------------------------------------------<ul><li>text/plain – Plain text body (often the “safe” alternative)</li><li>text/html – Rich body; can contain links, forms, obfuscated JS-like tricks (data URLs, meta refresh)</li><li>multipart/alternative – Parallel versions of the same message (plain text and HTML). Order matters: best/last is usually HTML.</li><li>multipart/mixed – A body with attachments.</li><li>multipart/related – HTML body + inline images/assets referenced via cid:Content-ID.</li><li>multipart/signed / multipart/encrypted – S/MIME signing and encryption wrappers.</li><li>application/pdf – PDFs; may contain embedded links/attachments (PDF/JavaScript features).</li><li>application/vnd.ms-word.document.macroEnabled.12 (.docm) – Macro-enabled Word.</li><li>application/vnd.ms-excel.sheet.macroEnabled.12 (.xlsm) – Macro-enabled Excel.</li><li>application/zip, application/x-7z-compressed – Compressed archives (often “payload containers”).</li><li>application/octet-stream – Generic “raw bytes” (warning: often used to hide true type).</li><li>application/pkcs7-signature (.p7s), application/pkcs7-mime (.p7m) – S/MIME signature/encrypted content.</li></ul></p><p></p><p>Analyst tip:<ul><li>A benign filename + risky MIME type (or vice versa) is a red flag. Always cross-check the *declared* type vs the *actual* bytes.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Multipart boundaries &amp; nesting (the “folders” inside the email)</li></ol></p><p>------------------------------------------------------------<ul><li>Multipart types use a boundary parameter to separate parts.</li><li>Think: a ZIP-like *tree* embedded in the email body.</li></ul></p><p></p><p>Example boundary header:</p><p>  Content-Type: multipart/mixed; boundary=&quot;----ABC123&quot;</p><p></p><p>The body then looks like:</p><p>  ------ABC123</p><p>  [Headers for part #1]</p><p>  [Body of part #1]</p><p>  ------ABC123</p><p>  [Headers for part #2]</p><p>  [Body of part #2]</p><p>  ------ABC123--</p><p></p><p>The final “--” after the last boundary marks the end.</p><p></p><p>Typical nesting pattern:<ul><li>multipart/mixed</li></ul></p><p>  ├─ multipart/alternative</p><p>  │   ├─ text/plain</p><p>  │   └─ text/html</p><p>  └─ application/pdf (attachment)</p><p></p><p>Analyst tip:<ul><li>If there’s both text/plain and text/html, compare them. Phishers often put benign text/plain and hide the real lure in HTML.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Content-Transfer-Encoding (how bytes are carried)</li></ol></p><p>------------------------------------------------------------<ul><li>7bit / 8bit / binary – Essentially “as-is” (ASCII vs extended).</li><li>quoted-printable (QP) – For mostly text. Non-ASCII characters are encoded like “=E2=80=93”. Long lines wrapped with “=”.</li><li>base64 – For binary data (attachments) or sometimes HTML. Looks like long A–Z, a–z, 0–9, +, /, = blocks.</li></ul></p><p></p><p>Quick checks:<ul><li>If an “attachment” is QP rather than base64, double-check—sometimes HTML “attachments” are shipped as QP.</li><li>If a “text/plain” part is base64, decode it—attackers may hide scripts or links.</li></ul></p><p></p><p>Command idea:<ul><li>base64 -d &lt; payload.b64 &gt; output.bin    # decode to raw bytes</li><li>strings output.bin | head                # quick peek at readable text</li><li>file -i output.bin                       # OS guess of true MIME type</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Content-Disposition (inline vs attachment)</li></ol></p><p>------------------------------------------------------------<ul><li>inline – meant to be displayed in the body (e.g., images in HTML).</li><li>attachment – saved/downloaded by the client.</li><li>filename= and filename*= (RFC 2231) specify the name. Attackers may:</li></ul></p><p>  – Use double extensions (invoice.pdf.exe)</p><p>  – Use right-to-left override (RLO, U+202E) to mask the true extension (e.g., “gpj.exe” displays as “exe.jpg”).</p><p>  – Use misleading names vs actual file type (e.g., “invoice.pdf” with application/octet-stream bytes that are an EXE).</p><p></p><p>Analyst tip:<ul><li>Always validate the bytes (file -i / hash + sandbox) regardless of the filename label.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Content-ID (cid:) &amp; multipart/related</li></ol></p><p>------------------------------------------------------------<ul><li>HTML references inline resources by cid:</li></ul></p><p>  &lt;img src=&quot;cid:logo123&quot;&gt; pairs with:</p><p>  Content-ID: &lt;logo123&gt;<ul><li>Phishers use real logos via cid to boost credibility. Logos don’t prove legitimacy.</li><li>Check that inline images aren’t weaponized tricks (rare) and that external references (http/https) aren’t beaconing.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>S/MIME in MIME</li></ol></p><p>------------------------------------------------------------<ul><li>Signed mail: multipart/signed or application/pkcs7-signature (smime.p7s).</li><li>Encrypted mail: application/pkcs7-mime (smime.p7m).</li><li>Signed ≠ safe. The signature validates *who sent it* and *integrity*, not that it’s benign.</li><li>If you see .p7s or .p7m, note it, export artifacts, and verify signatures with OpenSSL if needed.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Walkthrough: realistic suspicious sample (trimmed)</li></ol></p><p>------------------------------------------------------------</p><p>Raw snippet:</p><p>  MIME-Version: 1.0</p><p>  Content-Type: multipart/mixed; boundary=&quot;----MIX-9999&quot;</p><p></p><p>  ------MIX-9999</p><p>  Content-Type: multipart/alternative; boundary=&quot;--ALT-111&quot;</p><p></p><p>  ----ALT-111</p><p>  Content-Type: text/plain; charset=UTF-8</p><p>  Content-Transfer-Encoding: quoted-printable</p><p></p><p>  Please see the attached invoice.</p><p></p><p>  ----ALT-111</p><p>  Content-Type: text/html; charset=UTF-8</p><p>  Content-Transfer-Encoding: quoted-printable</p><p></p><p>  &lt;html&gt;</p><p>    &lt;body&gt;</p><p>      &lt;p&gt;Please review your &lt;b&gt;invoice&lt;/b&gt; immediately.&lt;/p&gt;</p><p>      &lt;a href=&quot;<a href="https://pay-accounts.example.co-billing.support/login">https://pay-accounts.example.co-billing.support/login</a>&quot;&gt;View&lt;/a&gt;</p><p>    &lt;/body&gt;</p><p>  &lt;/html&gt;</p><p>  ----ALT-111--</p><p></p><p>  ------MIX-9999</p><p>  Content-Type: application/octet-stream; name=&quot;Invoice_0930.pdf&quot;</p><p>  Content-Transfer-Encoding: base64</p><p>  Content-Disposition: attachment; filename=&quot;Invoice_0930.pdf&quot;</p><p></p><p>  TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</p><p>  [ ... long base64 ... ]</p><p>  ------MIX-9999--</p><p></p><p>Red flags to note in case file:<ul><li>Mismatched link domain (co-billing.support) vs claimed brand.</li><li>application/octet-stream for a “.pdf” → decode + “file -i” likely reveals PE/EXE.</li><li>HTML and plain text don’t match in warning detail (HTML pushes urgent action + link).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>How to extract &amp; inspect quickly (CLI)</li></ol></p><p>------------------------------------------------------------<ol><li>Save the raw email as message.eml (full headers + body).</li><li>Identify structure and parts:<ul><li>grep -nE &#39;^(Content-Type|Content-Disposition|Content-Transfer-Encoding|Content-ID):&#39; message.eml</li><li>awk &#39;/^Content-Type: multipart/{print}&#39; message.eml   # spot multipart roots</li></ul></li><li>Extract attachments automatically:<ul><li>ripmime -i message.eml -d ./out</li></ul></li></ol></p><p>     -i = input file, -d = output dir. Writes decoded attachments.<ul><li>munpack -q -C ./out message.eml</li></ul></p><p>     -q = quiet, -C = change to directory before saving decoded files.<ol><li>Validate the *actual* type:<ul><li>file -i ./out/*</li></ul></li><li>Decode manually (if needed):<ul><li>tail -n +&lt;line&gt; message.eml | base64 -d &gt; suspect.bin</li></ul></li><li>Hash and scan:<ul><li>sha256sum suspect.bin</li><li>Submit to sandbox or AV (per SOP).</li></ul></li><li>Inspect HTML bodies for links:<ul><li>strings out/body.html | grep -Eo &#39;(https?|data):[^&quot;&#39;\&#39;&#39; ]+&#39;</li><li>curl -I &lt;URL&gt;  (in controlled environment) to see redirects (or use a URL sandbox).</li></ul></li></ol></p><p></p><p>Optional Python one-liner to list MIME parts (for labs):</p><p>   python3 - &lt;&lt;&#39;PY&#39;</p><p>import sys,email</p><p>msg=email.message_from_file(open(&#39;message.eml&#39;,&#39;r&#39;,errors=&#39;ignore&#39;))</p><p>for i,part in enumerate(msg.walk(),1):</p><p>    print(i, part.get_content_type(), part.get(&#39;Content-Disposition&#39;), part.get_filename())</p><p>PY</p><p></p><p>------------------------------------------------------------<ol><li>Common deception patterns to document</li></ol></p><p>------------------------------------------------------------<ul><li>Declared Content-Type doesn’t match true bytes (octet-stream “masquerading”).</li><li>Double extensions or Unicode RLO to hide EXE/LNK/JS.</li><li>HTML attachment (.html/.htm) used for credential harvest (fake SSO page).</li><li>Zipped HTML/JS (“HTML smuggling”)—browser reconstructs payload client-side.</li><li>Macro-enabled Office docs (.docm/.xlsm) disguised as normal (.docx/.xlsx).</li><li>multipart/alternative where text/plain is harmless but text/html contains malicious link/forms.</li><li>multipart/related with many cid images to look authentic (logos, badges) + a single malicious CTA link.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>What to capture in your case notes (SOC workflow)</li></ol></p><p>------------------------------------------------------------<ul><li>Full list of MIME parts in order (type, disposition, filename, size if known).</li><li>Any mismatches (declared vs actual type).</li><li>Encodings used (base64/QP) and whether decoding changed your assessment.</li><li>Final URLs extracted (with redactions per policy), redirect chain summary.</li><li>Attachment hashes (MD5/SHA256), strings of interest, and static “file -i” results.</li><li>Verdict rationale: which MIME evidence drove the decision (e.g., octet-stream EXE posing as PDF).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Quick cheat sheet (exam memory)</li></ol></p><p>------------------------------------------------------------<ul><li>MIME-Version: 1.0 → tells you MIME is in play.</li><li>multipart/alternative → compare text/plain vs text/html.</li><li>multipart/mixed → expect attachments.</li><li>multipart/related → HTML + cid images.</li><li>base64 → decode and verify bytes; don’t trust filenames.</li><li>Content-Disposition: attachment vs inline → user-visible vs downloadable.</li><li>application/octet-stream → treat as suspicious until proven safe.</li></ul></p><p></p><p>End of MIME notes.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--HTML_Entities_12.html"></a><h1 class='title level-3'>HTML Entities</h1><br/><p>------------------------------------------------------------</p><p>HTML Entities Overview</p><p>------------------------------------------------------------</p><p>HTML entities are special codes used in HTML to represent characters that would otherwise</p><p>be misinterpreted by the browser or are not easily typed on a keyboard. They act like escape </p><p>sequences, ensuring that characters such as &lt;, &gt;, or &amp; are displayed as text instead of being </p><p>treated as part of HTML code. Entities are also used to include special symbols, accented </p><p>characters, and non-breaking spaces in web content.</p><p></p><p>------------------------------------------------------------</p><p>Structure of an HTML Entity</p><p>------------------------------------------------------------</p><p>An HTML entity typically has three parts:<ol><li>Ampersand (&amp;) — signals the start of an entity.</li><li>Entity name or number — describes the desired character.<ul><li>Named entity: &amp;lt; for &quot;&lt;&quot;</li><li>Decimal entity: &amp;#60; for &quot;&lt;&quot;</li><li>Hex entity: &amp;#x3C; for &quot;&lt;&quot;</li></ul></li><li>Semicolon (;) — signals the end of the entity.</li></ol></p><p></p><p>Example:<ul><li>&amp;lt;  → &lt;</li><li>&amp;gt;  → &gt;</li><li>&amp;amp; → &amp;</li><li>&amp;#169; or &amp;#x00A9; → ©</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Why HTML Entities Are Important</p><p>------------------------------------------------------------<ol><li>Reserved Characters: Some characters have meaning in HTML. Entities prevent confusion.<ul><li>&lt; is used for tags.</li><li>&amp; is used to introduce entities.</li><li>&quot; is used for attribute values.</li></ul></li></ol></p><p><ol><li>Special Symbols: Symbols like ©, ®, ™, or € can be displayed using entities.</li></ol></p><p><ol><li>Non-ASCII Characters: Entities provide support for accented letters and characters beyond the English keyboard.</li></ol></p><p><ol><li>Compatibility: Entities ensure consistent rendering across browsers and systems.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Common HTML Entities</p><p>------------------------------------------------------------</p><p>&amp;lt;       &lt;        Less-than sign</p><p>&amp;gt;       &gt;        Greater-than sign</p><p>&amp;amp;      &amp;        Ampersand</p><p>&amp;quot;     &quot;        Double quote</p><p>&amp;apos;     &#39;        Apostrophe</p><p></p><p>Spaces:</p><p>&amp;nbsp;    Non-breaking space (prevents line break)</p><p>&amp;ensp;    En space (wider than normal space)</p><p>&amp;emsp;    Em space (extra wide space)</p><p>&amp;thinsp;  Thin space (narrower space)</p><p></p><p>Currency:</p><p>&amp;cent;    ¢</p><p>&amp;pound;   £</p><p>&amp;yen;     ¥</p><p>&amp;euro;    €</p><p>&amp;dollar;  $</p><p></p><p>Math and Logic:</p><p>&amp;plus;    +</p><p>&amp;minus;   −</p><p>&amp;times;   ×</p><p>&amp;divide;  ÷</p><p>&amp;equals;  =</p><p>&amp;ne;      ≠</p><p>&amp;le;      ≤</p><p>&amp;ge;      ≥</p><p>&amp;plusmn;  ±</p><p></p><p>Punctuation and Marks:</p><p>&amp;copy;    ©</p><p>&amp;reg;     ®</p><p>&amp;trade;   ™</p><p>&amp;sect;    §</p><p>&amp;para;    ¶</p><p>&amp;hellip;  …</p><p>&amp;bull;    •</p><p>&amp;mdash;   —</p><p>&amp;ndash;   –</p><p></p><p>Arrows:</p><p>&amp;rarr;    →</p><p>&amp;larr;    ←</p><p>&amp;uarr;    ↑</p><p>&amp;darr;    ↓</p><p></p><p>Greek Letters:</p><p>&amp;alpha;   α</p><p>&amp;beta;    β</p><p>&amp;gamma;   γ</p><p>&amp;delta;   δ</p><p>&amp;pi;      π</p><p>&amp;sigma;   σ</p><p>&amp;theta;   θ</p><p>&amp;omega;   ω</p><p></p><p>------------------------------------------------------------</p><p>Practical Example</p><p>------------------------------------------------------------</p><p>Suppose you want to display this sentence in a browser:</p><p></p><p>If x &lt; 10 &amp; y &gt; 20, print &quot;Yes&quot;.</p><p></p><p>Directly writing it would confuse the browser, since &lt;, &gt;, and &amp; </p><p>are reserved characters. Using HTML entities:</p><p></p><p>If x &amp;lt; 10 &amp;amp; y &amp;gt; 20, print &amp;quot;Yes&amp;quot;.</p><p></p><p>This renders correctly as:</p><p>If x &lt; 10 &amp; y &gt; 20, print &quot;Yes&quot;.</p><p></p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--HTML_Entities--HTML_Entities_Reference_Table_(Most_Useful_Symbols)_13.html"></a><h1 class='title level-4'>HTML Entities Reference Table (Most Useful Symbols)</h1><br/><p>------------------------------------------------------------</p><p>HTML Entities Reference Table (Most Useful Symbols)</p><p>------------------------------------------------------------</p><p></p><p>Reserved Characters</p><p>&amp;lt;      &lt;         Less-than sign</p><p>&amp;gt;      &gt;         Greater-than sign</p><p>&amp;amp;     &amp;         Ampersand</p><p>&amp;quot;    &quot;         Double quote</p><p>&amp;apos;    &#39;         Apostrophe (single quote)</p><p></p><p>Spaces</p><p>&amp;nbsp;   (non-breaking space)   Prevents line break</p><p>&amp;ensp;   (en space)             Wider than normal space</p><p>&amp;emsp;   (em space)             Extra wide space</p><p>&amp;thinsp; (thin space)           Narrower than normal space</p><p></p><p>Currency</p><p>&amp;cent;   ¢         Cent sign</p><p>&amp;pound;  £         Pound sterling</p><p>&amp;yen;    ¥         Japanese yen</p><p>&amp;euro;   €         Euro</p><p>&amp;dollar; $         Dollar (alternative to typing $ directly)</p><p></p><p>Math and Logic</p><p>&amp;plus;   +         Plus sign</p><p>&amp;minus;  −         Minus sign</p><p>&amp;times;  ×         Multiplication</p><p>&amp;divide; ÷         Division</p><p>&amp;equals; =         Equals sign</p><p>&amp;ne;     ≠         Not equal</p><p>&amp;le;     ≤         Less than or equal</p><p>&amp;ge;     ≥         Greater than or equal</p><p>&amp;plusmn; ±         Plus/minus</p><p></p><p>Punctuation and Marks</p><p>&amp;copy;   ©         Copyright</p><p>&amp;reg;    ®         Registered trademark</p><p>&amp;trade;  ™         Trademark</p><p>&amp;sect;   §         Section symbol</p><p>&amp;para;   ¶         Paragraph symbol</p><p>&amp;hellip; …         Ellipsis</p><p>&amp;bull;   •         Bullet</p><p>&amp;mdash;  —         Em dash</p><p>&amp;ndash;  –         En dash</p><p></p><p>Arrows</p><p>&amp;rarr;   →         Right arrow</p><p>&amp;larr;   ←         Left arrow</p><p>&amp;uarr;   ↑         Up arrow</p><p>&amp;darr;   ↓         Down arrow</p><p></p><p>Greek Letters (common in science/crypto)</p><p>&amp;alpha;  α         Alpha</p><p>&amp;beta;   β         Beta</p><p>&amp;gamma;  γ         Gamma</p><p>&amp;delta;  δ         Delta</p><p>&amp;pi;     π         Pi</p><p>&amp;sigma;  σ         Sigma</p><p>&amp;theta;  θ         Theta</p><p>&amp;omega;  ω         Omega</p><p></p><p>------------------------------------------------------------</p><p>Usage Example</p><p>------------------------------------------------------------</p><p>HTML code:</p><p>If x &amp;lt; 10 &amp;amp; y &amp;gt; 20, then &amp;pi; ≈ 3.14&amp;nbsp;&amp;rarr;&amp;nbsp;Done.</p><p></p><p>Browser output:</p><p>If x &lt; 10 &amp; y &gt; 20, then π ≈ 3.14 → Done.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--URL_Encoding_14.html"></a><h1 class='title level-3'>URL Encoding</h1><br/><p>------------------------------------------------------------</p><p>URL Encoding (Percent-Encoding) Overview</p><p>------------------------------------------------------------</p><p>URL encoding is a method of making URLs safe for transmission by converting characters </p><p>that are reserved, unsafe, or non-ASCII into a special format. Each unsafe character is </p><p>represented by a percent sign (%) followed by two hexadecimal digits corresponding to </p><p>the character’s ASCII (or UTF-8) value. This is why it is often called percent-encoding.</p><p></p><p>For example:<ul><li>A space (&quot; &quot;) is encoded as %20.</li><li>An apostrophe (&#39;) is encoded as %27.</li><li>The character ü is encoded in UTF-8 as C3 BC and becomes %C3%BC.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Why URL Encoding is Needed</p><p>------------------------------------------------------------<ol><li>Reserved characters in URLs have structural meaning:<ul><li>&quot;?&quot; starts a query string.</li><li>&quot;&amp;&quot; separates query parameters.</li><li>&quot;=&quot; assigns values.</li></ul></li></ol></p><p>   If you want to include these symbols as data, you must encode them.</p><p>   <ol><li>Non-ASCII characters (like accented letters or Chinese characters) cannot be sent directly  in a URL. Encoding allows them to be represented safely. </li><li>Encoding ensures clarity, prevents ambiguity, and protects against some types of injection  attacks by preserving intended structure.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Unreserved vs Reserved Characters</p><p>------------------------------------------------------------</p><p>Unreserved (safe without encoding):<ul><li>Letters: A–Z, a–z</li><li>Numbers: 0–9</li><li>Symbols: - _ . ~</li></ul></p><p></p><p>Reserved (must be encoded if used as data):</p><p>: / ? # [ ] @ ! $ &amp; &#39; ( ) * + , ; =</p><p></p><p>------------------------------------------------------------</p><p>Common URL Encodings (Cheat Sheet)</p><p>------------------------------------------------------------</p><p>Space        &quot; &quot;   -&gt; %20  (sometimes + in query strings)</p><p>Exclamation  &quot;!&quot;   -&gt; %21</p><p>Quote        &quot;\&quot;&quot;  -&gt; %22</p><p>Hash         &quot;#&quot;   -&gt; %23</p><p>Percent      &quot;%&quot;   -&gt; %25</p><p>Ampersand    &quot;&amp;&quot;   -&gt; %26</p><p>Apostrophe   &quot;&#39;&quot;   -&gt; %27</p><p>Parenthesis  &quot;(&quot;   -&gt; %28   &quot;)&quot; -&gt; %29</p><p>Asterisk     &quot;*&quot;   -&gt; %2A</p><p>Plus         &quot;+&quot;   -&gt; %2B</p><p>Comma        &quot;,&quot;   -&gt; %2C</p><p>Slash        &quot;/&quot;   -&gt; %2F</p><p>Colon        &quot;:&quot;   -&gt; %3A</p><p>Semicolon    &quot;;&quot;   -&gt; %3B</p><p>Equals       &quot;=&quot;   -&gt; %3D</p><p>Question     &quot;?&quot;   -&gt; %3F</p><p>At symbol    &quot;@&quot;   -&gt; %40</p><p></p><p>------------------------------------------------------------</p><p>Practical Example</p><p>------------------------------------------------------------</p><p>Raw URL:</p><p><a href="https://example.com/search?query=cyber">https://example.com/search?query=cyber</a> security&amp;level=master&#39;s</p><p></p><p>Encoded URL:</p><p><a href="https://example.com/search?query=cyber%20security&level=master%27s">https://example.com/search?query=cyber%20security&amp;level=master%27s</a></p><p><ul><li>Space -&gt; %20</li><li>Apostrophe -&gt; %27</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Summary</p><p>------------------------------------------------------------</p><p>URL encoding (percent-encoding) ensures that special, reserved, or non-ASCII characters </p><p>can be safely included in URLs. It works by translating characters into a % followed by </p><p>their hexadecimal ASCII/UTF-8 codes. This guarantees that web servers and browsers </p><p>interpret the data as intended.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--%2E_15.html"></a><h1 class='title level-3'>%2E</h1><br/><p>------------------------------------------------------------</p><p>What is %2E?</p><p>------------------------------------------------------------<ul><li>%2E is the URL-encoded representation of the **dot character (.)**.</li><li>ASCII decimal value of &quot;.&quot; is 46 → hexadecimal is 2E → URL encoded form is %2E.</li><li>URL encoding replaces special characters with a &quot;%&quot; followed by their hex code.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Why Attackers Use %2E</p><p>------------------------------------------------------------<ul><li>**Obfuscation of URLs**  </li></ul></p><p>  Attackers replace dots with %2E to make malicious domains less recognizable.  </p><p>  Example: `<a href="http://example%2Ecom">http://example%2Ecom</a>` instead of `<a href="http://example.com">http://example.com</a>`.</p><p><ul><li>**Bypassing Filters/Scanners**  </li></ul></p><p>  Some older or poorly designed email security filters may not decode the URL before checking.  </p><p>  Example: a blocklist might stop `bad.com` but miss `bad%2Ecom`.</p><p><ul><li>**Hiding Redirection Paths**  </li></ul></p><p>  Encoded dots can hide suspicious subdomains or paths.  </p><p>  Example: `<a href="http://login%2Ebank%2Ecom%2Eevilsite%2Eru">http://login%2Ebank%2Ecom%2Eevilsite%2Eru</a>`  </p><p>  Decodes to: `<a href="http://login.bank.com.evilsite.ru">http://login.bank.com.evilsite.ru</a>`</p><p></p><p>------------------------------------------------------------</p><p>Relevance to Email Content Analysis</p><p>------------------------------------------------------------<ul><li>**Look for Encoded Dots in Links**: Always decode `%2E` to see the true domain.  </li><li>**Identify Obfuscation**: %2E is a red flag that someone may be disguising the destination.  </li><li>**Cross-check Decoded Links**: Verify the decoded domain against threat intelligence or known safe lists.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Example</p><p>------------------------------------------------------------</p><p>Phishing email contains link:  </p><p>`<a href="http://secure%2Epaypal%2Ecom%2Eupdate-login%2Ephishingsite%2Enet">http://secure%2Epaypal%2Ecom%2Eupdate-login%2Ephishingsite%2Enet</a>`</p><p></p><p>Step 1: Decode `%2E` →  </p><p>`<a href="http://secure.paypal.com.update-login.phishingsite.net">http://secure.paypal.com.update-login.phishingsite.net</a>`</p><p></p><p>Step 2: Analyze domain →  <ul><li>True domain is `phishingsite.net`  </li><li>&quot;secure.paypal.com.update-login&quot; is just a misleading subdomain.</li></ul></p><p></p><p>Step 3: Conclusion →  <ul><li>Obfuscation attempt using %2E.  </li><li>Confirms phishing attempt.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Memory Aid</p><p>------------------------------------------------------------<ul><li>**%2E = dot (.)**</li><li>If you see %2E in an email link, think **&quot;dot hiding&quot;**.</li><li>Rule: **Always decode before you trust.**</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Content_Analysis--Quoted_Printable_16.html"></a><h1 class='title level-3'>Quoted Printable</h1><br/><p>------------------------------------------------------------</p><p>What is Quoted-Printable Encoding?</p><p>------------------------------------------------------------<ul><li>Quoted-Printable (QP) is a content transfer encoding defined in **MIME (Multipurpose Internet Mail Extensions)**.</li><li>Its goal: ensure that **8-bit data** (like accented characters or binary data) can be safely transmitted over systems that only support **7-bit ASCII**.</li><li>Basic rule: </li></ul></p><p>  - ASCII characters (letters, digits, punctuation) stay the same.</p><p>  - Non-printable characters or special bytes are encoded as:</p><p>    `=XX`</p><p>    - `=` signals the start of encoding.</p><p>    - `XX` is the hexadecimal value of the byte.<ul><li>Example: </li></ul></p><p>  - The character `=` is reserved, so it becomes `=3D`.</p><p>  - The non-breaking space (` `) might appear as `=A0`.</p><p></p><p>------------------------------------------------------------</p><p>Why is Quoted-Printable Used?</p><p>------------------------------------------------------------<ul><li>**Legitimate use**:</li></ul></p><p>  - To handle extended characters in different languages.</p><p>  - To encode email bodies that mix plain ASCII with special symbols.<ul><li>**Attack/obfuscation use**:</li></ul></p><p>  - Attackers may deliberately encode parts of text (like URLs, keywords, or payloads) to evade detection by security tools.</p><p>  - Human users see normal text when decoded, but scanners that don’t normalize content may miss it.</p><p></p><p>------------------------------------------------------------</p><p>Relevance to Email Content Analysis</p><p>------------------------------------------------------------<ul><li>Analysts must **decode QP** to reveal the true text.</li><li>Watch for:</li></ul></p><p>  - **Encoded URLs**: e.g., `<a href="http://evil=2Ecom">http://evil=2Ecom</a>` → decodes to `<a href="http://evil.com">http://evil.com</a>`</p><p>  - **Hidden payloads**: JavaScript, attachments, or commands encoded to slip past filters.</p><p>  - **Suspicious keywords**: “password,” “login,” or “bank” encoded to avoid keyword filters.</p><p></p><p>------------------------------------------------------------</p><p>Example</p><p>------------------------------------------------------------</p><p>Phishing email body (raw view):</p><p></p><p>Please verify your account at:</p><p><a href="http://secure=2Ebanking=2Eupdate=2Elogin=2Eevilsite=2Enet">http://secure=2Ebanking=2Eupdate=2Elogin=2Eevilsite=2Enet</a></p><p></p><p></p><p>Step 1: Decode Quoted-Printable  <ul><li>`=2E` → `.`  </li><li>Link becomes:  </li></ul></p><p>  `<a href="http://secure.banking.update.login.evilsite.net">http://secure.banking.update.login.evilsite.net</a>`</p><p></p><p>Step 2: Analyze domain  <ul><li>The real domain is `evilsite.net`  </li><li>Everything before is a misleading subdomain chain.</li></ul></p><p></p><p>Step 3: Conclusion  <ul><li>The attacker used QP encoding to disguise the URL.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Key Observations</p><p>------------------------------------------------------------<ul><li>Quoted-Printable often looks like lots of `=` followed by two hex digits.</li><li>Very common in spam and phishing as an **obfuscation technique**.</li><li>Best practice: Always decode before analysis.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Memory Aid</p><p>------------------------------------------------------------<ul><li>**Quoted-Printable = &quot;Equals-hex&quot; encoding.**</li><li>If you see `=XX`, think: **hidden character**.</li><li>Rule: **Decode `=XX` before trusting what you see.**</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--The_Anatomy_of_a_URL_17.html"></a><h1 class='title level-2'>The Anatomy of a URL</h1><br/><p>------------------------------------------------------------</p><p>Anatomy of a URL</p><p>------------------------------------------------------------</p><p></p><p>When analyzing email content, especially phishing attempts, one of the most important skills is the ability to break down and interpret a URL. A URL (Uniform Resource Locator) is essentially the &quot;address&quot; of a resource on the internet, such as a webpage, image, or file. Understanding the structure helps distinguish legitimate sites from malicious ones. Let’s walk through its anatomy step by step.</p><p></p><p>At its simplest, a URL looks like this:</p><p></p><p>    <a href="https://www.example.com:443/path/to/page?query=value#section">https://www.example.com:443/path/to/page?query=value#section</a></p><p></p><p>Each part has a specific purpose:</p><p><ol><li>**Scheme (Protocol)**  <ul><li>This is the beginning of the URL, ending with `://`.  </li><li>It specifies how data should be transferred.  </li><li>Common examples:  </li></ul></li></ol></p><p>     - `http` (Hypertext Transfer Protocol – insecure, plain text)  </p><p>     - `https` (HTTP Secure – encrypted with TLS/SSL, preferred for sensitive data)  </p><p>     - `ftp` (File Transfer Protocol)  <ul><li>In email analysis, spotting `http` instead of `https` on supposed bank or login sites is a warning sign.</li></ul></p><p><ol><li>**Domain (Host / Authority)**  <ul><li>The domain is the most critical piece — it tells you *which server* you’re connecting to.  </li><li>Example: `<a href="http://www.example.com">www.example.com</a>`  </li><li>The **Top-Level Domain (TLD)** is the last part (`.com`, `.org`, `.ru`).  </li><li>The **Second-Level Domain (SLD)** is what precedes the TLD (`example` in `example.com`).  </li><li>Subdomains appear before this (`www` or `login`).  </li><li>**Phishing risk**: attackers often add extra subdomains to trick users.  </li></ul></li></ol></p><p>     - Example: `secure.paypal.com.malicious.net` → the *real domain* is `malicious.net`.</p><p><ol><li>**Port**  <ul><li>Follows the domain, introduced by a colon.  </li><li>Default ports are usually implied and don’t show:  </li></ul></li></ol></p><p>     - HTTP → 80  </p><p>     - HTTPS → 443  <ul><li>Attackers may specify odd or non-standard ports (e.g., `:8080`, `:1337`) to host malicious services.  </li></ul></p><p><ol><li>**Path**  <ul><li>Comes after the domain (and optional port), introduced by a `/`.  </li><li>Points to a specific resource or page on the server.  </li><li>Example: `/path/to/page`  </li><li>Attackers may use long, confusing, or legitimate-looking paths to trick users:  </li></ul></li></ol></p><p>     - `<a href="https://bank.com/secure/login/update/account">https://bank.com/secure/login/update/account</a>`  </p><p><ol><li>**Query String (Parameters)**  <ul><li>Begins with a `?` and contains key-value pairs separated by `=` and joined by `&amp;`.  </li><li>Example: `?query=value&amp;user=123`  </li><li>Used legitimately for search terms, tracking, or passing data to the server.  </li><li>Attackers may use it to pass session IDs, encoded payloads, or redirect instructions.  </li></ul></li></ol></p><p><ol><li>**Fragment (Anchor)**  <ul><li>Begins with a `#` and points to a specific section within a webpage.  </li><li>Example: `#section`  </li><li>Fragments are generally harmless but can sometimes be used in obfuscation.  </li></ul></li></ol></p><p></p><p>------------------------------------------------------------</p><p>Putting It Together</p><p>------------------------------------------------------------</p><p>In the sample URL:</p><p></p><p>    <a href="https://www.example.com:443/path/to/page?query=value#section">https://www.example.com:443/path/to/page?query=value#section</a></p><p><ul><li>**Scheme**: `https`</li><li>**Domain**: `<a href="http://www.example.com">www.example.com</a>` (TLD = `.com`, SLD = `example`)</li><li>**Port**: `443`</li><li>**Path**: `/path/to/page`</li><li>**Query**: `query=value`</li><li>**Fragment**: `#section`</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Why This Matters in Email Content Analysis</p><p>------------------------------------------------------------<ul><li>Attackers rely heavily on manipulating domains and subdomains to disguise malicious URLs.  </li><li>Long paths and query strings are often used to confuse users or hide redirection.  </li><li>Decoding and dissecting a URL is essential to reveal the *true destination* and assess risk.  </li><li>Recognizing the *real registered domain* (SLD + TLD) is the key to spotting phishing attempts.  </p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--The_Anatomy_of_a_URL--Phishing_URLs_18.html"></a><h1 class='title level-3'>Phishing URLs</h1><br/><p>------------------------------------------------------------</p><p>Phishing URL — Narrative Analysis &amp; Diagram</p><p>------------------------------------------------------------</p><p></p><p>Sample URL (from course):</p><p>    <a href="http://apple-login.dnsdyn.net/ODFTY/index.php?email=asimpson@example.com">http://apple-login.dnsdyn.net/ODFTY/index.php?email=asimpson@example.com</a></p><p></p><p>**High-level verdict:** This is a phishing URL. It impersonates Apple by placing “apple-login” in a **subdomain**, uses **HTTP** (no TLS encryption), and includes a **tracking parameter** (`email=`) to personalize the lure.</p><p></p><p>------------------------------------------------------------</p><p>Step-by-Step Narrative</p><p>------------------------------------------------------------</p><p><ol><li>Scheme / Protocol: `<a href="http://">http://</a>`</li><li>**What it is:** The transfer method. Common schemes include `http`, `https`, `ftp`, etc.</li><li>**Red flag:** For any login to a major brand (e.g., Apple), you should expect **HTTPS** (TLS/SSL). Lack of HTTPS = high risk of credential theft and tampering.</li></ol></p><p><ol><li>Domain (Registered Domain + Subdomains): `apple-login.dnsdyn.net`</li><li>**Registered domain:** `dnsdyn.net` (Second-Level Domain = `dnsdyn`, Top-Level Domain = `.net`).</li><li>**Subdomain:** `apple-login` (placed **before** the registered domain).</li><li>**Phishing trick:** Attackers put the brand name in the subdomain (left side) to look authentic at a glance.</li><li>**Analyst rule:** Read the **domain from right to left**. The true owner is the **registered domain** (`dnsdyn.net`), not the subdomain (`apple-login`).</li></ol></p><p><ol><li>Path: `/ODFTY/index.php`</li><li>**What it is:** The file or resource on the server.</li><li>**Why suspicious:** `ODFTY` appears random, a common sign of attacker-controlled hosting directories. Legit Apple login flows use predictable, branded paths (e.g., `<a href="https://appleid.apple.com/">https://appleid.apple.com/</a>`).</li></ol></p><p><ol><li>Query String (Parameters): `?email=asimpson@example.com`</li><li>**What it is:** Key–value pairs sent to the server (syntax: `?key=value&amp;key2=value2`).</li><li>**Likely purpose here:** Personalized bait and **victim tracking**. The form may prefill the email field, increasing credibility and capture rate.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Why This Is Phishing (Concise)</p><p>------------------------------------------------------------<ul><li>**Brand impersonation via subdomain:** `apple-login` is *not* the registered domain.</li><li>**No encryption:** `<a href="http://">http://</a>` on a supposed login page is unacceptable for a real Apple property.</li><li>**Odd pathing:** A random folder plus `index.php` is typical of credential-harvesting kits.</li><li>**Targeting signal:** `email=` parameter ties the link to a specific victim.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Analyst’s Quick Checks (Memory Aids)</p><p>------------------------------------------------------------<ul><li>**Right-to-left rule:** Identify the **registered domain** (SLD + TLD). Everything left of it is just a subdomain.</li><li>**HTTPS expectation:** Real login pages for major brands should be **HTTPS** with a valid certificate.</li><li>**Normalize &amp; decode:** Unescape URL encodings (`%2E`, `%2F`, etc.) before deciding. Attackers obfuscate dots, slashes, or even whole hostnames.</li><li>**Parameter scrutiny:** Look for user identifiers (`email=`, `uid=`, `token=`) that indicate tracking and mass phishing campaigns.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>ASCII Diagram — Labeled URL Parts</p><p>------------------------------------------------------------</p><p></p><p>    <a href="http://apple-login.dnsdyn.net/ODFTY/index.php?email=asimpson@example.com">http://apple-login.dnsdyn.net/ODFTY/index.php?email=asimpson@example.com</a></p><p>    |___||_______________________________________________________________|</p><p>     |                                |                     |            |</p><p>     |                                |                     |            |</p><p>  Scheme/Protocol                 Host (Authority)         Path       Query</p><p>  (&quot;http&quot; = no TLS)               └─────────────────────────────────────────────┐</p><p>                                         Domain breakdown                       │</p><p>                                         ┌──────────────┬──────┐               │</p><p>                                         |  SLD = dnsdyn| TLD  |               │</p><p>                                         |              | .net |               │</p><p>                              Subdomain ─┘   (Registered Domain)               │</p><p>                              &quot;apple-login&quot;                                    │</p><p>                                                                               </p><p>    Detailed split:</p><p>    ┌───────────┐  ┌──────────────────────────────┐         ┌──────────────┐</p><p>    http        :// apple-login.dnsdyn.net         /ODFTY/   index.php      ?email=asimpson@example.com</p><p>    │            │  │              └─────────────┘  │        │              │</p><p>    │            │  │                Registered     │        │              │</p><p>    │            │  │                Domain         │        │              │</p><p>    │            │  └─ Subdomain (brand bait)       │        File           Key–value parameter</p><p>    Scheme       Separator         Hostname         Path     (script)       (tracking/prefill)</p><p></p><p>------------------------------------------------------------</p><p>Key Terms (for retention)</p><p>------------------------------------------------------------<ul><li>**URL (Uniform Resource Locator):** The web “address” of a resource.</li><li>**Scheme:** The protocol (e.g., HTTP, HTTPS) that defines how data is transferred.</li><li>**Host / Authority:** The domain name (plus optional port) of the server.</li><li>**Registered Domain:** The **actual** ownership point (SLD + TLD), e.g., `dnsdyn.net`.</li><li>**Subdomain:** A label to the left of the registered domain, often used for structure—or deception.</li><li>**Path:** Server-side location of a resource (folders/files).</li><li>**Query String:** `?key=value` pairs; commonly used for search, tracking, and (in phishing) personalization.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Bottom Line</p><p>------------------------------------------------------------</p><p>If the trusted brand’s name is **not** part of the **registered domain** (SLD + TLD) and you see **HTTP** or odd paths/parameters, treat the URL as **phishing** until proven otherwise.</p><p></p><p>------------------------------------------------------------</p><p>Phishing URL — Narrative Analysis &amp; Diagram</p><p>------------------------------------------------------------</p><p></p><p>Sample URL (from course):</p><p>    <a href="https://metamask-restoration-support.webflow.io">https://metamask-restoration-support.webflow.io</a></p><p></p><p>**High-level verdict:** This is a phishing URL. It impersonates **MetaMask** by using the brand name in a **subdomain**, but the actual registered domain belongs to **webflow.io** (a legitimate hosting service). Attackers abuse such platforms to quickly spin up fraudulent support pages.</p><p></p><p>------------------------------------------------------------</p><p>Step-by-Step Narrative</p><p>------------------------------------------------------------</p><p><ol><li>Scheme / Protocol: `<a href="https://">https://</a>`</li><li>**What it is:** The connection uses HTTPS (TLS/SSL).</li><li>**Why deceptive:** Presence of HTTPS (and a lock icon) is **not proof of legitimacy**. Attackers can easily obtain free TLS certificates (e.g., via Let’s Encrypt). Users may be falsely reassured.</li></ol></p><p><ol><li>Domain (Registered Domain + Subdomains): `metamask-restoration-support.webflow.io`</li><li>**Registered domain:** `webflow.io` (Second-Level Domain = `webflow`, Top-Level Domain = `.io`).</li><li>**Subdomain:** `metamask-restoration-support`</li><li>**Phishing trick:** The attacker embeds the brand name `metamask` along with keywords like `restoration` and `support` to trick users into thinking it is official help for account recovery.</li><li>**Analyst rule:** Read domains **right to left**. The real domain owner is `webflow.io`, not MetaMask.</li></ol></p><p><ol><li>Path: *(none provided in this example)*  </li><li>Since no `/path` is shown, the attacker likely hosted the phishing page at the root directory of their Webflow site.</li><li>Legitimate MetaMask URLs use `metamask.io` as the registered domain, not `webflow.io`.</li></ol></p><p><ol><li>Query String: *(none in this example)*  </li><li>No query string is present, but phishing sites often use parameters to track victims or prefill forms.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Why This Is Phishing (Concise)</p><p>------------------------------------------------------------<ul><li>**Brand hijacking in subdomain:** The phrase `metamask-restoration-support` is not an official MetaMask domain but an attacker-chosen subdomain of `webflow.io`.</li><li>**Platform abuse:** Attackers frequently use free or low-cost hosting providers (e.g., Webflow, Wix, Google Sites) to deploy phishing campaigns quickly.</li><li>**Psychological trick:** Keywords like &quot;restoration&quot; and &quot;support&quot; exploit urgency and fear, convincing victims to enter recovery phrases or credentials.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Analyst’s Quick Checks (Memory Aids)</p><p>------------------------------------------------------------<ul><li>**Registered domain test:** Always isolate the SLD + TLD. Here: `webflow.io`.</li><li>**Brand vs. host mismatch:** If a supposed MetaMask link resolves under another company’s domain (e.g., `webflow.io`), it is malicious.</li><li>**HTTPS ≠ safe:** Phishing sites commonly use HTTPS. Don’t trust the lock icon.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>ASCII Diagram — Labeled URL Parts</p><p>------------------------------------------------------------</p><p></p><p>    <a href="https://metamask-restoration-support.webflow.io">https://metamask-restoration-support.webflow.io</a></p><p>    |____||__________________________________________________|</p><p>     |                                |                     </p><p>     |                                |                     </p><p>  Scheme/Protocol                 Host (Authority)          </p><p>  (&quot;https&quot; = TLS, but             └───────────────────────────────────────────┐</p><p>  still potentially malicious)            Domain breakdown                     │</p><p>                                          ┌──────────────┬──────┐              │</p><p>                                          |  SLD = webflow | TLD |             │</p><p>                                          |               | .io  |             │</p><p>                               Subdomain ─┘   (Registered Domain)              │</p><p>                               &quot;metamask-restoration-support&quot;                  </p><p>                                                                               </p><p>    Detailed split:</p><p>    ┌───────────┐  ┌──────────────────────────────────────────┐</p><p>    https       :// metamask-restoration-support.webflow.io</p><p>    │            │  │                      └───────────────┘</p><p>    │            │  │                        Registered Domain</p><p>    │            │  └─ Subdomain (phishing brand lure)       </p><p>    Scheme       Separator         Hostname                  </p><p></p><p>------------------------------------------------------------</p><p>Bottom Line</p><p>------------------------------------------------------------</p><p>This URL attempts to appear as an official MetaMask support page but is actually hosted under `webflow.io`. <ul><li>**Real MetaMask domain:** `metamask.io`</li><li>**Phishing tactic:** Combining the brand name + urgent keywords in a subdomain on a hosting service.</li><li>**Analyst conclusion:** Malicious phishing URL targeting cryptocurrency wallet users.</li></ul></p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--The_Anatomy_of_a_URL--Phishing_URLs--Legitimate_URL_19.html"></a><h1 class='title level-4'>Legitimate URL</h1><br/><p>------------------------------------------------------------</p><p>Full URL Breakdown</p><p>------------------------------------------------------------</p><p>The provided URL is:</p><p></p><p><a href="https://connect.secure.wellsfargo.com/auth/login/present?origin=cob&LOB=CONS">https://connect.secure.wellsfargo.com/auth/login/present?origin=cob&amp;LOB=CONS</a></p><p></p><p>This appears to be a legitimate Wells Fargo login URL. Let’s break it down into its components.</p><p></p><p>------------------------------------------------------------<ol><li>Protocol</li></ol></p><p>------------------------------------------------------------</p><p>**<a href="https://**">https://**</a><ul><li>HTTPS stands for Hypertext Transfer Protocol Secure.</li><li>Ensures encrypted communication using TLS (Transport Layer Security).</li><li>The &quot;s&quot; in HTTPS means traffic between the client (browser) and the server is encrypted, protecting login credentials.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Subdomain and Domain</li></ol></p><p>------------------------------------------------------------</p><p>**connect.secure.wellsfargo.com**<ul><li>**wellsfargo.com** → the main domain, owned by Wells Fargo.</li><li>**secure.wellsfargo.com** → a subdomain, likely used specifically for secure customer interactions (such as online banking).</li><li>**connect** → an additional sub-subdomain, possibly related to Wells Fargo Connect services (business or customer login portals).</li></ul></p><p></p><p>The key security note: the *registered domain* is **wellsfargo.com**. As long as the certificate matches this domain and the URL hasn’t been altered (e.g., &quot;wellsfargo-com.secure.otherdomain.com&quot;), it is legitimate.</p><p></p><p>------------------------------------------------------------<ol><li>Path</li></ol></p><p>------------------------------------------------------------</p><p>**/auth/login/present**<ul><li>Indicates this URL directs the user to an authentication (auth) page.</li><li>&quot;login&quot; suggests it’s part of the login sequence.</li><li>&quot;present&quot; could mean presenting the login form to the user.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Query String</li></ol></p><p>------------------------------------------------------------</p><p>**?origin=cob&amp;LOB=CONS**<ul><li>Begins with a `?` and is followed by **key=value** pairs separated by `&amp;`.</li></ul></p><p></p><p>Breaking down:<ul><li>**origin=cob**</li></ul></p><p>  - &quot;origin&quot; likely indicates the source or context of the login.</p><p>  - &quot;cob&quot; might stand for &quot;Commercial Online Banking&quot; or &quot;Customer Online Banking&quot; depending on Wells Fargo&#39;s internal naming.</p><p><ul><li>**LOB=CONS**</li></ul></p><p>  - LOB = Line of Business.</p><p>  - &quot;CONS&quot; likely stands for &quot;Consumer&quot; (meaning personal banking customers, not business or corporate).</p><p></p><p>So these parameters tell the Wells Fargo login system which branch of their services the user is attempting to access.</p><p></p><p>------------------------------------------------------------<ol><li>Legitimacy Indicators</li></ol></p><p>------------------------------------------------------------<ul><li>Uses HTTPS (secure).</li><li>Root domain is **wellsfargo.com** (matches the legitimate financial institution).</li><li>Subdomains appear consistent with Wells Fargo’s known architecture.</li><li>Query parameters are typical for routing users correctly (business vs consumer).</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Summary</p><p>------------------------------------------------------------</p><p>This URL is structured like a legitimate Wells Fargo login page. The **protocol** ensures encryption, the **domain** is correctly registered to Wells Fargo, and the **query parameters** help route users to the correct service (likely consumer online banking). When analyzing URLs for phishing, always check:<ul><li>The root domain (must be exactly `wellsfargo.com`).</li><li>The use of HTTPS.</li><li>Whether the URL structure matches what the organization normally uses.</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis_20.html"></a><h1 class='title level-2'>Email URL Analysis</h1><br/><p>------------------------------------------------------------</p><p>Email URL Analysis – Full Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>Why Email URL Analysis Matters</li></ol></p><p>------------------------------------------------------------<ul><li>Phishing emails rely heavily on malicious links to trick users into entering credentials, downloading malware, or revealing sensitive information.</li><li>URLs act as the bridge between the email message and the attacker’s infrastructure.</li><li>As a SOC analyst or security student, your role is to dissect these URLs to determine if they are legitimate, suspicious, or outright malicious.</li></ul></p><p></p><p>Key goals of analysis:<ul><li>Inspect the **structure** of the URL.</li><li>Decode obfuscations (encoding, shortened links, hidden redirects).</li><li>Compare **visible text** vs. **actual destination**.</li><li>Identify warning signs of brand impersonation or trickery.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Anatomy of a URL in Email</li></ol></p><p>------------------------------------------------------------</p><p>A URL generally follows this format:</p><p></p><p>protocol://subdomain.domain.tld/path?query#fragment</p><p></p><p><ul><li>**Protocol** → Specifies communication type (`http`, `https`, `ftp`).</li><li>**Domain** → The registered domain (e.g., `paypal.com`).</li><li>**Subdomain** → Sits before the domain (`secure.paypal.com`).</li><li>**Path** → The specific resource or directory being requested (`/login`).</li><li>**Query String** → Parameters after `?` (e.g., `?id=123&amp;user=abc`).</li><li>**Fragment (#)** → Points to a section of the page (rarely malicious, but can be used for tricks).</li></ul></p><p></p><p>Example:</p><p></p><p><a href="https://secure.paypa1.com/login?sessionid=abc123">https://secure.paypa1.com/login?sessionid=abc123</a></p><p></p><p>Observation:<ul><li>Protocol: `https` (secure channel).</li><li>Domain: `paypa1.com` (digit &quot;1&quot; instead of &quot;l&quot;).</li><li>Path: `/login` (mimics real login page).</li><li>Query: `sessionid=abc123` (potential session tracking).</li><li>Result: This is phishing because the **root domain is wrong**.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Common Tricks in Malicious Email URLs</li></ol></p><p>------------------------------------------------------------<ol><li>**Lookalike domains**  <ul><li>Subtle typos: `paypa1.com` vs. `paypal.com`  </li><li>Homoglyphs: `rnicrosoft.com` vs. `microsoft.com`</li></ul></li></ol></p><p><ol><li>**Subdomain abuse**  <ul><li>Example: `microsoft.com.attacker.com` → the real domain is `attacker.com`.</li></ul></li></ol></p><p><ol><li>**URL encoding**  <ul><li>Example: `%2E` for a period `.` or `%2F` for `/`.  </li><li>Makes the URL harder to read at first glance.</li></ul></li></ol></p><p><ol><li>**Shortened URLs**  <ul><li>Services like `bit.ly/xyz` hide the final destination.</li></ul></li></ol></p><p><ol><li>**Long or technical-looking query strings**  <ul><li>Attackers add random parameters to overwhelm or confuse.</li></ul></li></ol></p><p><ol><li>**False sense of security with HTTPS**  <ul><li>Just because it has a padlock 🔒 doesn’t mean it’s safe.  </li><li>Attackers can also obtain valid SSL/TLS certificates.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>What Analysts Should Check</li></ol></p><p>------------------------------------------------------------</p><p>When you analyze a URL in an email:</p><p><ol><li>**Check the root domain**  <ul><li>Use WHOIS or domain lookup tools.  </li><li>Make sure it’s exactly the expected domain (`paypal.com` vs. `paypal.security.com`).</li></ul></li></ol></p><p><ol><li>**Decode encodings**  <ul><li>`%20` = space, `%2E` = `.`, `%2F` = `/`.</li></ul></li></ol></p><p><ol><li>**Expand shortened links**  <ul><li>Use online tools or `curl -I &lt;URL&gt;` to see where it points.</li></ul></li></ol></p><p><ol><li>**Compare displayed vs. actual link**  <ul><li>Example: Email text shows `<a href="https://bankofamerica.com">https://bankofamerica.com</a>`  </li><li>Hovered/clicked link is `<a href="http://malicious-site.ru/boa">http://malicious-site.ru/boa</a>`.</li></ul></li></ol></p><p><ol><li>**Look for redirects**  <ul><li>Some emails send users through tracking services before final destination.</li></ul></li></ol></p><p><ol><li>**Cross-reference with threat intelligence**  <ul><li>Use VirusTotal, URLHaus, or sandboxed environments to check.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Example Email URL Analysis</li></ol></p><p>------------------------------------------------------------</p><p>Suspicious email contains this link:</p><p></p><p><a href="https://secure.login-paypal.com/authenticate?session=99231">https://secure.login-paypal.com/authenticate?session=99231</a></p><p></p><p></p><p>Step-by-step:<ul><li>**Protocol**: HTTPS → encrypted, but that doesn’t prove safety.</li><li>**Domain**: `login-paypal.com` → this is NOT `paypal.com`.  </li><li>**Trick**: Makes it look like PayPal by including &quot;login&quot; and &quot;paypal&quot;.</li><li>**Path**: `/authenticate` → mimics real authentication process.</li><li>**Query String**: `session=99231` → typical phishing tracking or victim ID.</li></ul></p><p></p><p>**Conclusion**: This is a malicious phishing URL.</p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Checklist (SOP Style)</li></ol></p><p>------------------------------------------------------------</p><p>Use this as a repeatable process for every suspicious email URL:</p><p><ol><li>**Extract URL** from email headers or body.</li><li>**Break into components**: protocol, domain, subdomain, path, query.</li><li>**Check the registered domain** → Is it legitimate?</li><li>**Decode encodings** (`%2E`, `%20`, etc.).</li><li>**Expand shortened links** safely.</li><li>**Check for redirects** (sandbox or curl).</li><li>**Compare text vs. hyperlink** → any mismatch?</li><li>**Cross-check against threat intel databases**.</li><li>**Document findings** → screenshot + written notes.</li><li>**Determine verdict**: legitimate, suspicious, or malicious.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Summary</p><p>------------------------------------------------------------<ul><li>Email URL analysis is about looking past the surface to the *true domain*.  </li><li>Attackers rely on obfuscation: typos, encodings, subdomain tricks, and shortened links.  </li><li>A disciplined workflow lets you spot red flags systematically.  </li><li>Always confirm the root domain and test safely in controlled environments.</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Anchor_Tags_in_URL_Analysis_21.html"></a><h1 class='title level-3'>Anchor Tags in URL Analysis</h1><br/><p>------------------------------------------------------------</p><p>Anchor Tags in Email URL Analysis — Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What an Anchor Tag Is (and Why It Matters)</li></ol></p><p>------------------------------------------------------------</p><p>An anchor tag is the HTML element that makes a hyperlink. It has two faces:<ul><li>The **visible label** (what the user sees and clicks).</li><li>The **href destination** (the actual URL the browser will request).</li></ul></p><p></p><p>Basic form (shown here as indented code to avoid breaking the editor):</p><p>    &lt;a href=&quot;<a href="https://example.com">https://example.com</a>&quot;&gt;Click here&lt;/a&gt;</p><p></p><p>Why analysts care: phishing kits routinely make the label look trustworthy while the href points to an attacker-controlled site. Your job is to compare the two.</p><p></p><p>------------------------------------------------------------<ol><li>The Two Faces You Must Compare</li></ol></p><p>------------------------------------------------------------<ul><li>**Displayed text (label):** may be a brand name or even a full URL meant to inspire trust.</li><li>**Actual destination (href):** the only part that determines where the click goes.</li></ul></p><p></p><p>Mantra: **Never trust the label—inspect the href.**</p><p></p><p>Illustrative mismatch:</p><p>    &lt;a href=&quot;<a href="http://malicious-site.ru/login">http://malicious-site.ru/login</a>&quot;&gt;<a href="https://wellsfargo.com/login">https://wellsfargo.com/login</a>&lt;/a&gt;</p><p>Here the label is a legit-looking Wells Fargo URL, but the real destination is an attacker domain.</p><p></p><p>An **anchor tag** in HTML is the element that creates a hyperlink, allowing users to click and navigate to another resource such as a web page, file, or even a section within the same document. It is written as `&lt;a&gt;` (the “a” stands for “anchor”) and almost always includes an `href` attribute, which specifies the **destination URL**. The text placed between `&lt;a&gt;` and `&lt;/a&gt;` is what the user sees and clicks on. For example, `&lt;a href=&quot;<a href="https://example.com">https://example.com</a>&quot;&gt;Visit Example&lt;/a&gt;` would display the clickable text *Visit Example*, which directs the browser to `<a href="https://example.com">https://example.com</a>`. Anchor tags can point to external websites, internal pages, downloadable files, or use special schemes like `mailto:` to open an email client or `tel:` to initiate a phone call.</p><p></p><p>Common types of anchor tags include:<ul><li>**External link anchors** → Connect to a different website (e.g., linking from `nytimes.com` to `cnn.com`).</li><li>**Internal link anchors** → Navigate within the same site (e.g., linking from the homepage to a contact page).</li><li>**Anchor links to sections** → Use an ID with `#` to jump to a specific part of a page, such as `&lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt;`.</li><li>**Email and phone anchors** → Use schemes like `&lt;a href=&quot;mailto:help@example.com&quot;&gt;Email Us&lt;/a&gt;` or `&lt;a href=&quot;tel:18001234567&quot;&gt;Call Us&lt;/a&gt;`.</li><li>**Download anchors** → Point to a file so that clicking triggers a download, for example, `&lt;a href=&quot;report.pdf&quot;&gt;Download Report&lt;/a&gt;`.</li></ul></p><p></p><p>Because anchor tags are so versatile and widely used, they are also heavily abused in phishing emails, where the **visible label may look safe** but the `href` points to a malicious site.</p><p></p><p></p><p>------------------------------------------------------------<ol><li>Red Flags Specific to Anchor Tags</li></ol></p><p>------------------------------------------------------------<ul><li>**Label vs. href mismatch**</li></ul></p><p>  - Label: <a href="https://paypal.com">https://paypal.com</a></p><p>  - Href:  <a href="http://login-paypa1.com/session">http://login-paypa1.com/session</a><ul><li>**Brand name buried inside an attacker’s domain**</li></ul></p><p>  - Href:  <a href="http://microsoft.com.attacker-domain.io/security">http://microsoft.com.attacker-domain.io/security</a></p><p>  - Registered domain is attacker-domain.io, not microsoft.com.<ul><li>**Shortened links that hide the endpoint**</li></ul></p><p>  - Href:  <a href="http://bit.ly/xyz123">http://bit.ly/xyz123</a><ul><li>**Encoded/obfuscated href**</li></ul></p><p>  - Href:  <a href="http://evil.tld/%2E%2E/paypal/verify">http://evil.tld/%2E%2E/paypal/verify</a>    (%2E=&quot;.&quot;, %2F=&quot;/&quot;)<ul><li>**JavaScript or data URIs** (uncommon in legitimate marketing)</li></ul></p><p>  - Href:  javascript:collect()</p><p>  - Href:  data:text/html;base64,....<ul><li>**Overly long, technical query strings** intended to overwhelm</li></ul></p><p>  - Href:  <a href="https://site.tld/login?auth=...&token=...&redirect=...&rand=...">https://site.tld/login?auth=...&amp;token=...&amp;redirect=...&amp;rand=...</a></p><p></p><p>------------------------------------------------------------<ol><li>Safe Analyst Workflow (Anchor-Focused)</li></ol></p><p>------------------------------------------------------------<ol><li>**Open the message source safely** (message/rfc822, raw/HTML view).<ul><li>Extract every occurrence of:  &lt;a ... href=&quot;...&quot;&gt;...&lt;/a&gt;</li></ul></li><li>**Record both values** for each link:<ul><li>**Label** (displayed text)</li><li>**Href** (actual destination)</li></ul></li><li>**Normalize the href** before judging:<ul><li>Decode URL encodings (%2E, %2F, %20, etc.).</li><li>Unshorten shortened links.</li><li>Follow redirects only in a sandbox (head requests or controlled detonations).</li></ul></li><li>**Validate the registered domain** from right to left:<ul><li>Example: in sub.brand.example.co.uk, the registered domain is example.co.uk.</li><li>Beware of brand words placed left of the attacker’s domain (e.g., wellsFargo.login.attacker.tld).</li></ul></li><li>**Decide and document**:<ul><li>Verdict: Legit / Suspicious / Malicious.</li><li>One-line justification referencing the anchor evidence (e.g., “Label shows bank domain; href resolves via bit.ly to non-bank host → malicious.”)</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Examples (Legitimate vs. Phishing)</li></ol></p><p>------------------------------------------------------------</p><p>Legitimate anchor:</p><p>    &lt;a href=&quot;<a href="https://secure.wellsfargo.com/auth/login">https://secure.wellsfargo.com/auth/login</a>&quot;&gt;Login to Wells Fargo&lt;/a&gt;<ul><li>Label: “Login to Wells Fargo”</li><li>Href:  <a href="https://secure.wellsfargo.com/auth/login">https://secure.wellsfargo.com/auth/login</a>  (registered domain: wellsfargo.com)</li></ul></p><p></p><p>Phishing anchor:</p><p>    &lt;a href=&quot;<a href="http://secure-wellsfargo.loginverify.ru/auth">http://secure-wellsfargo.loginverify.ru/auth</a>&quot;&gt;Login to Wells Fargo&lt;/a&gt;<ul><li>Label: “Login to Wells Fargo”</li><li>Href resolves to loginverify.ru (attacker domain using “wellsfargo” as a subdomain decoy)</li></ul></p><p></p><p>Another phishing pattern (typo and path mimicry):</p><p>    &lt;a href=&quot;<a href="https://secure.paypa1.com/authenticate?session=99231">https://secure.paypa1.com/authenticate?session=99231</a>&quot;&gt;Resolve issue&lt;/a&gt;<ul><li>Registered domain: paypa1.com (digit “1” replacing “l”)</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Practical Techniques &amp; Tips</li></ol></p><p>------------------------------------------------------------<ul><li>**Hover-to-preview** in a safe viewer: most clients show the true href in a status bar.</li><li>**Copy link address** (don’t click) to capture the href verbatim for decoding.</li><li>**Compare hostnames exactly** (pay attention to dots, hyphens, and homoglyphs).</li><li>**Don’t be fooled by HTTPS**: padlocks don’t prove legitimacy; attackers obtain TLS certs too.</li><li>**Watch for tracking hops**: marketing trackers can be legitimate; malicious chains usually end on an unrelated, freshly registered, or low-reputation domain.</li><li>**Keep evidence tidy**: store the pair (Label, Href, Verdict) in your case notes for reproducibility.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Quick Reference: What Each Part Means (Memory Aid)</li></ol></p><p>------------------------------------------------------------<ul><li>**Label**: Human-facing text; easy to fake; never authoritative.</li><li>**href**: Machine-facing destination; authoritative for where the click goes.</li><li>**Registered domain**: The deciding factor for ownership; read right-to-left.</li><li>**Path/query**: Often mimics real apps (/auth/login, ?session=...), but cannot “fix” a bad domain.</li><li>**Encoding**: %2E (.), %2F (/), %20 (space); decoding removes obfuscation.</li><li>**Shorteners/redirects**: Expand and verify in sandbox before judging.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>Anchor tags are a prime vehicle for phishing because they separate **appearance** (label) from **reality** (href). A disciplined process—extract, decode, expand, verify the registered domain, and document—lets you spot deception reliably and defend users against credential theft and malware delivery.</p><p></p><p></p><p>------------------------------------------------------------</p><p>Comparing Anchor Tag Label vs. Href on Mobile (iPhone Example)</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>Why This Is Harder on Mobile</li></ol></p><p>------------------------------------------------------------<ul><li>On desktop, users can hover their mouse over a link to preview the true destination (the href).</li><li>On mobile devices (like an iPhone), there is no “hover” function, so attackers rely on this weakness to hide phishing URLs more effectively.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Safe Methods on iPhone</li></ol></p><p>------------------------------------------------------------</p><p>**Option 1: Long-Press the Link**<ul><li>Press and hold your finger on the link in the email.</li><li>A preview window will pop up showing the **actual URL** (the href).</li><li>You do not need to open the link — the preview lets you inspect it first.</li><li>Red flag: if the preview shows a suspicious or mismatched domain, don’t click.</li></ul></p><p></p><p>**Option 2: Use “Copy Link”**<ul><li>Long-press the link until the menu appears.</li><li>Select **Copy Link**.</li><li>Paste it into a plain text app (like Notes) to review the full URL without visiting it.</li></ul></p><p></p><p>**Option 3: Use “Share” → Notes**<ul><li>Instead of copying directly, you can tap **Share** → **Add to Notes** or **Message** (to yourself).</li><li>This logs the full URL safely without risking an accidental tap.</li></ul></p><p></p><p>**Option 4: Use Security Apps**<ul><li>Some iOS mail security apps (e.g., Outlook Mobile with Safe Links, or MDM security solutions) automatically rewrite and log the href so that analysts or IT staff can review it.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>What to Look For in the Mobile URL Preview</li></ol></p><p>------------------------------------------------------------<ul><li>**Check the registered domain** (the part immediately before `.com`, `.net`, etc.).</li></ul></p><p>  - Legitimate: `secure.wellsfargo.com`</p><p>  - Suspicious: `wellsfargo.secure-login.ru`<ul><li>**Look for encoding or odd characters**: `%2E`, `%20`, `-loginverify`.</li><li>**Beware of shortened links**: `bit.ly`, `tinyurl` → always suspect until expanded.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Advice for Mobile Users</li></ol></p><p>------------------------------------------------------------<ul><li>Always long-press before tapping any link in an email.</li><li>Train yourself to read the **domain from right to left** to find the real owner.</li><li>If the URL is too long or confusing, don’t risk it — access the service by manually typing the known good URL into Safari (e.g., `wellsfargo.com`).</li><li>Encourage non-technical users to forward suspicious emails to IT/security rather than inspecting on their own.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>On iPhones (and most mobile devices), the safest way to compare the **visible label vs. the href** is to:<ul><li>**Long-press to preview the link** without opening it, or</li><li>**Copy the link** into a safe app for inspection.  </li></ul></p><p></p><p>Never tap a link directly from an email if there’s any doubt.</p><p></p><p><img src="images/21-1.png" alt="images/21-1.png" /></p><p></p><p><img src="images/21-2.png" alt="images/21-2.png" /></p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links_22.html"></a><h1 class='title level-3'>Links</h1><br/><p>------------------------------------------------------------</p><p>Email/URL Analysis References – With Narrative Commentary</p><p>------------------------------------------------------------</p><p></p><p><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a> — CyberChef is a browser-based “Swiss Army knife” for analysts that lets you decode, encode, convert, and transform data without installing software. You can drag-and-drop operations (called “recipes”) like URL-decode, Base64-decode, XOR, regex extract, and HTML entity decode, then preview results live. It’s ideal for quickly unpacking obfuscated URLs, parameters, and tracking tokens directly in your browser.</p><p></p><p><a href="https://github.com/MalwareCube/Email-IOC-Extractor">https://github.com/MalwareCube/Email-IOC-Extractor</a> — An open-source tool that parses raw email content (headers and body) to extract Indicators of Compromise (IOCs) such as URLs, IPs, domains, hashes, and attachments. Useful for speeding up triage: feed it a suspicious message and quickly pull out artifacts for enrichment in other tools (e.g., VirusTotal, urlscan).</p><p></p><p><a href="https://phishtank.org/">https://phishtank.org/</a> — A community-driven clearinghouse of suspected phishing URLs. You can search to see if a link is already reported, review community verification status, and submit new phishing samples. It’s a good “first stop” reputation check when you suspect brand impersonation or credential harvesting pages.</p><p></p><p><a href="https://www.url2png.com/">https://www.url2png.com/</a> — A service that renders full-page screenshots of URLs. This is helpful when you need safe, passive capture of a page’s visual appearance for evidence or documentation—without fully interacting with the page in your own browser. Especially useful for before/after comparisons when kits change branding.</p><p></p><p><a href="https://urlscan.io/">https://urlscan.io/</a> — A web scanner and search engine for URLs that fetches pages, records requests, renders screenshots, and exposes network artifacts (domains, IPs, requests, technologies). You can submit a URL and then analyze the scan results (requests graph, HTML, JS, redirects) or pivot on related infrastructure to map a phishing campaign.</p><p></p><p><a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a> — VirusTotal aggregates AV engines, sandbox signals, and reputation sources to assess files, URLs, and domains. For URLs, you’ll see detections, community notes, historical submissions, and relationships. It’s a strong enrichment step after extraction—paste the URL or domain to get a multi-engine view.</p><p></p><p><a href="https://www.urlvoid.com/">https://www.urlvoid.com/</a> — A reputation checker that queries multiple blacklist and threat intelligence sources to score domains. It provides whois, DNS, host information, and historical data. It’s quick for an “at-a-glance” risk snapshot while you perform deeper analysis elsewhere.</p><p></p><p><a href="https://www.wannabrowser.net/">https://www.wannabrowser.net/</a> — A lightweight utility to fetch a URL with different user agents (desktop, mobile, bots) to see how the site behaves per client. Useful for detecting cloaking, device-specific lures, or conditional redirects often used in phishing kits to evade scanners while serving payloads to real users.</p><p></p><p><a href="https://unshorten.it/">https://unshorten.it/</a> — A link expander that reveals the final destination behind shortened links (bit.ly, tinyurl, custom shorteners) without you having to click them. Analysts use this to safely expose the true domain and parameters before submitting to heavier tools or sandboxes.</p><p></p><p><a href="https://urlhaus.abuse.ch/">https://urlhaus.abuse.ch/</a> — A community project focused on tracking and sharing URLs used for malware distribution. You can search by URL, domain, or payload signature and download IOCs in feeds for automation. Great for quickly checking if a link is associated with known campaigns or payloads.</p><p></p><p><a href="https://transparencyreport.google.com/safe-browsing/search">https://transparencyreport.google.com/safe-browsing/search</a> — Google’s Safe Browsing status portal lets you query site safety classifications. It reflects whether Google currently flags a site for phishing, malware, or unwanted software. Use it as a corroborating signal alongside other reputation services.</p><p></p><p><a href="https://www.joesandbox.com/">https://www.joesandbox.com/</a> — A dynamic analysis platform (cloud and on-prem) that detonates files and URLs in instrumented environments to observe behavior (network traffic, processes, dropped files). For suspicious URLs, it can capture redirects, scripts, and payload delivery chains, producing detailed, shareable reports for incident documentation.</p><p></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--Email_IOC_Extractor_23.html"></a><h1 class='title level-4'>Email IOC Extractor</h1><br/><p>------------------------------------------------------------</p><p>Email IOC Extractor – Basic Commands (Narrative Notes)</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>Introduction</li></ol></p><p>------------------------------------------------------------</p><p>The **Email IOC Extractor** is a Python-based tool designed to automate the process of extracting </p><p>Indicators of Compromise (IOCs) from email messages. IOCs can include URLs, domains, IP addresses, </p><p>hashes, or file references embedded in the message body or headers. Instead of manually combing </p><p>through raw email files, the extractor parses content for you, speeding up analysis and reducing </p><p>human error.</p><p></p><p>------------------------------------------------------------<ol><li>Downloading the Tool</li></ol></p><p>------------------------------------------------------------</p><p>The tool can be downloaded directly from GitHub using the `wget` command. This retrieves the Python </p><p>script (eioc.py) from its repository and saves it locally.</p><p></p><p>Example:</p><p>    wget <a href="https://raw.githubusercontent.com/MalwareCube/Email-IOC-Extractor/main/eioc.py">https://raw.githubusercontent.com/MalwareCube/Email-IOC-Extractor/main/eioc.py</a></p><p><ul><li>`wget` → A Linux command-line utility to download files from the web.</li><li>The URL points to the raw version of the Python script hosted on GitHub.</li><li>After execution, the script `eioc.py` will be saved in the current working directory.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Running the Script</li></ol></p><p>------------------------------------------------------------</p><p>The script is executed with Python (version 3 recommended). The general syntax is:</p><p></p><p>    python3 eioc.py &lt;file_path&gt;</p><p><ul><li>`python3` → Explicitly runs the script with Python 3 interpreter.</li><li>`eioc.py` → The script you downloaded.</li><li>`&lt;file_path&gt;` → Path to the email file you want to analyze. This is often a `.eml` or text-based </li></ul></p><p>  file containing raw email content.</p><p></p><p>If you run the script without arguments:</p><p>    python3 eioc.py</p><p></p><p>You’ll receive usage instructions, showing the correct format:  </p><p>    Usage: python eioc.py &lt;file_path&gt;</p><p></p><p>------------------------------------------------------------<ol><li>Practical Example</li></ol></p><p>------------------------------------------------------------</p><p>Suppose you have a suspicious email file stored at:</p><p>    ../03_URL_Analysis/sample1.eml</p><p></p><p>You would run:</p><p>    python3 eioc.py ../03_URL_Analysis/sample1.eml</p><p><ul><li>`../` → Moves one directory up from the current working folder.</li><li>`03_URL_Analysis/sample1.eml` → Points to the file containing the suspicious email.</li></ul></p><p></p><p>The script will then parse that file and attempt to extract:<ul><li>URLs (e.g., phishing links).</li><li>IP addresses referenced in the email.</li><li>Domains hidden inside anchor tags.</li><li>Any other text patterns matching known IOC formats.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Output and Usage</li></ol></p><p>------------------------------------------------------------</p><p>The output is typically printed directly in the terminal. Depending on the email file, you may see:<ul><li>A list of extracted URLs or domains.</li><li>IP addresses associated with email routing headers.</li><li>Indicators that can be copied and pasted into reputation services (VirusTotal, urlscan, PhishTank, etc.).</li></ul></p><p></p><p>This provides a **clean, analyst-ready set of artifacts** you can then pivot on to determine if the </p><p>email is part of a phishing campaign or if it connects to known malicious infrastructure.</p><p></p><p>------------------------------------------------------------<ol><li>Summary</li></ol></p><p>------------------------------------------------------------<ul><li>Use `wget` to download `eioc.py` from GitHub.  </li><li>Run with: `python3 eioc.py &lt;file_path&gt;`.  </li><li>The tool scans raw email content and extracts IOCs automatically.  </li><li>Results are displayed in terminal for quick enrichment in other tools.  </li></ul></p><p></p><p>This workflow turns manual IOC hunting into an efficient, repeatable process for phishing analysis.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--PhishTank_24.html"></a><h1 class='title level-4'>PhishTank</h1><br/><p>------------------------------------------------------------</p><p>PhishTank – Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is PhishTank?</li></ol></p><p>------------------------------------------------------------</p><p>PhishTank is a **community-driven clearinghouse** dedicated to tracking, reporting, and verifying </p><p>phishing websites. It provides a centralized database where security researchers, analysts, and </p><p>even ordinary users can submit suspected phishing URLs. The community then reviews and votes on </p><p>submissions to confirm whether a site is truly malicious. Once verified, the phishing URL is added </p><p>to the global PhishTank dataset, which is freely available for use by individuals and organizations.</p><p></p><p>------------------------------------------------------------<ol><li>Purpose and Value</li></ol></p><p>------------------------------------------------------------<ul><li>**Crowdsourced verification** → Multiple users can confirm whether a URL is phishing or not, </li></ul></p><p>  reducing false positives.<ul><li>**Open access** → Unlike some commercial feeds, PhishTank is free to access and use, making it a </li></ul></p><p>  go-to reputation check for security analysts, SOC teams, and hobbyists.<ul><li>**Trusted integrations** → Many security vendors and anti-phishing solutions integrate PhishTank </li></ul></p><p>  data into their detection systems, so looking up URLs here reflects what is often happening </p><p>  behind the scenes in security products.</p><p></p><p>------------------------------------------------------------<ol><li>How to Use PhishTank</li></ol></p><p>------------------------------------------------------------<ul><li>**Searching a URL** → Analysts can paste a suspicious link into the PhishTank search bar to see </li></ul></p><p>  if it has already been reported and verified as phishing.<ul><li>**Submitting a URL** → If the link is not found, you can submit it to the community. Once </li></ul></p><p>  submitted, other members vote and classify it.<ul><li>**APIs and Feeds** → For automation, PhishTank provides programmatic access (API and downloadable </li></ul></p><p>  data feeds), which allow security systems to automatically query and block known phishing URLs.</p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------<ol><li>Extract a suspicious link from a phishing email.</li><li>Visit <a href="https://phishtank.org">https://phishtank.org</a> and paste the link into the search field.</li><li>Review results:<ul><li>If already verified → treat as confirmed phishing, add to your report.</li><li>If not yet verified → consider submitting it for review.</li></ul></li><li>Use results alongside other enrichment services (e.g., VirusTotal, urlscan) to corroborate.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Limitations</li></ol></p><p>------------------------------------------------------------<ul><li>Because verification is community-driven, **new phishing URLs may not be listed immediately**.</li><li>Sophisticated phishing kits may change infrastructure quickly, so entries can become outdated.</li><li>Should always be used as **one of several reputation checks**, not the only source of truth.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>PhishTank is a free, community-verified repository of phishing URLs. It is widely used by analysts </p><p>as a first stop to check the reputation of suspicious links, and it plays an important role in </p><p>open-source threat intelligence. While not exhaustive, it is a valuable addition to any phishing </p><p>analysis workflow.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--URL2PNG_25.html"></a><h1 class='title level-4'>URL2PNG</h1><br/><p>------------------------------------------------------------</p><p>URL2PNG – Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is URL2PNG?</li></ol></p><p>------------------------------------------------------------</p><p>URL2PNG is an **online service that generates screenshots of web pages**. Instead of opening a </p><p>potentially dangerous URL in your own browser, you can safely submit it to URL2PNG and receive a </p><p>rendered image of what the page looks like. This provides a way to **document evidence** of a site’s </p><p>appearance without directly interacting with it, reducing the risk of infection or credential theft.</p><p></p><p>------------------------------------------------------------<ol><li>Purpose and Value</li></ol></p><p>------------------------------------------------------------<ul><li>**Safety** → Analysts don’t need to expose themselves or their systems to malicious content; the </li></ul></p><p>  screenshot is generated remotely.<ul><li>**Documentation** → Screenshots can be archived in case notes, incident reports, or legal records </li></ul></p><p>  to show what a phishing site looked like at the time of investigation.<ul><li>**Automation** → URL2PNG provides an API, meaning organizations can integrate screenshot capture </li></ul></p><p>  into automated analysis pipelines.</p><p></p><p>------------------------------------------------------------<ol><li>How to Use URL2PNG</li></ol></p><p>------------------------------------------------------------<ol><li>Go to <a href="https://www.url2png.com/">https://www.url2png.com/</a></li><li>Input the suspicious URL you want to visualize.</li><li>URL2PNG will render a screenshot of the site and return it to you as an image.</li><li>You can save or embed that image into your incident report for evidence.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------</p><p>Imagine you’ve extracted the following URL from a phishing email:</p><p>    <a href="http://secure-login-paypal.com/authenticate">http://secure-login-paypal.com/authenticate</a></p><p></p><p>Steps:<ol><li>Submit this URL to URL2PNG.</li><li>Retrieve the screenshot of the phishing page (often a fake PayPal login form).</li><li>Store the image with your analysis to show how the attack attempts to trick users.</li><li>Use this visual evidence when briefing stakeholders or educating end-users.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Limitations</li></ol></p><p>------------------------------------------------------------<ul><li>URL2PNG only gives you a **visual representation** — it does not analyze the site’s behavior, </li></ul></p><p>  code, or network traffic.<ul><li>If the phishing kit requires interaction (typing credentials, pressing a button), the static </li></ul></p><p>  screenshot may not capture the full attack chain.<ul><li>Some phishing sites may block screenshotting services, meaning the image might fail to render.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>URL2PNG is a safe and effective way to **capture what a suspicious website looks like** without </p><p>risking exposure to the content. It is best used as a **documentation and reporting tool**, </p><p>complementing dynamic analysis services like urlscan.io or Joe Sandbox.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--urlscan.io_26.html"></a><h1 class='title level-4'>urlscan.io</h1><br/><p>------------------------------------------------------------</p><p>urlscan.io – Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is urlscan.io?</li></ol></p><p>------------------------------------------------------------</p><p>urlscan.io is an **online sandbox and search engine for URLs**. When you submit a link, the service </p><p>fetches the page, executes it in a controlled environment, and records everything it sees. This </p><p>includes the final rendered webpage, all redirects, requests made to third-party domains, scripts </p><p>executed, and network indicators. It’s a widely used tool by security analysts to safely observe how </p><p>a URL behaves without exposing their own systems.</p><p></p><p>------------------------------------------------------------<ol><li>Purpose and Value</li></ol></p><p>------------------------------------------------------------<ul><li>**Safety** → The URL is detonated in urlscan.io’s environment, not on your machine.</li><li>**Visibility** → Captures full request chains, external domains, and resources the site tries to load.</li><li>**Screenshots** → Provides a rendered image of the page to show how it looks to victims.</li><li>**IOC Extraction** → Lists hostnames, IPs, file downloads, and JavaScript artifacts.</li><li>**Historical Search** → You can search for domains, IPs, or file hashes across previously scanned URLs.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>How to Use urlscan.io</li></ol></p><p>------------------------------------------------------------<ol><li>Go to <a href="https://urlscan.io/">https://urlscan.io/</a></li><li>Paste the suspicious URL into the submission box.</li><li>Choose scan type:<ul><li>**Public** → Results are shared with the community and indexed.</li><li>**Private** → Results are not publicly visible (requires an account).</li></ul></li><li>Submit and wait a few seconds for the scan to complete.</li><li>Review the results: screenshot, request map, domain/IP data, and verdicts from security feeds.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------</p><p>Suppose you extracted this URL from a phishing email:</p><p>    <a href="http://microsoft-login.secureverify.ru/auth">http://microsoft-login.secureverify.ru/auth</a></p><p></p><p>Steps:<ol><li>Submit the URL to urlscan.io.</li><li>Review the screenshot of the rendered phishing login page.</li><li>Inspect the request list — note if it calls out to multiple IPs, loads scripts from shady domains,  or attempts redirects.</li><li>Export the IOCs (domains, IPs, file names) for enrichment in VirusTotal, PhishTank, or block  lists.</li><li>Include the screenshot and artifact list in your phishing report.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Limitations</li></ol></p><p>------------------------------------------------------------<ul><li>Some phishing kits detect automated scanners and may serve **blank pages or decoy content**.</li><li>Heavily obfuscated scripts might not execute fully in the scanning environment.</li><li>urlscan.io shows what happens in one run; fast-moving phishing sites may already be offline or </li></ul></p><p>  changed by the time you analyze.</p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>urlscan.io is a powerful service that lets analysts **safely observe and document URL behavior**. </p><p>It combines visibility (network requests, redirects), evidence (screenshots), and community insight </p><p>(historical scans) in one platform. It should be part of every phishing analysis workflow to map out </p><p>infrastructure and collect IOCs for defense.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--VirusTotal_27.html"></a><h1 class='title level-4'>VirusTotal</h1><br/><p>------------------------------------------------------------</p><p>VirusTotal – Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is VirusTotal?</li></ol></p><p>------------------------------------------------------------</p><p>VirusTotal is a free (with paid tiers) **meta-scanning and reputation platform** owned by Google/Chronicle that aggregates results from dozens of antivirus engines, URL/domain reputation sources, sandboxes, and community submissions. Analysts use it to assess **files, URLs, IPs, and domains** quickly, pivot to related artifacts, and see historical detections.</p><p></p><p>------------------------------------------------------------<ol><li>Why It’s Valuable in Phishing &amp; Malware Analysis</li></ol></p><p>------------------------------------------------------------<ul><li>**Multi-engine verdicts**: One submission, many AV/reputation checks → faster triage.</li><li>**Rich context**: WHOIS, TLS certs, resolutions, OSINT links, and community comments.</li><li>**Relationships**: Graphs that connect a URL ↔ domain ↔ IP ↔ downloaded files ↔ contacted infrastructure.</li><li>**History**: See prior submissions, first/last seen times, trending samples.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>What You Can Submit</li></ol></p><p>------------------------------------------------------------<ul><li>**Files** (PE, PDF, Office, archives) → hashed, scanned, sometimes detonated by partner sandboxes.</li><li>**URLs** → scanned for phishing/malware; shows category detections, final redirect, and related indicators.</li><li>**IP addresses / Domains** → reputation overview, passive DNS, hosting breakdown, communicating files.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Basic Workflow for a Suspicious URL</li></ol></p><p>------------------------------------------------------------<ol><li>Extract the link from the email safely (don’t click).  </li><li>Go to <a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a> → choose **URL** tab.  </li><li>Paste the URL and submit.  </li><li>Review:<ul><li>**Security vendors’ verdicts** (e.g., Phishing/Malicious/Harmless).  </li><li>**Details**: redirects, final URL, HTTP response, embedded links.  </li><li>**Relationships**: domains and IPs contacted, files downloaded.  </li></ul></li><li>**Pivot**: click related domains/IPs/files to see their reputations and spread.  </li><li>**Document**: screenshot detections and list the key IOCs for your case notes.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Basic Workflow for a Suspicious File</li></ol></p><p>------------------------------------------------------------<ol><li>Upload the attachment (or its **hash** if policy forbids uploads).  </li><li>Check **Detection** tab for engine hits; note common names (e.g., Agent.Tesla).  </li><li>Inspect **Details** (file type, sections, macros), **Behavior** (network, registry, dropped files) if available, and **Relations** (URLs/IPs).  </li><li>Record the **SHA-256** and main indicators; pivot to any contacted infrastructure.</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Practical Tips</li></ol></p><p>------------------------------------------------------------<ul><li>**Use hashes first**: If you already computed SHA-256/SHA-1/MD5 locally, paste it to see if VT has seen the file—saves time and avoids re-uploading sensitive data.  </li><li>**Corroborate**: Treat VT as one signal; confirm with urlscan.io, PhishTank, URLhaus, Safe Browsing, etc.  </li><li>**Leverage Community**: Read comments, look at **Collections**, and check **Sigma/YARA** rules shared by others.  </li><li>**Automation**: Use the API to enrich IOCs at scale (rate limits vary by tier).  </li><li>**Graph view**: Quickly map a campaign by exploring the relationships graph and exporting nodes for block lists.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Caveats &amp; OPSEC</li></ol></p><p>------------------------------------------------------------<ul><li>**Privacy**: Submissions (especially URLs/files) may become **public** and visible to other users/vendors. Don’t upload proprietary or sensitive documents unless your policy allows it; prefer hash lookups.  </li><li>**False negatives/positives**: New threats may evade engines; some detections may be overly aggressive. Always corroborate.  </li><li>**Dynamic behavior limits**: VT aggregates partner sandboxes; not all behavior is captured or reproducible.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>VirusTotal is a cornerstone enrichment tool: fast, multi-source verdicts plus rich relationships that let you pivot from one artifact to an entire infrastructure picture. Use it early in triage for **signal and scoping**, then confirm with complementary tools and your internal telemetry.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--urlvoid.com_28.html"></a><h1 class='title level-4'>urlvoid.com</h1><br/><p>------------------------------------------------------------</p><p>URLVoid – Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is URLVoid?</li></ol></p><p>------------------------------------------------------------</p><p>URLVoid is a lightweight **domain/URL reputation checker** that aggregates results from multiple blacklist and threat-intel sources to give a quick risk snapshot. Instead of detonating a page or crawling it deeply, URLVoid focuses on whether a host or domain appears on known blocklists and provides useful context like WHOIS summaries, DNS/host details, IP/ASN, and historical data. Think of it as a fast “is this domain already known bad?” triage step.</p><p></p><p>------------------------------------------------------------<ol><li>Why It’s Useful in Email/Phishing Triage</li></ol></p><p>------------------------------------------------------------<ul><li>**Speed**: Paste a domain and immediately see whether any engines flag it.</li><li>**At-a-glance risk**: A simple hit count across blacklists helps you prioritize.</li><li>**Context**: WHOIS age, registrar, nameservers, IP/ASN, and geolocation can hint at throwaway infrastructure.</li><li>**Pivoting**: Host/IP/ASN and nameserver info can lead you to related malicious assets.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>How to Use URLVoid (Basic Flow)</li></ol></p><p>------------------------------------------------------------<ol><li>Extract the hostname from the suspicious email link (prefer the **registered domain**; e.g., from `<a href="https://sub.brand.example.co.uk/login">https://sub.brand.example.co.uk/login</a>`, analyze `example.co.uk`).</li><li>Go to urlvoid.com and paste the domain (you can paste a full URL; URLVoid evaluates the host).</li><li>Run the check and review:<ul><li>**Blacklist detections**: Which engines (if any) list the domain.</li><li>**Domain profile**: Creation/update dates (domain age), registrar, nameservers.</li><li>**Host/Network**: IP address, ASN (autonomous system number), hosting/provider, geolocation.</li><li>**Historical data**: Previously seen IPs or status changes, if available.</li></ul></li><li>Capture the findings in your case notes (e.g., “0/NN detections, domain registered yesterday, hosted on ASN X, nameservers Y → suspicious due to age”).</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------<ul><li>You extract `secure-login-paypa1[.]com` from an email anchor.</li><li>Submit to URLVoid:</li></ul></p><p>  - Blacklist hits show 3/NN detections.</p><p>  - WHOIS shows it was registered 2 days ago, privacy-protected registrar, generic nameservers.</p><p>  - Hosting is on an ASN commonly seen in throwaway campaigns.<ul><li>Verdict for triage: **High suspicion** → proceed with deeper tools (urlscan.io for behavior, VirusTotal for broader reputation, Safe Browsing check, and manual sandboxing if policy allows).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Reading the Results (What the Fields Mean)</li></ol></p><p>------------------------------------------------------------<ul><li>**Blacklist Detections**: Count of engines that currently flag the domain. A non-zero count is a red flag, but zero is not proof of safety (fresh phish often evade lists).</li><li>**Domain Age / WHOIS**: Very new registrations, frequent registrar changes, or privacy-masked details can correlate with phishing infrastructure (not conclusive on their own).</li><li>**Nameservers / Registrar**: Commodity DNS or rapidly changing NS can indicate disposable setups.</li><li>**IP / ASN / Geolocation**: Shared hosting and certain ASNs appear frequently in low-cost, short-lived campaigns; use as context, not a sole indicator.</li><li>**History**: Prior resolutions or status changes help you see churn (fast-flux, IP hopping).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Tips &amp; Good Practices</li></ol></p><p>------------------------------------------------------------<ul><li>**Normalize first**: Reduce to the registered domain for the primary check; also test suspicious subdomains separately if they look distinct.</li><li>**Corroborate**: Use URLVoid as an initial signal, then confirm with urlscan.io, VirusTotal, PhishTank, URLhaus, and Google Safe Browsing.</li><li>**Document clearly**: Record the date/time, detection count, domain age, and any notable pivots (IP/ASN/nameserver).</li><li>**Educate users**: Zero detections ≠ safe. New phishing domains often won’t appear on blocklists yet.</li><li>**Automate when possible**: If policy allows, tie URLVoid lookups into your enrichment pipeline alongside other sources.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Limitations &amp; Caveats</li></ol></p><p>------------------------------------------------------------<ul><li>**Not a sandbox**: URLVoid does not execute the page or show dynamic behavior, scripts, or redirects.</li><li>**Coverage lag**: Blocklists are reactive; a brand-new phishing host may show “clean” for hours or days.</li><li>**Shared infrastructure**: A compromised legitimate domain can be weaponized without immediately triggering broad blacklist consensus.</li><li>**Privacy/OPSEC**: External lookups may reveal your interest in a domain. For sensitive investigations, weigh policy and use API keys or internal resolvers/proxies as appropriate.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>URLVoid is a fast, low-overhead **reputation and context** check for domains seen in suspicious emails. Use it to prioritize and guide deeper analysis—never as a single source of truth. Pair its snapshot with behavioral tools (urlscan.io), multi-engine reputation (VirusTotal), and community intel (PhishTank/URLhaus) to reach a confident verdict.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--WannaBrowser_29.html"></a><h1 class='title level-4'>WannaBrowser</h1><br/><p>------------------------------------------------------------</p><p>wannabrowser.net — Narrative Notes for Email/URL Analysis</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is WannaBrowser?</li></ol></p><p>------------------------------------------------------------</p><p>WannaBrowser (<a href="https://www.wannabrowser.net/">https://www.wannabrowser.net/</a>) is a simple, browser-based utility that lets you request a URL while impersonating different **user agents** (UAs), such as iPhone Safari, Android Chrome, desktop Chrome/Edge/Firefox, or generic bots. Many phishing kits and shady sites use **cloaking**—they serve the real lure to certain devices (e.g., iPhones) but show benign content (e.g., a news page or 404) to scanners and desktops. WannaBrowser helps you see **how the same link behaves per device/UA** without needing to configure your own cURL scripts or VM profiles.</p><p></p><p>------------------------------------------------------------<ol><li>Why It’s Valuable in Phishing Triage</li></ol></p><p>------------------------------------------------------------<ul><li>Detects **device-targeted lures**: some campaigns only show the phishing page to mobile Safari.</li><li>Reveals **anti-scanner evasion**: kits may serve empty pages to default desktop UAs and sandboxes.</li><li>Aids **reproduction**: if a user reports, “I saw a login page on my iPhone,” you can emulate that UA to replicate exactly what they saw for evidence.</li><li>Supports **side-by-side comparison** with other tools (urlscan.io, VirusTotal) when those tools don’t trigger the same code path.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Basic Workflow (Step-by-Step)</li></ol></p><p>------------------------------------------------------------<ol><li>Extract the suspicious URL from the email safely (don’t click it directly in a live browser).</li><li>Open WannaBrowser.</li><li>Paste the URL into the test field.</li><li>Select a **User-Agent profile**:<ul><li>Mobile (iPhone Safari, Android Chrome)</li><li>Desktop (Windows Chrome/Edge, macOS Safari)</li><li>Optional bot or crawler personas (if available)</li></ul></li><li>Run the fetch. Observe:<ul><li>**HTTP status** (200/301/302/403/404)</li><li>**Redirects** (e.g., tracking hop → final destination)</li><li>**Rendered body** / final URL displayed by the service</li></ul></li><li>Repeat with another UA and compare differences.</li><li>Document your findings (timestamp, UA used, final URL, status codes, screenshots if you capture them separately).</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>What to Look For (Interpretation Guide)</li></ol></p><p>------------------------------------------------------------<ul><li>**Different content by UA**: desktop shows news; iPhone UA shows a fake “bank login” → strong cloaking indicator.</li><li>**Redirect chain changes**: mobile UA gets 302 → phishing kit; desktop UA gets 302 → legitimate homepage.</li><li>**Conditional blocks**: “Access Denied” or CAPTCHAs for certain UAs, but smooth login form for others.</li><li>**Language/locale shifts**: campaigns targeting a region may adapt content by `Accept-Language`.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Practical Example</li></ol></p><p>------------------------------------------------------------</p><p>Scenario: A user reports a “Wells Fargo security alert” email with a link. Your desktop scan looks harmless.<ul><li>Run with **Desktop Chrome UA** → 200 OK, generic blog page.</li><li>Run with **iPhone Safari UA** → 302 → `connect-secure-update[.]com/wf-login` with a pixel-perfect Wells Fargo login clone.</li></ul></p><p>Conclusion: The kit is **cloaking**. Capture evidence and proceed with takedown/reporting.</p><p></p><p>------------------------------------------------------------<ol><li>OPSEC, Privacy, and Safety Notes</li></ol></p><p>------------------------------------------------------------<ul><li>Avoid submitting **sensitive session tokens** or authenticated links to third-party tools.</li><li>Treat these checks as **recon**, not proof of safety; corroborate with urlscan.io, VirusTotal, URLhaus, and Google Safe Browsing.</li><li>Some infrastructure blocks known tester UAs; if so, try multiple UAs or switch to your own controlled cURL tests in a sandbox.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Useful Command-Line Equivalents (for deeper control)</li></ol></p><p>------------------------------------------------------------</p><p>cURL (override User-Agent, HEAD only):</p><p>    curl -I -A &quot;Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1&quot; <a href="https://suspicious.example/path">https://suspicious.example/path</a></p><p></p><p>HTTPie (show headers with custom UA):</p><p>    http --headers GET <a href="https://suspicious.example/path">https://suspicious.example/path</a> User-Agent:&#39;Mozilla/5.0 (Linux; Android 14; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Mobile Safari/537.36&#39;</p><p></p><p>PowerShell (Windows):</p><p>    Invoke-WebRequest -Uri &quot;<a href="https://suspicious.example/path">https://suspicious.example/path</a>&quot; -Method Head -Headers @{ &#39;User-Agent&#39; = &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126 Safari/537.36&#39; }</p><p></p><p>Tip: Start with `-I`/HEAD to avoid pulling full content; if behavior depends on GET, follow with a safe GET in a sandbox.</p><p></p><p>------------------------------------------------------------<ol><li>Limitations</li></ol></p><p>------------------------------------------------------------<ul><li>Some kits gate by **IP/ASN, geolocation, or time**—UA alone may not trigger the phish.</li><li>Complex pages requiring JS events, cookies, or POSTs may not fully render or behave in simple fetches.</li><li>Anti-automation logic can present decoys to non-human traffic even with realistic UAs.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Pairing with Other Tools</li></ol></p><p>------------------------------------------------------------<ul><li>**urlscan.io**: full request graph, screenshots, related infrastructure.</li><li>**VirusTotal**: multi-engine reputation for URL/domain/IP and pivoting.</li><li>**URL2PNG**: safe screenshots for incident documentation.</li><li>**PhishTank / URLhaus**: community intel and known bad feeds.</li><li>**URLVoid**: quick blacklist/WHOIS/age snapshot to gauge risk.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>WannaBrowser is a fast way to **test how a link behaves across different devices**—critical for uncovering **cloaking** in phishing campaigns. Use it to replicate user reports (especially mobile), capture differences, and guide deeper analysis. Always corroborate results and maintain OPSEC when handling potentially sensitive URLs.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--unshorten.it_30.html"></a><h1 class='title level-4'>unshorten.it</h1><br/><p>------------------------------------------------------------</p><p>unshorten.it — Narrative Notes for Email/URL Analysis</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is unshorten.it?</li></ol></p><p>------------------------------------------------------------</p><p>**unshorten.it** is a free web service that **expands shortened URLs** (e.g., links from bit.ly, t.co, tinyurl, or custom shorteners) to reveal the **final destination** before you visit it. Shortened links are common in phishing emails because they **hide the true domain** and redirect through one or more hops. By expanding the link *out of band* (not in your browser), you can examine the final URL, domain, and sometimes the redirect chain **without exposing your machine** to whatever is at the end.</p><p><ul><li>**URL shortener**: a service that takes a long link and produces a short alias that redirects (HTTP 301/302) to the original.</li><li>**Redirect**: an instruction from a server that tells the browser to automatically load a different URL (e.g., temporary `302 Found`, permanent `301 Moved Permanently`).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Why It’s Valuable in Phishing Triage</li></ol></p><p>------------------------------------------------------------<ul><li>**De-obfuscation**: Short URLs conceal the **registered domain**; expanding them reveals whether the endpoint is, for example, a brand look-alike (`secure-login-paypa1[.]com`) or a benign site.</li><li>**Safety**: You avoid directly visiting a suspicious destination in your own browser.</li><li>**Speed**: One paste, one click—get the final URL quickly for enrichment in other tools (urlscan.io, VirusTotal, PhishTank, URLVoid).</li><li>**Documentation**: Expansion results can be recorded in your case notes along with the redirect path and timestamps.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>How to Use unshorten.it (Step-by-Step)</li></ol></p><p>------------------------------------------------------------<ol><li>**Extract** the suspicious short link from the email (e.g., `<a href="https://bit.ly/3XYZabc">https://bit.ly/3XYZabc</a>`).</li><li>**Open** unshorten.it in a safe, non-authenticated browser window.</li><li>**Paste** the short link into the input box and submit.</li><li>**Review** the result:<ul><li>**Final URL** (the expanded destination).</li><li>Sometimes an **intermediate redirect** or meta refresh will be listed.</li><li>If available, a brief **safety hint** or preview.</li></ul></li><li>**Record** the expanded destination in your notes, then continue analysis with your standard workflow (e.g., submit the expanded URL to urlscan.io for behavior and to VirusTotal for reputation).</li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------</p><p>Scenario: A user reports an email urging “password reset” with a short link `<a href="https://t.co/abc123">https://t.co/abc123</a>`.<ul><li>Expand with unshorten.it → final URL shows `<a href="https://microsoft-login.verify-account[.]ru/auth">https://microsoft-login.verify-account[.]ru/auth</a>`.</li><li>Now you can:</li></ul></p><p>  - **Check reputation**: URLVoid / VirusTotal.</p><p>  - **Analyze behavior**: urlscan.io (screenshots, request graph).</p><p>  - **Community intel**: PhishTank / URLhaus.<ul><li>Verdict: The expanded endpoint reveals a **look-alike domain** on a risky TLD → suspicious to malicious; proceed with incident handling.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>OPSEC &amp; Safety Tips</li></ol></p><p>------------------------------------------------------------<ul><li>**Don’t sign in** anywhere while testing: never authenticate when using any external tool.</li><li>**Do not paste** links containing **personal tokens** (e.g., magic login links, password reset URLs) into third-party services—those may grant access to accounts.</li><li>**Prefer hashes** for files: if your email contains an attachment, compute a hash (SHA-256) locally and search it in VirusTotal instead of uploading sensitive content.</li><li>**Keep evidence**: record the original short URL, the expanded URL, the date/time, and any redirect steps for your report.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Limitations &amp; Caveats</li></ol></p><p>------------------------------------------------------------<ul><li>**Multi-step chains**: Some links redirect multiple times; unshorten.it may only show the final hop, not every intermediary. If you need the full path, use a controlled HEAD/GET in a sandbox or urlscan.io.</li><li>**Conditional redirects**: Behavior can differ by **User-Agent**, cookies, geolocation, or time. If expansion returns a benign site but users saw a phish, test with mobile UAs (e.g., using wannabrowser.net) or detonate in urlscan.io.</li><li>**Custom shorteners**: Attackers often host their own shorteners; they may block automated requests or return decoys to scanners.</li><li>**Availability**: If the service is down or rate-limited, use alternatives (e.g., CheckShortURL) or manual command-line expansion.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Command-Line Alternatives (For Full Control)</li></ol></p><p>------------------------------------------------------------</p><p>(Indented to avoid breaking the editor; these are examples you can run in a sandbox.)</p><p></p><p>    # cURL: follow redirects (-L), show only final URL (-w), suppress body (-s), discard output (-o /dev/null)</p><p>    curl -s -o /dev/null -w &quot;%{url_effective}\n&quot; -L &quot;<a href="https://bit.ly/3XYZabc">https://bit.ly/3XYZabc</a>&quot;</p><p></p><p>    # HEAD-only first (less invasive), then GET if needed:</p><p>    curl -I &quot;<a href="https://bit.ly/3XYZabc">https://bit.ly/3XYZabc</a>&quot;         # HEAD request: check Location headers</p><p>    curl -L -I &quot;<a href="https://bit.ly/3XYZabc">https://bit.ly/3XYZabc</a>&quot;      # Follow redirects but only HEAD</p><p></p><p>    # HTTPie example:</p><p>    http --follow --headers GET &quot;<a href="https://bit.ly/3XYZabc">https://bit.ly/3XYZabc</a>&quot;</p><p></p><p>Tip: Start with `-I` (HEAD) to reduce content retrieval; if the chain is conditional on GET, proceed carefully in an isolated environment.</p><p></p><p>------------------------------------------------------------<ol><li>Pairing with Other Tools</li></ol></p><p>------------------------------------------------------------<ul><li>**urlscan.io** → Observe dynamic behavior, redirects, screenshots, third-party requests.</li><li>**VirusTotal** → Multi-engine verdicts and relationship graph for URLs/domains/IPs/files.</li><li>**PhishTank / URLhaus** → Community-confirmed phishing/malware URL intelligence.</li><li>**URLVoid** → Quick reputation snapshot, WHOIS/domain age, blacklist hits.</li><li>**wannabrowser.net** → Detect cloaking by testing different device **User-Agents** (mobile vs desktop).</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>unshorten.it is a fast, low-friction way to **reveal the true destination** behind a shortened link without visiting it. Use it early in email triage to unmask the **registered domain**, then corroborate with behavioral and reputation tools. Treat the expanded URL as the **primary artifact** for your subsequent analysis and reporting.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--urlhaus_31.html"></a><h1 class='title level-4'>urlhaus</h1><br/><p>------------------------------------------------------------</p><p>URLhaus — Narrative Notes for Email/URL Analysis</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is URLhaus?</li></ol></p><p>------------------------------------------------------------</p><p>URLhaus (hosted by abuse.ch) is a community-driven project focused on **collecting, tracking, and sharing URLs used to distribute malware**. Researchers and volunteers submit suspicious/malicious URLs; the service validates and publishes them so defenders can **block, detect, and investigate** active threats. Unlike general “phishing” lists, URLhaus emphasizes **malware delivery** (e.g., loaders, droppers, ransomware installers), though many entries are also phishing-adjacent.</p><p></p><p>Key idea: if a link in an email ultimately **delivers a payload** (EXE, JS, HTA, ZIP, ISO, LNK, etc.), there’s a good chance URLhaus has seen it or related infrastructure.</p><p></p><p>------------------------------------------------------------<ol><li>Why It’s Valuable in Email/Phishing Triage</li></ol></p><p>------------------------------------------------------------<ul><li>**Fast reputation check**: Paste the suspicious URL/domain and see if it’s in a known-malware dataset.</li><li>**IOC enrichment**: Entries often include **URL status** (online/offline), **first/last seen**, **associated payload hashes**, and **tags** (e.g., family names).</li><li>**Infrastructure pivoting**: From one URL you can pivot to related **hostnames, IPs, and file hashes** to expand your block lists.</li><li>**Feeds for automation**: Daily/near-real-time CSV/JSON feeds to plug into SIEM/SOAR, mail gateways, firewalls, or endpoint controls.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Basic How-To (Manual Lookups)</li></ol></p><p>------------------------------------------------------------<ol><li>Extract the suspicious URL from the email (preferably the **href** value, not just the visible label).</li><li>Open URLhaus in a safe browser session.</li><li>Search by:<ul><li>**Full URL** (best when you have the exact link)</li><li>**Domain** or **hostname**</li><li>**IP address**</li><li>**File hash** (SHA-256/MD5) if you’ve captured a payload</li></ul></li><li>Review the result page:<ul><li>**URL status**: online, offline, unknown (online = currently serving content)</li><li>**First/last seen** timestamps (campaign freshness)</li><li>**Malware family / tags** (if identified)</li><li>**Related entries** (other URLs on same host/IP, associated hashes)</li></ul></li></ol></p><p></p><p>Interpretation tip: “Offline” doesn’t mean “safe forever.” Kits cycle infra. Treat as **historical evidence** that the host has been weaponized.</p><p></p><p>------------------------------------------------------------<ol><li>Feeds &amp; Automation (SOC Integrations)</li></ol></p><p>------------------------------------------------------------</p><p>URLhaus offers machine-consumable feeds for bulk use:<ul><li>**CSV/Plaintext/JSON feeds** of recent or active malware URLs</li><li>**Payload feeds** (hashes, sometimes links to samples on reputable repositories)</li><li>**RPZ/DNS blocklist** style outputs (where applicable)</li></ul></p><p>These are designed to integrate with **SIEM** (Security Information and Event Management), **SOAR** (Security Orchestration, Automation, and Response), **mail filters**, **proxy**/**firewall** block rules, and **EDR** enrichment pipelines.</p><p></p><p>Memory aid:<ul><li>CSV → easy for spreadsheets/SIEM.</li><li>JSON → easy for scripts/APIs.</li><li>RPZ → easy for DNS-based blocking.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Example</li></ol></p><p>------------------------------------------------------------</p><p>Scenario: A user receives an email with an attachment lure and a link:</p><p>    hxxp://files-secure-billing[.]com/update/Invoice_2025.zip</p><p></p><p>Steps:<ol><li>Normalize and safely record the **registered domain** (files-secure-billing.com) and the **full URL**.</li><li>Query **URLhaus** with the domain and full URL.</li><li>If present:<ul><li>Note **status** (online/offline) and **last seen**.</li><li>Copy **associated hashes** and **related URLs**.</li></ul></li><li>Enrich with:<ul><li>**VirusTotal** (URL/domain/hash reputation + relations)</li><li>**urlscan.io** (redirect chain, third-party requests, screenshot)</li><li>**URLVoid** (blacklist count, WHOIS/domain age)</li><li>**PhishTank** (if credential phishing is also suspected)</li></ul></li><li>Verdict &amp; action:<ul><li>Block **domain/URL/IP** internally (mail, proxy, DNS).</li><li>Add **hashes** to EDR block lists.</li><li>Document evidence &amp; notify stakeholders.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Reading Common Fields (What They Mean)</li></ol></p><p>------------------------------------------------------------<ul><li>**URL**: The full link observed distributing malware.</li><li>**Status (online/offline/unknown)**: Whether it served content at last verification.</li><li>**First seen / Last seen**: Campaign timeline; helps prioritize fresh threats.</li><li>**Host/IP**: Infrastructure you can block or monitor.</li><li>**Tags / Family**: Malware categorization (e.g., AgentTesla, QakBot); useful for detection tuning.</li><li>**Payload hash**: The file fingerprint (SHA-256/MD5) to hunt across endpoints.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Safe Usage, OPSEC, and Privacy</li></ol></p><p>------------------------------------------------------------<ul><li>**Don’t submit sensitive tokens** (password-reset links or single-use magic links). Treat all submissions as potentially **public intelligence**.</li><li>**Don’t detonate** samples on your workstation; use sandboxes if policy allows.</li><li>**Corroborate** across multiple sources. False negatives occur, especially with **fresh** infrastructure.</li><li>**Record evidence** (timestamp, indicator, tool, result) for reproducibility and incident reports.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Limitations &amp; Caveats</li></ol></p><p>------------------------------------------------------------<ul><li>**Focus is malware delivery**: Not every pure credential phish (no payload) will appear.</li><li>**Coverage isn’t total**: New kits move fast; there’s lag between emergence and listing.</li><li>**“Offline” ≠ harmless**: Operators can re-enable hosting or shift the path/subdomain quickly.</li><li>**Shared/compromised hosts**: A benign domain may be temporarily abused; investigate scope before taking extreme actions.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Handy Command-Line Patterns (in a Sandbox)</li></ol></p><p>------------------------------------------------------------</p><p>(Indented examples; adapt to your environment and the specific feed endpoints exposed by URLhaus.)</p><p></p><p>    # Fetch a recent-URLs CSV/JSON feed (example pattern)</p><p>    curl -s &quot;<a href="https://urlhaus.abuse.ch/downloads/csv_recent/">https://urlhaus.abuse.ch/downloads/csv_recent/</a>&quot; -o urlhaus_recent.csv</p><p>    curl -s &quot;<a href="https://urlhaus.abuse.ch/downloads/json_recent/">https://urlhaus.abuse.ch/downloads/json_recent/</a>&quot; -o urlhaus_recent.json</p><p></p><p>    # Grep for a domain or path of interest in CSV</p><p>    grep -i &quot;files-secure-billing.com&quot; urlhaus_recent.csv</p><p></p><p>    # Quick CSV to table (csvkit)</p><p>    csvlook urlhaus_recent.csv | less -S</p><p></p><p>    # jq to filter JSON entries that are currently online</p><p>    jq &#39;.urls[] | select(.url_status==&quot;online&quot;) | {url, date_added, threat, url_status}&#39; urlhaus_recent.json</p><p></p><p>Note: Endpoints/names can change; check URLhaus documentation for current feed URLs and rate limits.</p><p></p><p>------------------------------------------------------------<ol><li>Pairing with Other Tools (Best Practice)</li></ol></p><p>------------------------------------------------------------<ul><li>**VirusTotal** → relationship graph across URL/domain/IP/hash.</li><li>**urlscan.io** → dynamic behaviors, redirect chains, screenshots.</li><li>**URLVoid** → blacklist/WHOIS snapshot and domain age.</li><li>**PhishTank** → community-confirmed phishing (credential lures).</li><li>**Google Safe Browsing** → browser safety classification.</li><li>**Joe Sandbox** → full dynamic detonation of URLs/files.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom Line</li></ol></p><p>------------------------------------------------------------</p><p>URLhaus is a reliable, community-powered **malware URL intelligence hub**. Use it to validate whether an email link is tied to **active payload delivery**, gather **IOC context** (status, hashes, related infra), and feed **automations** that protect users at mail gateways, proxies, DNS, and endpoints. Treat it as one strong signal among several—and always corroborate.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--Google_Safe_Browsing_32.html"></a><h1 class='title level-4'>Google Safe Browsing</h1><br/><p>------------------------------------------------------------</p><p>Google Safe Browsing – Site Status (Transparency Report) — Narrative Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What it is (and why analysts use it)</li></ol></p><p>------------------------------------------------------------</p><p>Google Safe Browsing is Google’s reputation service that continuously crawls the web and classifies sites that host **malware**, conduct **social engineering** (phishing), or serve **unwanted software** (PUPs/adware). The **Site Status** page in the Google Transparency Report lets you type a domain or full URL and see whether Google currently considers it unsafe. It’s a fast, low-effort **reputation check** you can run during email/phishing triage.</p><p></p><p>Key terms:<ul><li>**Malware**: Content that tries to infect a system (e.g., drive-by downloads).</li><li>**Social engineering**: Deceptive pages that trick users into revealing credentials/financial info (phishing).</li><li>**Unwanted software**: Programs that behave deceptively (bundlers, adware), not necessarily outright malware.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>How to use the Site Status page (step-by-step)</li></ol></p><p>------------------------------------------------------------<ol><li>Open the Transparency Report → Safe Browsing → **Site status** page.</li><li>In **Check site status**, paste the **registered domain** or a **full URL** from the email you’re investigating.</li><li>Press Enter to query Google’s current assessment.</li><li>Record the result (screenshot + timestamp) in your case notes, then continue enrichment with other tools.</li></ol></p><p></p><p>Analyst tip: If the email link points to a deep path (e.g., example.com/a/b/c), check both the **full path** and the **root domain**. Some flags are path-specific; others apply to the whole site.</p><p></p><p>------------------------------------------------------------<ol><li>How to interpret results</li></ol></p><p>------------------------------------------------------------</p><p>You’ll typically see one of the following outcomes:<ul><li>**No unsafe content found**: Google has no current evidence of malware/phishing on the URL/domain. This **does not guarantee safety**—fresh campaigns may not be classified yet, and cloaking can hide from crawlers.</li><li>**This site is dangerous** (or similar wording): The site/URL is currently flagged for malware or social engineering. Treat as **malicious** unless you have very strong contrary evidence.</li><li>**Site unavailable / unknown**: Could be a new or transient host; treat as **information-poor** and corroborate with other sources.</li></ul></p><p></p><p>What it does not tell you:<ul><li>Full redirect chains, third-party requests, or detailed behavior (use urlscan.io for that).</li><li>Precise confidence scores or timestamps for when the classification changed.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Strengths and limitations</li></ol></p><p>------------------------------------------------------------</p><p>Strengths<ul><li>**Scale**: Backed by Google’s global crawling—excellent coverage over time.</li><li>**Browser integration**: Many browsers consume Safe Browsing lists; a positive hit often aligns with end-user warnings.</li><li>**Speed**: Instant reputation signal during triage.</li></ul></p><p></p><p>Limitations<ul><li>**Lag on fresh threats**: New phishing/malware pages can appear **before** Safe Browsing flags them.</li><li>**Cloaking**: Some kits show benign content to scanners and the real lure to mobile users or certain regions.</li><li>**Granularity**: A domain might be clean while a specific path is malicious (or vice versa).</li><li>**Not a sandbox**: It’s a reputation check, not a behavior analysis.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Practical workflow (example)</li></ol></p><p>------------------------------------------------------------</p><p>Scenario: You extract links from a suspicious “account alert” email.<ol><li>Normalize to the **registered domain** and also note the **exact URL path** (both will be checked).</li><li>Query each in **Site status**; record “no unsafe” vs “unsafe” with time/date.</li><li>Regardless of the result, continue enrichment:<ul><li>**urlscan.io** for redirects, requests, and a screenshot of the page.</li><li>**VirusTotal** for multi-engine URL/domain reputation and relationships.</li><li>**PhishTank** to see if the community has confirmed a phishing report.</li><li>**URLVoid** for blacklist count, WHOIS/domain age (new domains = suspicion).</li><li>**URLhaus** if there’s any hint of payload delivery (malware URLs).</li></ul></li></ol></p><p></p><p>Decision rule of thumb:<ul><li>**Flagged as unsafe** → Treat as malicious, block, and proceed with incident actions.</li><li>**Not flagged but other signals are bad** (new domain, look-alike, cloaking indicators, suspicious redirects) → Treat as **suspicious**; escalate with sandboxing (joe sandbox) or controlled manual review.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>OPSEC &amp; documentation</li></ol></p><p>------------------------------------------------------------<ul><li>**Do not authenticate** to any site during checks; never submit tokens or reset links to third-party tools.</li><li>Keep a **forensic note**: indicator tested, exact string (domain/URL), result, date/time, and a screenshot of the Site Status page.</li><li>Educate users: “No unsafe content found” ≠ safe to click. Always validate the **domain ownership** and cross-check with multiple sources.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom line</li></ol></p><p>------------------------------------------------------------</p><p>Google’s Safe Browsing **Site Status** is a quick, high-coverage reputation signal that fits naturally into phishing triage. Use it as an early “green/red” indicator, then **corroborate** with behavioral (urlscan.io), multi-engine reputation (VirusTotal), community intel (PhishTank/URLhaus), and contextual signals (URLVoid, WHOIS age) before finalizing your verdict.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_URL_Analysis--Links--JoeSandboxCloud_33.html"></a><h1 class='title level-4'>JoeSandboxCloud</h1><br/><p>------------------------------------------------------------</p><p>Joe Sandbox Cloud — Narrative Notes for Email/URL Analysis</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>What is Joe Sandbox Cloud?</li></ol></p><p>------------------------------------------------------------</p><p>Joe Sandbox Cloud is an online **dynamic analysis** (sandbox) platform that detonates **URLs** and **files** in instrumented virtual machines to observe their behavior safely. It records network traffic, process activity, file/registry changes, persistence attempts, and produces a rich report with **IOCs (Indicators of Compromise)**, screenshots, and mappings to **MITRE ATT&amp;CK** techniques. Think of it as a “safe lab” on demand for suspicious email links and attachments.</p><p></p><p>------------------------------------------------------------<ol><li>Why analysts use it</li></ol></p><p>------------------------------------------------------------<ul><li>**Behavior over reputation**: Even if a URL/domain is new (no blacklist hits), Joe Sandbox shows what it *does* at run time.</li><li>**Visibility**: Captures redirects, scripts, payload drops, command-and-control beacons, and persistence tricks.</li><li>**Evidence**: Generates screenshots, timelines, and IOCs that you can paste into incident tickets, SIEM/EDR blocklists, or takedown requests.</li><li>**Multiple environments**: Analyze as Windows, macOS, Android, or Linux (availability depends on plan), revealing platform-specific behavior.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Typical use cases in email investigations</li></ol></p><p>------------------------------------------------------------<ul><li>**Detonate a suspicious URL** from a phishing email to see redirect chains, final content, and any payload delivery.</li><li>**Analyze attachments** (ZIP, Office docs, PDFs, ISO, HTA, JS, LNK, EXE) to observe macro execution, script behaviors, or droppers contacting the internet.</li><li>**Extract IOCs** (domains, IPs, file hashes, mutexes, registry keys) for containment and hunting.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Basic workflow (step-by-step)</li></ol></p><p>------------------------------------------------------------<ol><li>**Prepare safely**  <ul><li>Never run suspicious content on your workstation. Strip **personal tokens** from URLs (e.g., magic links).</li></ul></li><li>**Submit**  <ul><li>For a URL: paste the link into Joe Sandbox Cloud and select the desired analysis profile (e.g., Windows 11 / Chrome).  </li><li>For a file: upload it (or, if policy forbids uploads, consider only submitting the **hash** elsewhere and detonating internally).</li></ul></li><li>**Configure options** (if available)  <ul><li>Timeouts, internet on/off, user interaction simulation, document tricks (enable Office, click simulation), network capture.</li></ul></li><li>**Run analysis** and wait for completion.</li><li>**Review the report**  <ul><li>Screenshots, process tree, behavior summary, network activity, dropped files, signatures/att&amp;ck mapping, extracted IOCs.</li></ul></li><li>**Export &amp; act**  <ul><li>Download IOCs, PCAPs, or JSON; feed into SIEM/EDR, blocklists, and incident documentation.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Reading the report (what to focus on)</li></ol></p><p>------------------------------------------------------------<ul><li>**Behavior Summary / Signatures**: Human-readable detections (e.g., “Credential phishing form detected,” “Downloads executable,” “Persists via Run key”).</li><li>**Process Tree**: Parent/child processes, command lines, and script interpreters (wscript, powershell, cmd).</li><li>**Network**: DNS queries, HTTP(S) requests, TLS metadata, destinations (domains/IPs), and **PCAP** download.</li><li>**Dropped/Modified Files**: Names, locations, and cryptographic hashes to block or hunt.</li><li>**MITRE ATT&amp;CK Mapping**: Techniques observed (e.g., T1059 Command and Scripting, T1105 Exfiltration over Web).</li><li>**IOCs**: Consolidated list of URLs, domains, IPs, file hashes, mutexes, registry paths.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Practical example (URL detonation)</li></ol></p><p>------------------------------------------------------------</p><p>Scenario: A user reports an email with link “resolve billing issue.” Desktop checks look benign.<ul><li>Submit the **URL** to Joe Sandbox Cloud with a **mobile browser profile** (if available) to test for **cloaking**.</li><li>Report shows: redirect → fake login page → JavaScript POST to attacker domain, plus attempt to fetch a ZIP payload.  </li><li>Extracted IOCs: final phishing host, POST endpoint, payload URL, payload SHA-256, and destination IP/ASN.  </li><li>Actions: block IOCs, notify users, and attach the report to your incident ticket.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>OPSEC &amp; privacy considerations</li></ol></p><p>------------------------------------------------------------<ul><li>**Assume submissions may be visible** to vendor staff or other customers; avoid uploading confidential documents or URLs containing **single-use tokens** tied to real accounts.  </li><li>If you must analyze sensitive content, prefer an **on-prem**/private sandbox or strip tokens before submission.  </li><li>Mind the **source IP** of the sandbox; adversaries may gate content by geo/ASN, so results can differ from what your users saw.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Limitations &amp; pitfalls</li></ol></p><p>------------------------------------------------------------<ul><li>**Evasion**: Some malware and phishing kits detect sandboxes or automated analysis and serve decoys or stay dormant.</li><li>**Interactivity**: Certain behaviors require human actions (multi-step clicks, solving CAPTCHAs, logging in). Use click/key simulation when available; otherwise, you may miss behaviors.</li><li>**Time-boxed**: Short runs might not catch delayed payloads or cron-style tasks.</li><li>**Network dependencies**: If the sample relies on external infrastructure that’s offline, behavior may look clean.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Tips for better results</li></ol></p><p>------------------------------------------------------------<ul><li>**Choose the right profile** (OS/browser) to match the victim’s environment; phish often target **mobile**.  </li><li>**Enable user-interaction simulation** for Office/PDF lures and web flows that need clicks.  </li><li>**Run twice with different UAs** (desktop vs. mobile) when cloaking is suspected.  </li><li>**Corroborate**: Pair the sandbox report with urlscan.io (request map), VirusTotal (relationships), URLhaus (malware focus), PhishTank (phish confirmation), URLVoid (reputation/WHOIS), and Google Safe Browsing.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Bottom line</li></ol></p><p>------------------------------------------------------------</p><p>Joe Sandbox Cloud provides **ground-truth behavioral evidence** for suspicious email URLs and attachments. Use it to see what actually happens—processes, network calls, and payloads—then convert findings into **IOCs** and **defensive actions**. Treat it as a core step after quick reputation checks, and observe OPSEC when dealing with sensitive content.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Attachment_Analysis_34.html"></a><h1 class='title level-2'>Email Attachment Analysis</h1><br/><p>------------------------------------------------------------</p><p>Email Attachment Analysis – Notes</p><p>------------------------------------------------------------</p><p></p><p>When investigating phishing or malicious emails, analysts focus not only on the message body and URLs but also on attachments. Attachments are a common delivery method for malware and social engineering payloads. Because many organizations have link protections in place, attackers rely heavily on file attachments to bypass defenses.</p><p></p><p>------------------------------------------------------------</p><p>Why Attachments Matter</p><p>------------------------------------------------------------</p><p>Attachments can carry:<ul><li>Executable malware (.exe, .dll, .bat, .ps1)</li><li>Document-based payloads (malicious Word macros, weaponized PDFs, embedded Excel formulas)</li><li>Compressed archives (.zip, .rar, .7z) used to hide malware</li><li>Image/media files with hidden exploits (steganography, malformed headers)</li></ul></p><p></p><p>Attachments provide a direct delivery vector: one user click can compromise a system.</p><p></p><p>------------------------------------------------------------</p><p>Analyst’s First Step – Triage</p><p>------------------------------------------------------------<ol><li>Preserve the original sample – always work in a sandbox or isolated VM.</li><li>Gather metadata – file name, extension, size (watch for double extensions like “invoice.pdf.exe”).</li><li>Generate hashes – MD5, SHA-1, SHA-256 for reference and threat intel checks.</li><li>Submit hashes to platforms like VirusTotal to see if file is already known.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Static Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>File headers/magic numbers: confirm type matches extension (e.g., .pdf starts with %PDF).</li><li>Strings analysis: extract readable text for URLs, C2 servers, or suspicious calls.</li><li>Macro inspection: review VBA code with tools like “oletools.”</li><li>Embedded objects: detect executables or scripts hidden inside documents.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Dynamic Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>Sandbox execution: observe behavior such as file creation, registry edits, process spawning.</li><li>Network monitoring: check for suspicious outbound connections.</li><li>Persistence checks: look for scheduled tasks, registry keys, or dropped payloads.</li></ul></p><p></p><p>Dynamic analysis reveals what the file actually does, not just what it might do.</p><p></p><p>------------------------------------------------------------</p><p>Common Malicious Attachment Types</p><p>------------------------------------------------------------<ul><li>Malicious Office Documents – VBA macros, DDE (Dynamic Data Exchange).</li><li>PDFs – with embedded JavaScript or malicious auto-actions.</li><li>Archives – password-protected .zip/.rar to bypass filters.</li><li>Scripts – .vbs, .js, or .ps1 designed to download/install malware.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Indicators of Compromise (IoCs)</p><p>------------------------------------------------------------</p><p>Extracted from attachments for defense:<ul><li>File hashes</li><li>Embedded URLs/domains</li><li>IP addresses</li><li>Registry keys / scheduled tasks</li><li>Dropped file names and locations</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Defensive Measures</p><p>------------------------------------------------------------<ul><li>Attachment filtering – block risky file types.</li><li>Sandboxing – detonate unknown files before delivery.</li><li>User awareness – train users not to enable macros or open unexpected files.</li><li>Advanced email security – combine static/dynamic analysis with threat intel feeds.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Example Case Narrative</p><p>------------------------------------------------------------</p><p>A reported email titled “Urgent Invoice” contains `invoice.pdf.exe`.  <ul><li>Hash check matches known malware on VirusTotal.  </li><li>Strings show suspicious commands (`powershell -enc ...`).  </li><li>Sandbox run reveals network call to `hxxp://malicious-domain[.]com` and second-stage payload.  </li></ul></p><p></p><p>Analyst provides IoCs to SOC team for blocking, endpoint updates, and user warnings.</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Attachment_Analysis--Windows_Commands_36.html"></a><h1 class='title level-3'>Windows Commands</h1><br/><p>------------------------------------------------------------</p><p>Windows Commands for Email Attachment Analysis</p><p>------------------------------------------------------------</p><p>Goal: Quickly triage suspicious attachments on a Windows analysis VM using **built-in** tools (PowerShell + a few classic Windows utilities). Each section explains: purpose → key commands → syntax → sample outputs.</p><p></p><p>Tip: Open **PowerShell** as a non-admin first; elevate only when needed. Keep originals read-only and work on copies.</p><p></p><p>------------------------------------------------------------<ol><li>Compute &amp; Export Hashes (MD5/SHA1/SHA256)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Hashes let you pivot in VirusTotal/Talos and deduplicate samples.</p><p><ul><li>Single file (SHA-256 default in PS 5+)</li></ul></p><p>  - Command:</p><p>    Get-FileHash -Path .\invoice.pdf -Algorithm SHA256</p><p>  - Parts:</p><p>    - `Get-FileHash` = computes cryptographic hash</p><p>    - `-Algorithm` = SHA256 | SHA1 | MD5</p><p>  - Sample output:</p><p>    Algorithm : SHA256</p><p>    Hash      : 6F0E7A8B...B1C7</p><p>    Path      : C:\Analysis\invoice.pdf</p><p><ul><li>Many files → CSV</li></ul></p><p>  - Command:</p><p>    Get-ChildItem -File -Recurse | Get-FileHash -Algorithm SHA256 |</p><p>      Select-Object Algorithm,Hash,Path | Export-Csv hashes.csv -NoTypeInformation</p><p><ul><li>Classic certutil (useful on older hosts)</li></ul></p><p>  - Command:</p><p>    certutil -hashfile invoice.pdf SHA256</p><p>  - Sample tail:</p><p>    SHA256 hash of invoice.pdf:</p><p>    6f 0e 7a 8b ... b1 c7</p><p>    CertUtil: -hashfile command completed successfully.</p><p></p><p>------------------------------------------------------------<ol><li>Check File Type by Magic Bytes (vs. Extension)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Attackers often disguise `.exe` as `.pdf` (e.g., `report.pdf.exe`).</p><p><ul><li>Quick hex header</li></ul></p><p>  - Command:</p><p>    Format-Hex -Path .\suspicious.bin -Count 64</p><p>  - Look for:</p><p>    - PDF: bytes start `%PDF`</p><p>    - ZIP/OOXML (docx/xlsx/pptx/jar): `50 4B 03 04` (PK..)</p><p>    - PE (Windows EXE/DLL): `4D 5A` (MZ)</p><p><ul><li>Minimal peek without full hex</li></ul></p><p>  - Command:</p><p>    Get-Content -Path .\file -Encoding Byte -TotalCount 8</p><p></p><p>------------------------------------------------------------<ol><li>Mark-of-the-Web (MOTW) / Zone.Identifier Stream</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Files downloaded from the internet carry MOTW; useful provenance clue. Also gates macro behavior.</p><p><ul><li>List alternate data streams (ADS)</li></ul></p><p>  - Command:</p><p>    Get-Item -Path .\invoice.docm -Stream *</p><p>  - Sample output:</p><p>    Stream         Length</p><p>    ------         ------</p><p>    :$DATA         98304</p><p>    Zone.Identifier   160</p><p><ul><li>Read MOTW details (URL &amp; Referrer)</li></ul></p><p>  - Command:</p><p>    Get-Content -Path .\invoice.docm -Stream Zone.Identifier</p><p>  - Sample output:</p><p>    [ZoneTransfer]</p><p>    ZoneId=3</p><p>    ReferrerUrl=<a href="https://example.com">https://example.com</a></p><p>    HostUrl=<a href="https://cdn.example.com/invoice.docm">https://cdn.example.com/invoice.docm</a></p><p><ul><li>(If policy requires testing without MOTW) — don’t do on originals</li></ul></p><p>  - Command:</p><p>    Unblock-File .\invoice.docm</p><p></p><p>------------------------------------------------------------<ol><li>Inspect Office Documents (OOXML) &amp; Look for Macros</li></ol></p><p>------------------------------------------------------------</p><p>WHY: “MalDocs” often use VBA macros (`.docm`, `.xlsm`) or embed objects.</p><p><ul><li>Quick tell: “M” extension implies macros</li></ul></p><p>  - `.docm`, `.xlsm`, `.pptm` likely contain `vbaProject.bin`</p><p><ul><li>List inside Office zip containers (no 3rd-party tools)</li></ul></p><p>  - Command:</p><p>    tar -tf .\invoice.docx</p><p>  - Look for paths like:</p><p>    word/vbaProject.bin            ← Macro storage (if present)</p><p>    word/_rels/document.xml.rels   ← Embedded/external links</p><p>    word/embeddings/               ← Embedded OLE objects</p><p><ul><li>Fully extract for inspection (to a temp dir)</li></ul></p><p>  - Command:</p><p>    Expand-Archive .\invoice.docx -DestinationPath .\docx_unpacked -Force</p><p><ul><li>Hunt for URLs inside extracted XML</li></ul></p><p>  - Command (PowerShell regex):</p><p>    Select-String -Path .\docx_unpacked\**\*.xml -Pattern &#39;(?i)\bhttps?://[^\s&quot;&lt;]+&#39; -AllMatches</p><p><ul><li>Basic macro presence indicator (without parsing VBA):</li></ul></p><p>  - If `vbaProject.bin` exists → likely macros; escalate to dedicated macro tooling in your lab.</p><p></p><p>------------------------------------------------------------<ol><li>Quick PDF Triage</li></ol></p><p>------------------------------------------------------------</p><p>WHY: PDFs may carry JavaScript, launch actions, or external links.</p><p><ul><li>Confirm it’s a PDF by header</li></ul></p><p>  - Command:</p><p>    Get-Content .\invoice.pdf -TotalCount 1</p><p>  - Expect `%PDF-1.x`</p><p><ul><li>Grep for suspicious PDF markers (very rough but quick):</li></ul></p><p>  - Commands:</p><p>    Select-String .\invoice.pdf -Pattern &#39;/JS&#39;,&#39;/JavaScript&#39;,&#39;/AA&#39;,&#39;/OpenAction&#39;,&#39;/Launch&#39;</p><p>    Select-String .\invoice.pdf -Pattern &#39;(?i)\bhttps?://[^\s&lt;)&quot;]+&#39; </p><p><ul><li>Hex view for deeper spot checks</li></ul></p><p>  - Command:</p><p>    Format-Hex .\invoice.pdf -Count 256</p><p></p><p>------------------------------------------------------------<ol><li>Strings &amp; IOC Mining (Built-In Approaches)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Extract quick IOCs (URLs, emails, IPs) without third-party tools.</p><p><ul><li>URLs (HTTP/HTTPS)</li></ul></p><p>  - Command:</p><p>    Select-String -Path .\sample.bin -Pattern &#39;(?i)\bhttps?://[^\s&quot;&lt;&gt;]+&#39; -AllMatches |</p><p>      ForEach-Object { $_.Matches.Value } | Sort-Object -Unique</p><p><ul><li>Domains (basic)</li></ul></p><p>  - Command:</p><p>    Select-String .\sample.bin -Pattern &#39;(?i)\b[a-z0-9.-]+\.(com|net|org|io|co|gov|edu)\b&#39; -AllMatches |</p><p>      % { $_.Matches.Value } | Sort -Unique</p><p><ul><li>IPv4s (simple regex)</li></ul></p><p>  - Command:</p><p>    Select-String .\sample.bin -Pattern &#39;\b(?:\d{1,3}\.){3}\d{1,3}\b&#39; -AllMatches |</p><p>      % { $_.Matches.Value } | Sort -Unique</p><p><ul><li>Emails</li></ul></p><p>  - Command:</p><p>    Select-String .\sample.bin -Pattern &#39;(?i)\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b&#39; -AllMatches |</p><p>      % { $_.Matches.Value } | Sort -Unique</p><p><ul><li>Save to CSV for ticketing/SIEM</li></ul></p><p>  - Example (URLs):</p><p>    $urls = Select-String -Path .\sample.bin -Pattern &#39;(?i)\bhttps?://[^\s&quot;&lt;&gt;]+&#39; -AllMatches |</p><p>      % { $_.Matches.Value } | Sort -Unique</p><p>    $urls | ForEach-Object { [pscustomobject]@{Type=&#39;URL&#39;; Value=$_} } |</p><p>      Export-Csv .\IOCs.csv -NoTypeInformation -Append</p><p></p><p>------------------------------------------------------------<ol><li>Authenticode Signature (Executables &amp; Scripts)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Signed files aren’t always safe, but signature info helps context/attribution.</p><p><ul><li>Check signature &amp; signer</li></ul></p><p>  - Command:</p><p>    Get-AuthenticodeSignature .\setup.exe | Format-List *</p><p><ul><li>Filter for Unsigned or Unknown</li></ul></p><p>  - Command:</p><p>    Get-ChildItem -Recurse -Include *.exe,*.dll |</p><p>      Where-Object { (Get-AuthenticodeSignature $_).Status -ne &#39;Valid&#39; } |</p><p>      Select FullName, @{n=&#39;SigStatus&#39;;e={(Get-AuthenticodeSignature $_).Status}}</p><p></p><p>------------------------------------------------------------<ol><li>Base64 / Hex Decode Bits (Common in Scripted Droppers)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Malicious scripts often hide payloads/URLs in Base64.</p><p><ul><li>Base64 → file</li></ul></p><p>  - Command:</p><p>    certutil -decode payload.b64 payload.bin</p><p>  - Note: `certutil` echoes lines; verify size/hash after decode.</p><p><ul><li>Quick Base64 to string (PowerShell)</li></ul></p><p>  - Command:</p><p>    [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String((Get-Content .\blob.b64 -Raw)))</p><p></p><p>------------------------------------------------------------<ol><li>Safe Preview of File Metadata (No Execution)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Learn about a file without running it.</p><p><ul><li>Basic metadata (date/size) for timeline</li></ul></p><p>  - Command:</p><p>    Get-Item .\sample | Select-Object Name,Length,LastWriteTime,CreationTime</p><p><ul><li>PE “MZ” quick check (EXE/DLL)</li></ul></p><p>  - Command:</p><p>    (Get-Content .\sample.exe -Encoding Byte -TotalCount 2) -eq 0x4D,0x5A</p><p></p><p>------------------------------------------------------------<ol><li>Archive Handling (ZIP/RAR/7z) with Built-Ins</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Many malicious attachments arrive as archives.</p><p><ul><li>List ZIP contents</li></ul></p><p>  - Command:</p><p>    tar -tf .\pack.zip</p><p><ul><li>Extract ZIP safely (to a quarantined working folder)</li></ul></p><p>  - Command:</p><p>    Expand-Archive .\pack.zip -DestinationPath .\unz -Force</p><p></p><p>(For RAR/7z you’ll need external tools; document usage separately if approved.)</p><p></p><p>------------------------------------------------------------<ol><li>Quick YARA-Like Grep (Rapid Keyword Hunt)</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Fast rough scan for suspicious strings before full tooling.</p><p><ul><li>Example: hunt for PowerShell download cradles</li></ul></p><p>  - Command:</p><p>    Select-String -Path .\*.ps1 -Pattern &#39;Invoke-WebRequest|IEX|FromBase64String|DownloadString&#39; -SimpleMatch</p><p><ul><li>Example: hunt for LOLBins in any text/binary (rough)</li></ul></p><p>  - Command:</p><p>    Select-String -Path .\* -Pattern &#39;rundll32|mshta|regsvr32|wscript|cscript|bitsadmin&#39; -Encoding Byte</p><p></p><p>------------------------------------------------------------<ol><li>Build a One-Shot Triage Script</li></ol></p><p>------------------------------------------------------------</p><p>WHY: Repeatable, defensible process.</p><p><ul><li>Example (save as `Triagedir.ps1`):</li></ul></p><p>  $out = @()</p><p>  Get-ChildItem -File | ForEach-Object {</p><p>    $h = Get-FileHash $_ -Algorithm SHA256</p><p>    $motw = (Get-Item $_ -Stream Zone.Identifier -ErrorAction SilentlyContinue)</p><p>    $sig = $null</p><p>    if ($_.Extension -match &#39;\.exe|\.dll&#39;) { $sig = (Get-AuthenticodeSignature $_).Status }</p><p>    $out += [pscustomobject]@{</p><p>      Name=$_.Name; Path=$_.FullName; Size=$_.Length</p><p>      SHA256=$h.Hash</p><p>      MOTW = [bool]$motw</p><p>      SigStatus = $sig</p><p>      IsPE = ((Get-Content $_ -Encoding Byte -TotalCount 2 -ErrorAction SilentlyContinue) -eq 0x4D,0x5A)</p><p>    }</p><p>  }</p><p>  $out | Export-Csv triage.csv -NoTypeInformation</p><p>  Write-Host &quot;Wrote triage.csv&quot;</p><p></p><p>Result: a CSV you can attach to the incident ticket and use to pivot (hashes to VT/Talos).</p><p></p><p>------------------------------------------------------------<ol><li>Safety Routines</li></ol></p><p>------------------------------------------------------------<ul><li>Work in a **non-indexed**, **non-synced** folder (not Desktop/OneDrive).  </li><li>Disable previews in Explorer; don’t double-click samples.  </li><li>Keep network **egress blocked** in your lab unless detonating intentionally.  </li><li>Preserve originals; only modify copies.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Memory Aid</p><p>------------------------------------------------------------</p><p>**“Hash → Header → MOTW → Unpack → Grep → Export.”**  <ul><li>Hash (Get-FileHash / certutil)  </li><li>Header (Format-Hex / magic bytes)  </li><li>MOTW (Get-Item -Stream / Get-Content -Stream)  </li><li>Unpack (Expand-Archive / tar -tf)  </li><li>Grep (Select-String regex for URLs/IPs/emails)  </li><li>Export (CSV for SIEM/ticket)</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Email_Attachment_Analysis--Links_35.html"></a><h1 class='title level-3'>Links</h1><br/><p>------------------------------------------------------------</p><p>Email Attachment &amp; IOC Tools — Narrative Notes on the References</p><p>------------------------------------------------------------</p><p></p><p>Below are plain-language notes you can paste into CherryTree. Each header explains what the tool/site is, what it’s good for in a SOC workflow, and how you might use it during email attachment analysis and IOC (Indicator of Compromise) harvesting.</p><p></p><p>------------------------------------------------------------</p><p>Didier Stevens – emldump.py</p><p>(<a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/emldump.py">https://github.com/DidierStevens/DidierStevensSuite/blob/master/emldump.py</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>`emldump.py` is a command-line parser for raw email files (`.eml`).  </li><li>It reads the full RFC-822 email (headers + MIME parts) and prints a structured view so you can see exactly how the message is built: headers, boundaries, text parts, HTML parts, and attachments.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>To quickly validate **headers** (From/To, Return-Path, DKIM, SPF results if present in the chain).  </li><li>To enumerate **MIME parts** and **attachments** without opening them in a risky client (e.g., Outlook).  </li><li>To **extract attachments** safely for further static/dynamic analysis.  </li><li>To spot suspicious tricks (double extensions, mismatched content-type vs file magic, odd MIME boundaries).</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Save the suspicious message as a `.eml`.  </li><li>Run `emldump.py` to enumerate parts and print headers in a readable tree.  </li><li>Extract attachments (e.g., the embedded `.docx`, `.pdf`, or compressed archive) into a lab folder.  </li><li>Hash and scan those artifacts, then proceed to static/dynamic analysis.</li></ol></p><p></p><p>MENTAL MODEL / MEMORY AID  <ul><li>Think of `emldump.py` as an **X-ray** for an email: you’re not “opening” anything—just seeing the skeleton (headers + MIME) and pulling out the bones (attachments) for the lab.</li></ul></p><p></p><p>OUTPUT YOU’LL CARE ABOUT  <ul><li>List of parts with content-type (e.g., `text/plain`, `text/html`, `application/zip`).  </li><li>Filenames and sizes of attachments.  </li><li>Raw header lines (helpful for Received: chain inspection).</li></ul></p><p></p><p>------------------------------------------------------------</p><p>MalwareCube – Email-IOC-Extractor</p><p>(<a href="https://github.com/MalwareCube/Email-IOC-Extractor">https://github.com/MalwareCube/Email-IOC-Extractor</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>A script/tool that **mines IOCs** (Indicators of Compromise) from email content.  </li><li>It typically supports parsing of message text and sometimes attachments or decoded content to pull out **URLs, domains, IPs, email addresses, hashes**, and other regex-detectable artifacts.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>Speed: Rather than eyeballing a long HTML email or nested quoted content, the tool pulls likely IOCs in seconds.  </li><li>Consistency: Regex-driven extraction reduces the chance you miss a tiny but important domain or obfuscated URL.  </li><li>Reporting: Outputs can often be saved to **CSV/JSON** for ticket notes, SIEM enrichment, or block-lists.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Feed it a `.eml`, `.msg`, or pasted content.  </li><li>Let the extractor parse text and (when supported) decode simple obfuscations (e.g., `hxxp[:]//domain[.]com`).  </li><li>Export IOCs and **deduplicate** before pushing them to VT/Talos, your proxy block lists, or detections.</li></ol></p><p></p><p>GOOD PRACTICES  <ul><li>Treat extracted IOCs as **leads**, not gospel—confirm by reputation lookups and sandbox data.  </li><li>Normalize formats (e.g., de-defang `hxxp` to `http`) before submitting to reputational tools.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>VirusTotal — File/URL Intelligence &amp; Multi-AV Scanning</p><p>(<a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>A **multi-AV scanning and intelligence platform**. You can upload files or submit URLs, or search by **hash** (SHA-256/1/MD5).  </li><li>It aggregates antivirus detections, static properties, behavior (from sandboxes), **graph relationships** (who talks to whom), and community comments.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>Quick verdicting on attachments: *“Is this file already known bad?”*  </li><li>**Pivoting:** From a malicious file → domains/IPs it contacts → other files that contact those domains → campaign tell-tales.  </li><li>**Telemetry &amp; metadata:** Certificates, packers, embedded PE info, macro flags, and more.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Hash your attachment and search it in VT. If it’s known, grab detections + behavior reports.  </li><li>If unknown and policy allows, **upload** the sample (mind data-sharing policies; VT is public to subscribers).  </li><li>Use the **Relations/Behavior** tabs to gather secondary IOCs (C2 domains, dropped files).  </li><li>Export relevant IOCs to your ticket and block lists, and tag the incident for future correlation.</li></ol></p><p></p><p>TIPS  <ul><li>Prefer **hash searches** first to avoid uploading sensitive files unnecessarily.  </li><li>Check **“Behavior”** for sandboxed process trees, dropped artifacts, and network beacons.  </li><li>Mind legal/privacy rules: uploading proprietary docs to public services may be restricted.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Cisco Talos Intelligence — Reputation &amp; Threat Research</p><p>(<a href="https://talosintelligence.com/">https://talosintelligence.com/</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>Cisco Talos is a large threat-intel organization. The site exposes **reputation lookups** for IPs/domains/URLs and publishes **detailed research** on active threats, malware families, and campaigns.  </li><li>The **Reputation Center** provides a quick “good/bad/suspicious” signal and often shows historical sightings or email-specific reputation.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>**Second opinion** and **context**: After VT (or before), check Talos to see how widely an IOC is known/blocked and whether it’s part of a broader campaign.  </li><li>**Attribution &amp; tactics**: Research posts often include TTPs (Tactics, Techniques, and Procedures), YARA rules, and defensive guidance.  </li><li>**Email focus**: Talos has deep visibility into spam/malware email ecosystems due to Cisco’s mail/security footprint.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Paste the suspicious domain/IP/URL into Talos Reputation lookup.  </li><li>Note the disposition (e.g., “malicious,” “suspicious,” “neutral”) and any **historical telemetry**.  </li><li>Read linked research if available; harvest **additional IOCs** and **mitigations**.  </li><li>Use the findings to justify blocks, tuning, or user notifications.</li></ol></p><p></p><p>BEST-USE TIPS  <ul><li>Combine Talos reputation with VT’s relationships: if Talos says a domain is malicious and VT’s graph links the attachment to that domain, you have strong corroboration.  </li><li>Re-check periodically: reputation shifts as infrastructure is repurposed or cleaned.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Putting It All Together — A Fast, Defensible Workflow</p><p>------------------------------------------------------------<ol><li>**X-ray the email** with `emldump.py`: confirm headers/MIME, extract attachments safely.  </li><li>**Hash &amp; pre-check** the attachment in VirusTotal (hash first; upload only if policy allows).  </li><li>**Mine IOCs** quickly with Email-IOC-Extractor; normalize/defang as needed.  </li><li>**Reputation &amp; context** via Talos Intelligence; read any linked research for campaign-level insight.  </li><li>**Enrich &amp; share**: add IOCs to your SIEM/SOAR, create block rules, and document in the incident record.  </li><li>**(Optional) Detonate** the file in a sandbox if behavior/use-case demands; merge new network/process IOCs back into steps 3–5.</li></ol></p><p></p><p>MEMORY HOOK  <ul><li>**X-ray → Hash → Extract → Repute → Enrich.**  </li></ul></p><p>  - X-ray (emldump)  </p><p>  - Hash (SHA-256)  </p><p>  - Extract (Email-IOC-Extractor)  </p><p>  - Repute (VT/Talos)  </p><p>  - Enrich (block lists, detections, user comms)</p></div><div class='page'><a name="Phishing_&_Email_Analysis--Dynamic_Attachment_Analysis_&_Sandboxing_37.html"></a><h1 class='title level-2'>Dynamic Attachment Analysis & Sandboxing</h1><br/><p>------------------------------------------------------------</p><p>Dynamic Attachment Analysis &amp; Sandboxing – Notes</p><p>------------------------------------------------------------</p><p></p><p>Dynamic analysis is the process of executing a suspicious file in a **controlled, isolated environment** to observe what it does. This contrasts with static analysis, where the file is inspected without execution. The key is that behavior tells you intent: how the attachment interacts with the operating system, network, and user environment.</p><p></p><p>------------------------------------------------------------</p><p>Why Dynamic Analysis?</p><p>------------------------------------------------------------<ul><li>Static indicators can be obfuscated or encrypted, making analysis inconclusive.</li><li>Malware often reveals itself only when executed (e.g., downloading payloads, creating persistence).</li><li>Provides concrete IOCs (Indicators of Compromise) from real-world behavior.</li><li>Allows analysts to see tactics, techniques, and procedures (TTPs) used by attackers.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>The Sandboxing Concept</p><p>------------------------------------------------------------<ul><li>A **sandbox** is a virtualized or containerized environment where files are safely executed.</li><li>Sandboxes monitor and log system, process, and network activity.</li><li>They are designed to mimic a real user environment but restrict the malware from escaping.</li><li>Commonly used sandbox platforms: Cuckoo Sandbox, Any.Run, Joe Sandbox, Hybrid Analysis, FireEye, and in-house enterprise solutions.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Steps in Dynamic Attachment Analysis</p><p>------------------------------------------------------------<ol><li>**Prepare the environment**<ul><li>Isolated VM or sandbox with no production network access.</li><li>Snapshot capability to revert the machine after execution.</li><li>Monitoring tools installed (procmon, Wireshark, Sysmon, etc.).</li></ul></li></ol></p><p><ol><li>**Execute the attachment**<ul><li>Run the file as a user would (double-click or open in the intended application).</li><li>Trigger macros/scripts if that’s the attacker’s pathway (carefully controlled).</li></ul></li></ol></p><p><ol><li>**Observe system behavior**<ul><li>Processes created or modified.</li><li>Registry keys written or altered (persistence mechanisms).</li><li>New files dropped onto the file system.</li><li>Services or scheduled tasks created.</li></ul></li></ol></p><p><ol><li>**Observe network behavior**<ul><li>Outbound connections (domains/IPs contacted).</li><li>Protocols used (HTTP, HTTPS, DNS, SMB, etc.).</li><li>Data exfiltration attempts or C2 (command-and-control) traffic.</li></ul></li></ol></p><p><ol><li>**Collect artifacts and logs**<ul><li>Memory dumps.</li><li>Network captures.</li><li>Sandbox reports (JSON, HTML).</li><li>Dropped files and registry snapshots.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------</p><p>Key Things to Look For</p><p>------------------------------------------------------------<ul><li>**Persistence:** Autorun registry entries, scheduled tasks, startup folder changes.</li><li>**Privilege escalation:** Attempts to exploit local services or elevate to admin.</li><li>**Evasion:** Sandbox detection, sleeping for long periods, checking VM artifacts.</li><li>**Payload delivery:** Downloading second-stage malware, extracting hidden executables.</li><li>**Data theft:** Attempts to access browser caches, clipboard data, or keystrokes.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Advantages of Sandboxing</p><p>------------------------------------------------------------<ul><li>Safe environment for executing suspicious attachments.</li><li>Produces rich reports quickly with minimal manual intervention.</li><li>Can be automated in email security gateways to detonate attachments before delivery.</li><li>Enables faster incident response by revealing IOCs without deep reverse engineering.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Limitations and Evasion</p><p>------------------------------------------------------------<ul><li>Malware may detect sandbox artifacts (e.g., certain processes, registry keys, or hardware configurations).</li><li>Some samples require user interaction (clicks, form entries) to fully detonate.</li><li>Time bombs: malware waits hours or days to activate.</li><li>Encrypted or password-protected attachments may bypass automated sandboxing.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Example Case Narrative</p><p>------------------------------------------------------------</p><p>An employee reports a suspicious Excel file attachment `invoice.xlsm`.  <ol><li>The file is detonated in the sandbox.  </li><li>Upon enabling macros, the sandbox logs show PowerShell launching with a Base64-encoded string.  </li><li>The process tree reveals the PowerShell script contacts `hxxp://malicious-site[.]com/update.exe` and downloads an executable.  </li><li>The downloaded payload attempts persistence by creating a scheduled task named “WindowsUpdateCheck.”  </li><li>The sandbox provides a report with the file hash of the dropped executable, the malicious domain, and the registry modifications.  </li></ol></p><p></p><p>From this, the SOC team extracts IoCs, updates endpoint security, and blocks the domain at the proxy/firewall level.</p><p></p><p>------------------------------------------------------------</p><p>Memory Hook</p><p>------------------------------------------------------------</p><p>Think: **Run → Watch → Record → Extract.**<ul><li>Run (detonate the file in sandbox)</li><li>Watch (observe system/network changes)</li><li>Record (collect logs, dumps, artifacts)</li><li>Extract (IOCs for wider defense)</p><p></li></ul></p></div><div class='page'><a name="Phishing_&_Email_Analysis--Dynamic_Attachment_Analysis_&_Sandboxing--Links_38.html"></a><h1 class='title level-3'>Links</h1><br/><p>------------------------------------------------------------</p><p>Dynamic Analysis &amp; Sandboxing — Reference Notes</p><p>------------------------------------------------------------</p><p></p><p>Below are narrative notes you can paste into CherryTree. Each section explains what the referenced site/article is, why it matters for email attachment analysis, and how to use it in a SOC workflow.</p><p></p><p>------------------------------------------------------------</p><p>Hybrid Analysis (Falcon Sandbox)</p><p><a href="https://hybrid-analysis.com/">https://hybrid-analysis.com/</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>Hybrid Analysis is a free/community-facing front end to Falcon Sandbox for automated malware detonation and behavioral reporting. You can upload files/URLs, search public reports, and even perform YARA-based hunts (for vetted users). It exposes behavior trees, network indicators, extracted artifacts, and community scoring to help analysts quickly decide whether an attachment is malicious. :contentReference[oaicite:0]{index=0}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  </p><p>When you hash an email attachment (e.g., SHA-256) and search it on Hybrid Analysis, you often find existing public reports with:<ul><li>Process trees (e.g., WINWORD → powershell → curl)  </li><li>Dropped files and persistence keys  </li><li>DNS/HTTP requests (C2, payload hosts)  </li><li>Extracted strings and embedded resources  </li></ul></p><p>This turns a “cold” attachment into a set of concrete IOCs for blocking and hunting. :contentReference[oaicite:1]{index=1}</p><p></p><p>HOW TO USE IT (Triage Flow)  <ol><li>Compute the hash locally; search the hash first.  </li><li>If no hit and policy allows, upload the sample to HA (mind data-sharing rules).  </li><li>Review the **Behavior**, **Network**, **Extracted Files**, and **MITRE**-mapped findings; export IOCs to your ticket/SIEM.  </li><li>(Advanced) Maintain YARA rules for recurrent lures or packers and use HA’s YARA hunt to auto-flag future submissions. :contentReference[oaicite:2]{index=2}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>Google Cloud (Mandiant) Blog — CVE-2017-0199 HTA Handler</p><p><a href="https://cloud.google.com/blog/topics/threat-intelligence/cve-2017-0199-hta-handler">https://cloud.google.com/blog/topics/threat-intelligence/cve-2017-0199-hta-handler</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>This incident-response write-up (Apr 2017) documents in-the-wild exploitation of **CVE-2017-0199**, where weaponized Office/RTF documents abuse the **HTA handler** to pull and execute a script (often VBScript) that launches PowerShell and fetches a payload. It anchors the original kill chain details used by email-delivered lures. :contentReference[oaicite:3]{index=3}</p><p></p><p>KEY TAKEAWAYS FOR ANALYSTS  <ul><li>Opening a malicious Office/RTF attachment can cause an automatic external fetch of an HTA/VBS, which then executes PowerShell to retrieve malware.  </li><li>This pattern explains why simple static inspection of the doc may miss the true payload; dynamic/sandboxing reveals the HTA → PowerShell → payload chain.  </li><li>Microsoft patched the issue in April 2017; legacy or unpatched environments remain at risk. :contentReference[oaicite:4]{index=4}</li></ul></p><p></p><p>WHAT TO LOOK FOR IN SANDBOX REPORTS  <ul><li>**Process tree:** &lt;Office&gt; → `mshta.exe`/`wscript.exe` → `powershell.exe` with Base64 blobs.  </li><li>**Network:** initial GET to an attacker-controlled URL serving `.hta`/script; follow-on GET for EXE/DLL.  </li><li>**Artifacts:** scheduled tasks, Run keys, or dropped loaders. (Corroborate with HA/Joe/ANY.RUN outputs.) :contentReference[oaicite:5]{index=5}</li></ul></p><p></p><p></p><p>------------------------------------------------------------</p><p>Deep-Dive Blog Posts on CVE-2017-0199 (Backgrounders)</p><p>(Examples)  <ul><li>MDSec: <a href="https://www.mdsec.co.uk/2017/04/exploiting-cve-2017-0199-hta-handler-vulnerability/">https://www.mdsec.co.uk/2017/04/exploiting-cve-2017-0199-hta-handler-vulnerability/</a>  </li><li>Medium (community articles vary): <a href="https://medium.com/@vysec.private/exploiting-cve-2017-0199-hta-handler-vulnerability-8c50ec152c5a">https://medium.com/@vysec.private/exploiting-cve-2017-0199-hta-handler-vulnerability-8c50ec152c5a</a></li></ul></p><p>------------------------------------------------------------</p><p>WHAT THEY ARE  </p><p>Practitioner-oriented explainers showing how 0199 works in practice: RTF/Office lure triggers the **HTA handler**, which fetches/executes code without robust user interaction in vulnerable builds. These are useful primers before you read sandbox reports. :contentReference[oaicite:6]{index=6}</p><p></p><p>HOW TO APPLY WHEN ANALYZING ATTACHMENTS  <ul><li>Use these posts to build a mental model of the exploit chain.  </li><li>In your sandbox results, verify each stage exists (RTF/Office → HTA → script → PowerShell → payload).  </li><li>Cross-reference observed IOCs with reputation sources (Talos, VT) and patch guidance (April 2017 update). :contentReference[oaicite:7]{index=7}</li></ul></p><p></p><p>WHY STILL RELEVANT  </p><p>Even in 2025, you’ll find phishing campaigns recycling old exploit docs or using similar multi-stage download cradles. Understanding 0199 helps you recognize analogous chains (embedded scripts, LOLBins like `mshta.exe`) during dynamic analysis. Recent research still observes 0199-style delivery into commodity stealers/loaders. :contentReference[oaicite:8]{index=8}</p><p></p><p></p><p>------------------------------------------------------------</p><p>Joe Sandbox Cloud</p><p><a href="https://joesandbox.com">https://joesandbox.com</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>Joe Sandbox is a multi-OS automated detonation platform (Windows, macOS, Linux, Android) that generates very detailed, drill-down behavior reports: process graphs, API calls, persistence, network flows, memory artifacts, and rule hits (e.g., YARA/Sigma). Community/Cloud editions provide limited free runs; paid tiers unlock private analyses and deeper telemetry. :contentReference[oaicite:9]{index=9}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  <ul><li>Excellent for **document-borne malware** (DOC/XLS/PDF) that spawns scripts/LOLBins.  </li><li>Rich **network and memory** analysis surfaces second-stage payloads and C2s—ideal for IOC harvesting.  </li><li>Useful cross-check with Hybrid Analysis/ANY.RUN to avoid single-source bias. :contentReference[oaicite:10]{index=10}</li></ul></p><p></p><p>HOW TO USE IT  <ol><li>Hash search first; if clean and policy allows, submit the sample.  </li><li>Review **Behavior Graph**, **Network** tabs, and **IOC** exports.  </li><li>Compare Joe’s findings with other sandboxes; escalate consistent IOCs to block lists. :contentReference[oaicite:11]{index=11}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>ANY.RUN — Interactive Malware Sandbox</p><p><a href="https://app.any.run">https://app.any.run</a></p><p>------------------------------------------------------------</p><p>WHAT IT IS  </p><p>ANY.RUN is a **real-time, interactive** sandbox: you can click around inside the VM during detonation (enable macros, press dialog buttons, browse in the emulated system). It offers process/network views, behavior graphs, MITRE ATT&amp;CK mapping, and shareable public tasks; paid plans enable private mode. :contentReference[oaicite:12]{index=12}</p><p></p><p>WHY IT MATTERS FOR ATTACHMENTS  </p><p>Many email lures require **user interaction** (e.g., “Enable Content” buttons). ANY.RUN lets you simulate that interaction and immediately watch the process tree and HTTP/DNS beacons evolve—perfect for attachments that won’t fully detonate in a fully automated sandbox. :contentReference[oaicite:13]{index=13}</p><p></p><p>HOW TO USE IT  <ol><li>Start a task; open the document as a user would.  </li><li>Interact (enable macros, follow prompts) to trigger embedded scripts.  </li><li>Capture live IOCs from the **Network** and **Processes** panes; export artifacts for deeper analysis. :contentReference[oaicite:14]{index=14}</li></ol></p><p></p><p></p><p>------------------------------------------------------------</p><p>Putting the References to Work in Your Workflow</p><p>------------------------------------------------------------<ol><li>**Understand the exploit chain** with the CVE-2017-0199 write-ups (HTA handler → script → PowerShell). :contentReference[oaicite:15]{index=15}  </li><li>**Detonate** the attachment in one or more sandboxes (ANY.RUN for interactive, Hybrid Analysis/Joe for deep automated telemetry). :contentReference[oaicite:16]{index=16}  </li><li>**Extract IOCs** (domains, IPs, URLs, hashes, dropped files, persistence keys) and compare across tools for confidence. :contentReference[oaicite:17]{index=17}  </li><li>**Validate &amp; block** using reputation intel and ensure patch status aligns with Microsoft’s April 2017 fix guidance. :contentReference[oaicite:18]{index=18}</li></ol></p><p></p><p>MEMORY HOOK  </p><p>**Model → Detonate → Compare → Extract → Block.**  <ul><li>Model (read the CVE chain)  </li><li>Detonate (ANY.RUN + HA/Joe)  </li><li>Compare (cross-sandbox correlation)  </li><li>Extract (IOCs)  </li><li>Block (controls + patch)</p><p></li></ul></p></div>
</body>
</html>
