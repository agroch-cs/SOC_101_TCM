<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Links</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Links</h1><br/><p>------------------------------------------------------------</p><p>Email Attachment &amp; IOC Tools — Narrative Notes on the References</p><p>------------------------------------------------------------</p><p></p><p>Below are plain-language notes you can paste into CherryTree. Each header explains what the tool/site is, what it’s good for in a SOC workflow, and how you might use it during email attachment analysis and IOC (Indicator of Compromise) harvesting.</p><p></p><p>------------------------------------------------------------</p><p>Didier Stevens – emldump.py</p><p>(<a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/emldump.py">https://github.com/DidierStevens/DidierStevensSuite/blob/master/emldump.py</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>`emldump.py` is a command-line parser for raw email files (`.eml`).  </li><li>It reads the full RFC-822 email (headers + MIME parts) and prints a structured view so you can see exactly how the message is built: headers, boundaries, text parts, HTML parts, and attachments.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>To quickly validate **headers** (From/To, Return-Path, DKIM, SPF results if present in the chain).  </li><li>To enumerate **MIME parts** and **attachments** without opening them in a risky client (e.g., Outlook).  </li><li>To **extract attachments** safely for further static/dynamic analysis.  </li><li>To spot suspicious tricks (double extensions, mismatched content-type vs file magic, odd MIME boundaries).</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Save the suspicious message as a `.eml`.  </li><li>Run `emldump.py` to enumerate parts and print headers in a readable tree.  </li><li>Extract attachments (e.g., the embedded `.docx`, `.pdf`, or compressed archive) into a lab folder.  </li><li>Hash and scan those artifacts, then proceed to static/dynamic analysis.</li></ol></p><p></p><p>MENTAL MODEL / MEMORY AID  <ul><li>Think of `emldump.py` as an **X-ray** for an email: you’re not “opening” anything—just seeing the skeleton (headers + MIME) and pulling out the bones (attachments) for the lab.</li></ul></p><p></p><p>OUTPUT YOU’LL CARE ABOUT  <ul><li>List of parts with content-type (e.g., `text/plain`, `text/html`, `application/zip`).  </li><li>Filenames and sizes of attachments.  </li><li>Raw header lines (helpful for Received: chain inspection).</li></ul></p><p></p><p>------------------------------------------------------------</p><p>MalwareCube – Email-IOC-Extractor</p><p>(<a href="https://github.com/MalwareCube/Email-IOC-Extractor">https://github.com/MalwareCube/Email-IOC-Extractor</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>A script/tool that **mines IOCs** (Indicators of Compromise) from email content.  </li><li>It typically supports parsing of message text and sometimes attachments or decoded content to pull out **URLs, domains, IPs, email addresses, hashes**, and other regex-detectable artifacts.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>Speed: Rather than eyeballing a long HTML email or nested quoted content, the tool pulls likely IOCs in seconds.  </li><li>Consistency: Regex-driven extraction reduces the chance you miss a tiny but important domain or obfuscated URL.  </li><li>Reporting: Outputs can often be saved to **CSV/JSON** for ticket notes, SIEM enrichment, or block-lists.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Feed it a `.eml`, `.msg`, or pasted content.  </li><li>Let the extractor parse text and (when supported) decode simple obfuscations (e.g., `hxxp[:]//domain[.]com`).  </li><li>Export IOCs and **deduplicate** before pushing them to VT/Talos, your proxy block lists, or detections.</li></ol></p><p></p><p>GOOD PRACTICES  <ul><li>Treat extracted IOCs as **leads**, not gospel—confirm by reputation lookups and sandbox data.  </li><li>Normalize formats (e.g., de-defang `hxxp` to `http`) before submitting to reputational tools.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>VirusTotal — File/URL Intelligence &amp; Multi-AV Scanning</p><p>(<a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>A **multi-AV scanning and intelligence platform**. You can upload files or submit URLs, or search by **hash** (SHA-256/1/MD5).  </li><li>It aggregates antivirus detections, static properties, behavior (from sandboxes), **graph relationships** (who talks to whom), and community comments.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>Quick verdicting on attachments: *“Is this file already known bad?”*  </li><li>**Pivoting:** From a malicious file → domains/IPs it contacts → other files that contact those domains → campaign tell-tales.  </li><li>**Telemetry &amp; metadata:** Certificates, packers, embedded PE info, macro flags, and more.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Hash your attachment and search it in VT. If it’s known, grab detections + behavior reports.  </li><li>If unknown and policy allows, **upload** the sample (mind data-sharing policies; VT is public to subscribers).  </li><li>Use the **Relations/Behavior** tabs to gather secondary IOCs (C2 domains, dropped files).  </li><li>Export relevant IOCs to your ticket and block lists, and tag the incident for future correlation.</li></ol></p><p></p><p>TIPS  <ul><li>Prefer **hash searches** first to avoid uploading sensitive files unnecessarily.  </li><li>Check **“Behavior”** for sandboxed process trees, dropped artifacts, and network beacons.  </li><li>Mind legal/privacy rules: uploading proprietary docs to public services may be restricted.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Cisco Talos Intelligence — Reputation &amp; Threat Research</p><p>(<a href="https://talosintelligence.com/">https://talosintelligence.com/</a>)</p><p>------------------------------------------------------------</p><p>WHAT IT IS  <ul><li>Cisco Talos is a large threat-intel organization. The site exposes **reputation lookups** for IPs/domains/URLs and publishes **detailed research** on active threats, malware families, and campaigns.  </li><li>The **Reputation Center** provides a quick “good/bad/suspicious” signal and often shows historical sightings or email-specific reputation.</li></ul></p><p></p><p>WHY ANALYSTS USE IT  <ul><li>**Second opinion** and **context**: After VT (or before), check Talos to see how widely an IOC is known/blocked and whether it’s part of a broader campaign.  </li><li>**Attribution &amp; tactics**: Research posts often include TTPs (Tactics, Techniques, and Procedures), YARA rules, and defensive guidance.  </li><li>**Email focus**: Talos has deep visibility into spam/malware email ecosystems due to Cisco’s mail/security footprint.</li></ul></p><p></p><p>TYPICAL WORKFLOW  <ol><li>Paste the suspicious domain/IP/URL into Talos Reputation lookup.  </li><li>Note the disposition (e.g., “malicious,” “suspicious,” “neutral”) and any **historical telemetry**.  </li><li>Read linked research if available; harvest **additional IOCs** and **mitigations**.  </li><li>Use the findings to justify blocks, tuning, or user notifications.</li></ol></p><p></p><p>BEST-USE TIPS  <ul><li>Combine Talos reputation with VT’s relationships: if Talos says a domain is malicious and VT’s graph links the attachment to that domain, you have strong corroboration.  </li><li>Re-check periodically: reputation shifts as infrastructure is repurposed or cleaned.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Putting It All Together — A Fast, Defensible Workflow</p><p>------------------------------------------------------------<ol><li>**X-ray the email** with `emldump.py`: confirm headers/MIME, extract attachments safely.  </li><li>**Hash &amp; pre-check** the attachment in VirusTotal (hash first; upload only if policy allows).  </li><li>**Mine IOCs** quickly with Email-IOC-Extractor; normalize/defang as needed.  </li><li>**Reputation &amp; context** via Talos Intelligence; read any linked research for campaign-level insight.  </li><li>**Enrich &amp; share**: add IOCs to your SIEM/SOAR, create block rules, and document in the incident record.  </li><li>**(Optional) Detonate** the file in a sandbox if behavior/use-case demands; merge new network/process IOCs back into steps 3–5.</li></ol></p><p></p><p>MEMORY HOOK  <ul><li>**X-ray → Hash → Extract → Repute → Enrich.**  </li></ul></p><p>  - X-ray (emldump)  </p><p>  - Hash (SHA-256)  </p><p>  - Extract (Email-IOC-Extractor)  </p><p>  - Repute (VT/Talos)  </p><p>  - Enrich (block lists, detections, user comms)</p></div>
</body>
</html>
