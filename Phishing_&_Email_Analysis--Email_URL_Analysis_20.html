<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Email URL Analysis</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Email URL Analysis</h1><br/><p>------------------------------------------------------------</p><p>Email URL Analysis â€“ Full Notes</p><p>------------------------------------------------------------</p><p></p><p>------------------------------------------------------------<ol><li>Why Email URL Analysis Matters</li></ol></p><p>------------------------------------------------------------<ul><li>Phishing emails rely heavily on malicious links to trick users into entering credentials, downloading malware, or revealing sensitive information.</li><li>URLs act as the bridge between the email message and the attackerâ€™s infrastructure.</li><li>As a SOC analyst or security student, your role is to dissect these URLs to determine if they are legitimate, suspicious, or outright malicious.</li></ul></p><p></p><p>Key goals of analysis:<ul><li>Inspect the **structure** of the URL.</li><li>Decode obfuscations (encoding, shortened links, hidden redirects).</li><li>Compare **visible text** vs. **actual destination**.</li><li>Identify warning signs of brand impersonation or trickery.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Anatomy of a URL in Email</li></ol></p><p>------------------------------------------------------------</p><p>A URL generally follows this format:</p><p></p><p>protocol://subdomain.domain.tld/path?query#fragment</p><p></p><p><ul><li>**Protocol** â†’ Specifies communication type (`http`, `https`, `ftp`).</li><li>**Domain** â†’ The registered domain (e.g., `paypal.com`).</li><li>**Subdomain** â†’ Sits before the domain (`secure.paypal.com`).</li><li>**Path** â†’ The specific resource or directory being requested (`/login`).</li><li>**Query String** â†’ Parameters after `?` (e.g., `?id=123&amp;user=abc`).</li><li>**Fragment (#)** â†’ Points to a section of the page (rarely malicious, but can be used for tricks).</li></ul></p><p></p><p>Example:</p><p></p><p><a href="https://secure.paypa1.com/login?sessionid=abc123">https://secure.paypa1.com/login?sessionid=abc123</a></p><p></p><p>Observation:<ul><li>Protocol: `https` (secure channel).</li><li>Domain: `paypa1.com` (digit &quot;1&quot; instead of &quot;l&quot;).</li><li>Path: `/login` (mimics real login page).</li><li>Query: `sessionid=abc123` (potential session tracking).</li><li>Result: This is phishing because the **root domain is wrong**.</li></ul></p><p></p><p>------------------------------------------------------------<ol><li>Common Tricks in Malicious Email URLs</li></ol></p><p>------------------------------------------------------------<ol><li>**Lookalike domains**  <ul><li>Subtle typos: `paypa1.com` vs. `paypal.com`  </li><li>Homoglyphs: `rnicrosoft.com` vs. `microsoft.com`</li></ul></li></ol></p><p><ol><li>**Subdomain abuse**  <ul><li>Example: `microsoft.com.attacker.com` â†’ the real domain is `attacker.com`.</li></ul></li></ol></p><p><ol><li>**URL encoding**  <ul><li>Example: `%2E` for a period `.` or `%2F` for `/`.  </li><li>Makes the URL harder to read at first glance.</li></ul></li></ol></p><p><ol><li>**Shortened URLs**  <ul><li>Services like `bit.ly/xyz` hide the final destination.</li></ul></li></ol></p><p><ol><li>**Long or technical-looking query strings**  <ul><li>Attackers add random parameters to overwhelm or confuse.</li></ul></li></ol></p><p><ol><li>**False sense of security with HTTPS**  <ul><li>Just because it has a padlock ðŸ”’ doesnâ€™t mean itâ€™s safe.  </li><li>Attackers can also obtain valid SSL/TLS certificates.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>What Analysts Should Check</li></ol></p><p>------------------------------------------------------------</p><p>When you analyze a URL in an email:</p><p><ol><li>**Check the root domain**  <ul><li>Use WHOIS or domain lookup tools.  </li><li>Make sure itâ€™s exactly the expected domain (`paypal.com` vs. `paypal.security.com`).</li></ul></li></ol></p><p><ol><li>**Decode encodings**  <ul><li>`%20` = space, `%2E` = `.`, `%2F` = `/`.</li></ul></li></ol></p><p><ol><li>**Expand shortened links**  <ul><li>Use online tools or `curl -I &lt;URL&gt;` to see where it points.</li></ul></li></ol></p><p><ol><li>**Compare displayed vs. actual link**  <ul><li>Example: Email text shows `<a href="https://bankofamerica.com">https://bankofamerica.com</a>`  </li><li>Hovered/clicked link is `<a href="http://malicious-site.ru/boa">http://malicious-site.ru/boa</a>`.</li></ul></li></ol></p><p><ol><li>**Look for redirects**  <ul><li>Some emails send users through tracking services before final destination.</li></ul></li></ol></p><p><ol><li>**Cross-reference with threat intelligence**  <ul><li>Use VirusTotal, URLHaus, or sandboxed environments to check.</li></ul></li></ol></p><p></p><p>------------------------------------------------------------<ol><li>Example Email URL Analysis</li></ol></p><p>------------------------------------------------------------</p><p>Suspicious email contains this link:</p><p></p><p><a href="https://secure.login-paypal.com/authenticate?session=99231">https://secure.login-paypal.com/authenticate?session=99231</a></p><p></p><p></p><p>Step-by-step:<ul><li>**Protocol**: HTTPS â†’ encrypted, but that doesnâ€™t prove safety.</li><li>**Domain**: `login-paypal.com` â†’ this is NOT `paypal.com`.  </li><li>**Trick**: Makes it look like PayPal by including &quot;login&quot; and &quot;paypal&quot;.</li><li>**Path**: `/authenticate` â†’ mimics real authentication process.</li><li>**Query String**: `session=99231` â†’ typical phishing tracking or victim ID.</li></ul></p><p></p><p>**Conclusion**: This is a malicious phishing URL.</p><p></p><p>------------------------------------------------------------<ol><li>Analyst Workflow Checklist (SOP Style)</li></ol></p><p>------------------------------------------------------------</p><p>Use this as a repeatable process for every suspicious email URL:</p><p><ol><li>**Extract URL** from email headers or body.</li><li>**Break into components**: protocol, domain, subdomain, path, query.</li><li>**Check the registered domain** â†’ Is it legitimate?</li><li>**Decode encodings** (`%2E`, `%20`, etc.).</li><li>**Expand shortened links** safely.</li><li>**Check for redirects** (sandbox or curl).</li><li>**Compare text vs. hyperlink** â†’ any mismatch?</li><li>**Cross-check against threat intel databases**.</li><li>**Document findings** â†’ screenshot + written notes.</li><li>**Determine verdict**: legitimate, suspicious, or malicious.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Summary</p><p>------------------------------------------------------------<ul><li>Email URL analysis is about looking past the surface to the *true domain*.  </li><li>Attackers rely on obfuscation: typos, encodings, subdomain tricks, and shortened links.  </li><li>A disciplined workflow lets you spot red flags systematically.  </li><li>Always confirm the root domain and test safely in controlled environments.</p><p></li></ul></p></div>
</body>
</html>
