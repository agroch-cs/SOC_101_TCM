<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Email Attachment Analysis</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Email Attachment Analysis</h1><br/><p>------------------------------------------------------------</p><p>Email Attachment Analysis – Notes</p><p>------------------------------------------------------------</p><p></p><p>When investigating phishing or malicious emails, analysts focus not only on the message body and URLs but also on attachments. Attachments are a common delivery method for malware and social engineering payloads. Because many organizations have link protections in place, attackers rely heavily on file attachments to bypass defenses.</p><p></p><p>------------------------------------------------------------</p><p>Why Attachments Matter</p><p>------------------------------------------------------------</p><p>Attachments can carry:<ul><li>Executable malware (.exe, .dll, .bat, .ps1)</li><li>Document-based payloads (malicious Word macros, weaponized PDFs, embedded Excel formulas)</li><li>Compressed archives (.zip, .rar, .7z) used to hide malware</li><li>Image/media files with hidden exploits (steganography, malformed headers)</li></ul></p><p></p><p>Attachments provide a direct delivery vector: one user click can compromise a system.</p><p></p><p>------------------------------------------------------------</p><p>Analyst’s First Step – Triage</p><p>------------------------------------------------------------<ol><li>Preserve the original sample – always work in a sandbox or isolated VM.</li><li>Gather metadata – file name, extension, size (watch for double extensions like “invoice.pdf.exe”).</li><li>Generate hashes – MD5, SHA-1, SHA-256 for reference and threat intel checks.</li><li>Submit hashes to platforms like VirusTotal to see if file is already known.</li></ol></p><p></p><p>------------------------------------------------------------</p><p>Static Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>File headers/magic numbers: confirm type matches extension (e.g., .pdf starts with %PDF).</li><li>Strings analysis: extract readable text for URLs, C2 servers, or suspicious calls.</li><li>Macro inspection: review VBA code with tools like “oletools.”</li><li>Embedded objects: detect executables or scripts hidden inside documents.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Dynamic Analysis of Attachments</p><p>------------------------------------------------------------<ul><li>Sandbox execution: observe behavior such as file creation, registry edits, process spawning.</li><li>Network monitoring: check for suspicious outbound connections.</li><li>Persistence checks: look for scheduled tasks, registry keys, or dropped payloads.</li></ul></p><p></p><p>Dynamic analysis reveals what the file actually does, not just what it might do.</p><p></p><p>------------------------------------------------------------</p><p>Common Malicious Attachment Types</p><p>------------------------------------------------------------<ul><li>Malicious Office Documents – VBA macros, DDE (Dynamic Data Exchange).</li><li>PDFs – with embedded JavaScript or malicious auto-actions.</li><li>Archives – password-protected .zip/.rar to bypass filters.</li><li>Scripts – .vbs, .js, or .ps1 designed to download/install malware.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Indicators of Compromise (IoCs)</p><p>------------------------------------------------------------</p><p>Extracted from attachments for defense:<ul><li>File hashes</li><li>Embedded URLs/domains</li><li>IP addresses</li><li>Registry keys / scheduled tasks</li><li>Dropped file names and locations</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Defensive Measures</p><p>------------------------------------------------------------<ul><li>Attachment filtering – block risky file types.</li><li>Sandboxing – detonate unknown files before delivery.</li><li>User awareness – train users not to enable macros or open unexpected files.</li><li>Advanced email security – combine static/dynamic analysis with threat intel feeds.</li></ul></p><p></p><p>------------------------------------------------------------</p><p>Example Case Narrative</p><p>------------------------------------------------------------</p><p>A reported email titled “Urgent Invoice” contains `invoice.pdf.exe`.  <ul><li>Hash check matches known malware on VirusTotal.  </li><li>Strings show suspicious commands (`powershell -enc ...`).  </li><li>Sandbox run reveals network call to `hxxp://malicious-domain[.]com` and second-stage payload.  </li></ul></p><p></p><p>Analyst provides IoCs to SOC team for blocking, endpoint updates, and user warnings.</p></div>
</body>
</html>
